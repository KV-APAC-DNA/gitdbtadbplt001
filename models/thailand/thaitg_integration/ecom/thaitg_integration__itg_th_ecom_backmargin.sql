with source as
(
    select * from {{ source('thasdl_raw', 'sdl_ecom_backmargin') }}
),
final as
( 
	select 
		ORDERSN::VARCHAR(100) as ORDERSN,
		SHOP_ID::VARCHAR(50) as SHOP_ID,
		SELLER_USERNAME::VARCHAR(100) as SELLER_USERNAME,
		SKU_ID::VARCHAR(100) as SKU_ID,
		BUNDLE_ORD_ITMID::VARCHAR(10) as BUNDLE_ORD_ITMID,
		PRODUCT_ID::VARCHAR(100) as PRODUCT_ID,
		ITM_NAME::VARCHAR(16777216) as ITM_NAME,
		MODEL_ID::VARCHAR(100) as MODEL_ID,
		MODEL_NAME::VARCHAR(500) as MODEL_NAME,
		PURCHASED_TIME::VARCHAR(20) as PURCHASED_TIME,
		CATEGORY::VARCHAR(100) as CATEGORY,
		SUB_CATEGORY::VARCHAR(100) as SUB_CATEGORY,
		BE_STATUS::VARCHAR(100) as BE_STATUS,
		SELLER_VOUCHER::VARCHAR(100) as SELLER_VOUCHER,
		PLATFORM_VOUCHER::VARCHAR(100) as PLATFORM_VOUCHER,
		QUANTITY::NUMBER(38,0) as QUANTITY,
		FLASH_SALE::VARCHAR(100) as FLASH_SALE,
		FREE_SHIPPING_REBATE::NUMBER(20,4) as FREE_SHIPPING_REBATE,
		SHOPEE_VOUCHER_REBATE::NUMBER(20,4) as SHOPEE_VOUCHER_REBATE,
		SELLER_VOUCHER_REBATE::NUMBER(20,4) as SELLER_VOUCHER_REBATE,
		PLATFORM_VOUCHER_SELLER_REBATE::NUMBER(20,4) as PLATFORM_VOUCHER_SELLER_REBATE,
		PLATFORM_VOUCHER_SHOPEE_REBATE::NUMBER(20,4) as PLATFORM_VOUCHER_SHOPEE_REBATE,
		COIN_EARN::NUMBER(20,4) as COIN_EARN,
		COIN_USED::NUMBER(20,4) as COIN_USED,
		SPECIFIC_PURCHASE_TIME::VARCHAR(50) as SPECIFIC_PURCHASE_TIME,
		COGS_PER_QUANTITY::NUMBER(20,4) as COGS_PER_QUANTITY,
		PRICE_BEFORE_DISCOUNT::NUMBER(20,4) as PRICE_BEFORE_DISCOUNT,
		ITEM_PRICE::NUMBER(20,4) as ITEM_PRICE,
		PERCENT_DISCOUNT::NUMBER(20,4) as PERCENT_DISCOUNT,
		PROMOTION_ID::VARCHAR(100) as PROMOTION_ID,
		SHIPPING_CARRIER::VARCHAR(255) as SHIPPING_CARRIER,
		BUNDLE_ID::VARCHAR(100) as BUNDLE_ID,
		ACTUAL_SHIPPING_FEE::NUMBER(20,4) as ACTUAL_SHIPPING_FEE,
		BUYER_SHIPPING_FEE::NUMBER(20,4) as BUYER_SHIPPING_FEE,
		ADD_ON_DEAL_ID::VARCHAR(100) as ADD_ON_DEAL_ID,
		IS_ADD_ON_SUB_ITEM::NUMBER(38,0) as IS_ADD_ON_SUB_ITEM,
		BACKMARGIN_CFS::NUMBER(20,4) as BACKMARGIN_CFS,
		BACKMARGIN_NORMAL::NUMBER(20,4) as BACKMARGIN_NORMAL,
		BACKMARGIN_BUNDLE::NUMBER(20,4) as BACKMARGIN_BUNDLE,
		BACKMARGIN_ADDON::NUMBER(20,4) as BACKMARGIN_ADDON,
		BACKMARGIN_SHIPPING::NUMBER(20,4) as BACKMARGIN_SHIPPING,
		SELLER_VOUCHER_COIN_EARN::NUMBER(20,4) as SELLER_VOUCHER_COIN_EARN,
		PLATFORM_VOUCHER_COIN_EARN::NUMBER(20,4) as PLATFORM_VOUCHER_COIN_EARN,
		SUPPLIER_ID::VARCHAR(100) as SUPPLIER_ID,
		SUPPLIERNAME::VARCHAR(255) as SUPPLIERNAME,
		NMV::NUMBER(20,4) as NMV,
		BUNDLE_RULE_TYPE::VARCHAR(100) as BUNDLE_RULE_TYPE,
		BUNDLE_RULE_VALUE::VARCHAR(100) as BUNDLE_RULE_VALUE,
		ITEM_BRAND::VARCHAR(100) as ITEM_BRAND,
		IS_EXCLUSIVE_PRICE::NUMBER(38,0) as IS_EXCLUSIVE_PRICE,
		ORDER_VALUE::NUMBER(20,4) as ORDER_VALUE,
		IS_NEW_BUYER_PRICE::NUMBER(38,0) as IS_NEW_BUYER_PRICE,
		IS_LIVE_ORDER::NUMBER(38,0) as IS_LIVE_ORDER,
		ESCROW_PAID_DATE::VARCHAR(50) as ESCROW_PAID_DATE,
		FILENAME::VARCHAR(255) as filename,
		CRTD_DTTM :: TIMESTAMP_NTZ(9) as crtd_dttm,
		current_timestamp()::timestamp_ntz(9) as updt_dttm
	from source
)
select * from final