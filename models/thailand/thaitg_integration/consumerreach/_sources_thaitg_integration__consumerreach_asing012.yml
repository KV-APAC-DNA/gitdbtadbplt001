version: 2

sources:
  - name: thasdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: thasdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
    
    - name: sdl_jnj_consumerreach_711
      tags: ["j_th_perfect_store_transaction"]
      tests:
        - test_null:
            select_columns: ["cdate","retail","retailname","retailbranch","jjskubarcode","jjskuname","file_name"]
            not_null_columns: ["cdate","retail","retailname","retailbranch","jjskubarcode","jjskuname","file_name"]
            name: TRATBL_sdl_jnj_consumerreach_711__null_test
            config:
              store_failures: true
              schema: thawks_integration
        - test_lookup:
              select_columns: ["cdate","retail","retailname","retailbranch","jjskubarcode","jjskuname","file_name"]
              lookup_column: "cdate, regexp_like (cdate,'(20)[0-9]{2}-(01|02|03|04|05|06|07|08|09|10|11|12)-(01|02|03|04|05|06|07|08|09|10|11|12|13|14|15|16|17|18|19|20|21|22|23|24|25|26|27|28|29|30|31)') as result"
              lookup_table: "{{ source('thasdl_raw','sdl_jnj_consumerreach_711') }}"
              lookup_filter: "result = true"
              column: "cdate,true"
              failure_reason: "'CDATE HAVING INCORRECT DATE-FORMAT. EXPECTED: YYYY-MM-DD'"
              name: TRATBL_sdl_jnj_consumerreach_711__lookup_test
              config:
                store_failures: true
                schema: thawks_integration
    - name: sdl_jnj_consumerreach_sfm
      tags: ["j_th_perfect_store_transaction"]
      tests:
        - test_null:
            select_columns: ["cdate","retail","retailname","retailbranch","jjskubarcode","jjskuname","file_name"]
            not_null_columns: ["cdate","retail","retailname","retailbranch","jjskubarcode","jjskuname","file_name"]
            name: TRATBL_sdl_jnj_consumerreach_sfm__null_test
            config:
              store_failures: true
              schema: thawks_integration
        - test_lookup:
              select_columns: ["cdate","retail","retailname","retailbranch","jjskubarcode","jjskuname","file_name"]
              lookup_column: "cdate, regexp_like (cdate,'(20)[0-9]{2}-(01|02|03|04|05|06|07|08|09|10|11|12)-(01|02|03|04|05|06|07|08|09|10|11|12|13|14|15|16|17|18|19|20|21|22|23|24|25|26|27|28|29|30|31)') as result"
              lookup_table: "{{ source('thasdl_raw','sdl_jnj_consumerreach_sfm') }}"
              lookup_filter: "result = true"
              column: "cdate,true"
              failure_reason: "'CDATE HAVING INCORRECT DATE-FORMAT. EXPECTED: YYYY-MM-DD'"
              name: TRATBL_sdl_jnj_consumerreach_sfm__lookup_test
              config:
                store_failures: true
                schema: thawks_integration
        
  