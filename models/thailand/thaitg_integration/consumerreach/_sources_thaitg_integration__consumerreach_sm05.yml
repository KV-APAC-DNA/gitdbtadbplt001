version: 2

sources:
  - name: thasdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: thasdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: sdl_jnj_consumerreach_cvs
        tests:
            - test_null:
                not_null_columns: ['file_name','cdate','retail','retailname','retailbranch','jjskubarcode','jjskuname']
                select_columns: ['file_name','cdate','retail','retailname','retailbranch','jjskubarcode','jjskuname']
                name: TRATBL_sdl_jnj_consumerreach_cvs__null_test
                config:
                  store_failures: true
                  schema: thawks_integration

            - test_date_format_odd_eve_leap:
                model_nm: "{{ source('thasdl_raw', 'sdl_jnj_consumerreach_cvs') }}"
                date_column: "cdate"
                filter: "(odd_mon.cdate) = (even_mon.cdate) and (odd_mon.result) = (even_mon.result)"
                failure_reason: "'CDATE HAVING INCORRECT DATE-FORMAT. EXPECTED: YYYYMMDD'"
                select_columns: ['file_name','cdate','retail','retailname','retailbranch','jjskubarcode','jjskuname']
                name: TRATBL_sdl_jnj_consumerreach_cvs__test_date_format_odd_eve_leap
                config:
                  store_failures: true
                  schema: thawks_integration




      