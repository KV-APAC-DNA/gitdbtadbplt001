with itg_cbd_gt_sales_report_fact as (
    -- select * from {{ ref('thaitg_integration__itg_cbd_gt_sales_report_fact') }}
    select * from DEV_DNA_CORE.SNAPOSEITG_INTEGRATION.ITG_CBD_GT_SALES_REPORT_FACT
),
transformed as (
select DISTINCT 'CBD' AS dstrbtr_id,
customer_code AS ar_cd,
'N/A' AS old_cust_id,
customer_name AS ar_nm,
'N/A' AS ar_adres,
'N/A' AS tel_phn,
'N/A' AS fax,
province AS city,
'N/A' AS region,
'N/A' AS ar_typ_cd,
'N/A' AS sls_dist,
'N/A' AS sls_office,
province AS sls_grp,
'N/A' AS sls_emp,
'N/A' AS sls_nm,
'N/A' AS src_file,
'N/A' AS bill_no,
'N/A' AS bill_moo,
'N/A' AS bill_soi,
'N/A' AS bill_rd,
'N/A' AS bill_subdist,
'N/A' AS bill_dist,
province AS bill_prvnce,
'N/A' AS bill_zip_cd,
null as modify_dt,
'N/A' AS routestep1,
'N/A' AS routestep2,
'N/A' AS routestep3,
'N/A' AS routestep4,
'N/A' AS routestep5,
'N/A' AS routestep6,
'N/A' AS routestep7,
'N/A' AS routestep8,
'N/A' AS routestep9,
'N/A' AS routestep10,
1 AS actv_status,
'N/A' AS cust_type,
'DKSH Cambodia' AS dstrbtr_nm,
null as dstrbtr_cost_lvl,
'N/A' AS dstrbtr_status,
'N/A' AS dstrbtr_region,
'N/A' AS dstrbtr_cntry,
'N/A' AS curnt_dist,
null as dstrbtr_inv_day,
'N/A' AS dstrbtr_cd,
null as dstrbtr_fee,
customer_group AS grp_nm,
'N/A' AS ar_typ_grp,
customer_group AS typ_grp_nm,
'N/A' AS sales_district,
'N/A' AS sls_dist_city,
'N/A' AS sls_dist_region,
'N/A' AS sls_dist_city_eng,
'N/A' AS sls_dist_blng_to_dstrbtr,
'N/A' AS region_desc,
'N/A' AS dist_nm,
'N/A' AS sub_dist_nm,
'N/A' AS pricelevel,
'N/A' AS salesareaname,
'N/A' AS branchcode,
'N/A' AS branchname,
'N/A' AS frequencyofvisit,
'N/A' AS store,
customer_group AS re_nm,
convert_timezone('Asia/Singapore',current_timestamp()) AS crt_dttm, 
current_timestamp() as updt_dttm
from itg_cbd_gt_sales_report_fact),
final as (
select 
    dstrbtr_id::varchar(10) as dstrbtr_id,
    ar_cd::varchar(20) as ar_cd,
    old_cust_id::varchar(25) as old_cust_id,
    ar_nm::varchar(500) as ar_nm,
    ar_adres::varchar(500) as ar_adres,
    tel_phn::varchar(150) as tel_phn,
    fax::varchar(150) as fax,
    city::varchar(500) as city,
    region::varchar(20) as region,
    ar_typ_cd::varchar(20) as ar_typ_cd,
    sls_dist::varchar(10) as sls_dist,
    sls_office::varchar(30) as sls_office,
    sls_grp::varchar(30) as sls_grp,
    sls_emp::varchar(150) as sls_emp,
    sls_nm::varchar(250) as sls_nm,
    src_file::varchar(255) as src_file,
    bill_no::varchar(500) as bill_no,
    bill_moo::varchar(250) as bill_moo,
    bill_soi::varchar(255) as bill_soi,
    bill_rd::varchar(255) as bill_rd,
    bill_subdist::varchar(30) as bill_subdist,
    bill_dist::varchar(30) as bill_dist,
    bill_prvnce::varchar(30) as bill_prvnce,
    bill_zip_cd::varchar(50) as bill_zip_cd,
    modify_dt::timestamp_ntz(9) as modify_dt,
    routestep1::varchar(10) as routestep1,
    routestep2::varchar(10) as routestep2,
    routestep3::varchar(10) as routestep3,
    routestep4::varchar(10) as routestep4,
    routestep5::varchar(10) as routestep5,
    routestep6::varchar(10) as routestep6,
    routestep7::varchar(10) as routestep7,
    routestep8::varchar(10) as routestep8,
    routestep9::varchar(10) as routestep9,
    routestep10::varchar(10) as routestep10,
    actv_status::number(18,0) as actv_status,
    cust_type::varchar(50) as cust_type,
    dstrbtr_nm::varchar(100) as dstrbtr_nm,
    dstrbtr_cost_lvl::number(18,0) as dstrbtr_cost_lvl,
    dstrbtr_status::varchar(10) as dstrbtr_status,
    dstrbtr_region::varchar(20) as dstrbtr_region,
    dstrbtr_cntry::varchar(20) as dstrbtr_cntry,
    curnt_dist::varchar(10) as curnt_dist,
    dstrbtr_inv_day::number(3,0) as dstrbtr_inv_day,
    dstrbtr_cd::varchar(255) as dstrbtr_cd,
    dstrbtr_fee::float as dstrbtr_fee,
    grp_nm::varchar(100) as grp_nm,
    ar_typ_grp::varchar(10) as ar_typ_grp,
    typ_grp_nm::varchar(50) as typ_grp_nm,
    sales_district::varchar(50) as sales_district,
    sls_dist_city::varchar(100) as sls_dist_city,
    sls_dist_region::varchar(100) as sls_dist_region,
    sls_dist_city_eng::varchar(100) as sls_dist_city_eng,
    sls_dist_blng_to_dstrbtr::varchar(5) as sls_dist_blng_to_dstrbtr,
    region_desc::varchar(100) as region_desc,
    dist_nm::varchar(100) as dist_nm,
    sub_dist_nm::varchar(100) as sub_dist_nm,
    pricelevel::varchar(50) as pricelevel,
    salesareaname::varchar(150) as salesareaname,
    branchcode::varchar(50) as branchcode,
    branchname::varchar(150) as branchname,
    frequencyofvisit::varchar(50) as frequencyofvisit,
    store::varchar(200) as store,
    re_nm::varchar(100) as re_nm,
    crt_dttm::timestamp_ntz(9) as crt_dttm,
    updt_dttm::timestamp_ntz(9) as updt_dttm
from transformed
)
select * from transformed