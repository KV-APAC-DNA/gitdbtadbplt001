with edw_th_sellout_foc_analysis as 
(
    select * from {{ ref('thaedw_integration__edw_vw_th_sellout_foc_analysis') }}
),

final as (
select 
    order_date::timestamp_ntz(9) as order_date,
    order_no::varchar(255) as order_no,
    iscancel::number(18,0) as iscancel,
    grp_cd::varchar(10) as grp_cd,
    prom_cd1::varchar(255) as prom_cd1,
    prom_cd2::varchar(255) as prom_cd2,
    prom_cd3::varchar(255) as prom_cd3,
    year::number(18,0) as year,
    year_quarter::varchar(14) as year_quarter,
    month_year::varchar(23) as month_year,
    month_number::number(18,0) as month_number,
    year_week_number::number(38,0) as year_week_number,
    month_week_number::number(38,0) as month_week_number,
    country_code::varchar(2) as country_code,
    country_name::varchar(8) as country_name,
    distributor_id::varchar(10) as distributor_id,
    region_desc::varchar(100) as region_desc,
    city::varchar(100) as city,
    district::varchar(100) as district,
    ar_code::varchar(20) as ar_code,
    ar_name::varchar(500) as ar_name,
    channel_code::varchar(30) as channel_code,
    channel::varchar(100) as channel,
    sales_office_code::varchar(8) as sales_office_code,
    sales_office_name::varchar(17) as sales_office_name,
    sales_group::varchar(10) as sales_group,
    "cluster"::varchar(8) as cluster,
    ar_type_code::varchar(30) as ar_type_code,
    ar_type_name::varchar(400) as ar_type_name,
    distributor_name::varchar(100) as distributor_name,
    sap_cust_id::varchar(10) as sap_cust_id,
    sap_cust_nm::varchar(100) as sap_cust_nm,
    sap_sls_org::varchar(4) as sap_sls_org,
    sap_cmp_id::varchar(6) as sap_cmp_id,
    sap_cntry_cd::varchar(3) as sap_cntry_cd,
    sap_cntry_nm::varchar(40) as sap_cntry_nm,
    sap_addr::varchar(150) as sap_addr,
    sap_region::varchar(150) as sap_region,
    sap_state_cd::varchar(150) as sap_state_cd,
    sap_city::varchar(150) as sap_city,
    sap_post_cd::varchar(150) as sap_post_cd,
    sap_chnl_cd::varchar(2) as sap_chnl_cd,
    sap_chnl_desc::varchar(20) as sap_chnl_desc,
    sap_sls_office_cd::varchar(4) as sap_sls_office_cd,
    sap_sls_office_desc::varchar(40) as sap_sls_office_desc,
    sap_sls_grp_cd::varchar(3) as sap_sls_grp_cd,
    sap_sls_grp_desc::varchar(40) as sap_sls_grp_desc,
    sap_prnt_cust_key::varchar(12) as sap_prnt_cust_key,
    sap_prnt_cust_desc::varchar(50) as sap_prnt_cust_desc,
    sap_cust_chnl_key::varchar(12) as sap_cust_chnl_key,
    sap_cust_chnl_desc::varchar(50) as sap_cust_chnl_desc,
    sap_cust_sub_chnl_key::varchar(12) as sap_cust_sub_chnl_key,
    sap_sub_chnl_desc::varchar(50) as sap_sub_chnl_desc,
    sap_go_to_mdl_key::varchar(12) as sap_go_to_mdl_key,
    sap_go_to_mdl_desc::varchar(50) as sap_go_to_mdl_desc,
    sap_bnr_key::varchar(12) as sap_bnr_key,
    sap_bnr_desc::varchar(50) as sap_bnr_desc,
    sap_bnr_frmt_key::varchar(12) as sap_bnr_frmt_key,
    sap_bnr_frmt_desc::varchar(50) as sap_bnr_frmt_desc,
    retail_env::varchar(50) as retail_env,
    sku_code::varchar(25) as sku_code,
    sku_description::varchar(500) as sku_description,
    bar_code::varchar(50) as bar_code,
    franchise::varchar(30) as franchise,
    brand::varchar(30) as brand,
    variant::varchar(100) as variant,
    segment::varchar(50) as segment,
    put_up_description::varchar(100) as put_up_description,
    prod_sub_brand::varchar(100) as prod_sub_brand,
    prod_subsegment::varchar(100) as prod_subsegment,
    prod_category::varchar(50) as prod_category,
    prod_subcategory::varchar(50) as prod_subcategory,
    salesman_name::varchar(250) as salesman_name,
    salesman_code::varchar(150) as salesman_code,
    cn_reason_code::varchar(255) as cn_reason_code,
    cn_reason_description::varchar(250) as cn_reason_description,
    price::number(19,6) as price,
    gross_trade_sales::float as gross_trade_sales,
    cn_damaged_goods::float as cn_damaged_goods,
    credit_note_amount::float as credit_note_amount,
    line_discount::number(38,6) as line_discount,
    bottom_line_discount::number(38,6) as bottom_line_discount,
    sales_quantity::number(38,6) as sales_quantity,
    return_quantity::number(38,6) as return_quantity,
    quantity_dz::float as quantity_dz,
    net_invoice::number(38,6) as net_invoice,
    tot_bf_discount::float as tot_bf_discount,
    target_calls::number(18,0) as target_calls,
    target_sales::number(18,0) as target_sales
    from edw_th_sellout_foc_analysis
)

select * from final