with source as (
    select * from {{ ref('aspedw_integration__edw_vw_th_sfmc_analysis') }}
),
final as (
    select
        data_src::varchar(11) as data_src,
        country_code::varchar(10) as country_code,
        country_name::varchar(10) as country_name,
        created_date::date as created_date,
        invoicec_created_date::varchar(40) as invoicec_created_date,
        invoice_completed_date::varchar(40) as invoice_completed_date,
        last_logon_time::varchar(40) as last_logon_time,
        purchase_date::varchar(40) as purchase_date,
        redeemed_date::varchar(40) as redeemed_date,
        redeemption_completed_date::varchar(40) as redeemption_completed_date,
        first_name::varchar(200) as first_name,
        last_name::varchar(200) as last_name,
        consumer_name::varchar(401) as consumer_name,
        mobile_number::varchar(30) as mobile_number,
        subscriber_key::varchar(100) as subscriber_key,
        mobile_country_code::varchar(10) as mobile_country_code,
        address_country::varchar(100) as address_country,
        address_region::varchar(100) as address_region,
        address_1::varchar(255) as address_1,
        address_2::varchar(255) as address_2,
        line_id::varchar(50) as line_id,
        address::varchar(488) as address,
        birth_month::varchar(10) as birth_month,
        birth_year::varchar(10) as birth_year,
        consumer_age::varchar(40) as consumer_age,
        consumer_age_group::varchar(9) as consumer_age_group,
        email::varchar(100) as email,
        gender::varchar(100) as gender,
        channel_name::varchar(200) as channel_name,
        brand::varchar(200) as brand,
        product_name::varchar(200) as product_name,
        product_category::varchar(200) as product_category,
        tier::varchar(100) as tier,
        remaining_points::number(10,4) as remaining_points,
        customer_redeemed_points::number(10,4) as customer_redeemed_points,
        total_points::number(10,4) as total_points,
        invoive_number::varchar(50) as invoive_number,
        invoice_qty::varchar(50) as invoice_qty,
        invoice_type::varchar(200) as invoice_type,
        invoice_seller_name::varchar(255) as invoice_seller_name,
        invoice_points::varchar(50) as invoice_points,
        invoice_status::varchar(50) as invoice_status,
        child_name::varchar(200) as child_name,
        child_birth_month::varchar(10) as child_birth_month,
        child_birth_year::varchar(10) as child_birth_year,
        child_gender::varchar(100) as child_gender,
        child_number::varchar(30) as child_number,
        child_age::varchar(40) as child_age,
        child_group::varchar(19) as child_group,
        child_flag::varchar(12) as child_flag,
        redeemed_order_number::varchar(50) as redeemed_order_number,
        redeemed_prod_name::varchar(255) as redeemed_prod_name,
        redemption_status::varchar(100) as redemption_status,
        redeemed_points::varchar(50) as redeemed_points,
        redeemed_qty::varchar(50) as redeemed_qty,
        activity_date::timestamp_ntz(9) as activity_date,
        local_activity_date::timestamp_ntz(9) as local_activity_date,
        sent_activity_date::timestamp_ntz(9) as sent_activity_date,
        email_name::varchar(100) as email_name,
        email_subject::varchar(200) as email_subject,
        sent_email_name::varchar(100) as sent_email_name,
        sent_email_subject::varchar(200) as sent_email_subject,
        email_delivered_flag::varchar(10) as email_delivered_flag,
        is_unique::varchar(10) as is_unique,
        url::varchar(1000) as url,
        link_name::varchar(200) as link_name,
        link_content::varchar(1000) as link_content,
        bounce_reason::varchar(30) as bounce_reason,
        bounce_type::varchar(30) as bounce_type,
        bounce_description::varchar(1000) as bounce_description,
        data_refresh_time::timestamp_ntz(9) as data_refresh_time,
        smoker::varchar(100) as smoker,
        expectant_mother::varchar(100) as expectant_mother,
        category_they_are_using::varchar(100) as category_they_are_using,
        category_they_are_using_eng::varchar(100) as category_they_are_using_eng,
        skin_condition::varchar(100) as skin_condition,
        skin_condition_eng::varchar(100) as skin_condition_eng,
        skin_problem::varchar(100) as skin_problem,
        skin_problem_eng::varchar(100) as skin_problem_eng,
        use_mouthwash::varchar(100) as use_mouthwash,
        mouthwash_time::varchar(100) as mouthwash_time,
        mouthwash_time_eng::varchar(100) as mouthwash_time_eng,
        why_not_use_mouthwash::varchar(100) as why_not_use_mouthwash,
        why_not_use_mouthwash_eng::varchar(100) as why_not_use_mouthwash_eng,
        oral_problem::varchar(100) as oral_problem,
        oral_problem_eng::varchar(100) as oral_problem_eng
    from source
)
select * from final