version: 2

sources:
  - name: vnmsdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: vnmsdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: sdl_mds_vn_topdoor_storetype_mapping
        tags: ["vn_mt_sellin_master","ingestion"]
      - name: sdl_mds_vn_gt_msl_shoptype_mapping
        tags: ["vn_mt_sellin_master","ingestion"]
      - name: sdl_vn_dms_order_promotion
        tags: ["vn_dms_order_promotion","ingestion"]
        tests:
          - test_duplicate:
              group_by_columns: ["branch_id","pro_id","ord_no","line_ref","disc_type","break_by","disc_break_line_ref","free_item_code"]
              select_columns: ["branch_id","pro_id","ord_no","line_ref","disc_type","break_by","disc_break_line_ref","free_item_code"]
              name: TRATBL_sdl_vn_dms_order_promotion__duplicate_test
              config:
                store_failures: true
                schema: vnmwks_integration
      