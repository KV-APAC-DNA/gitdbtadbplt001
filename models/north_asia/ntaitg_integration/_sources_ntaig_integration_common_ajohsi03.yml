version: 2

sources:
  - name: ntasdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: ntasdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:




      - name: sdl_kr_ecommerce_naver_sellout
        tags: ["j_kr_tp_tracker_data_ingestion", "ingestion"]
        tests:
            - test_null:
                select_columns: ["transaction_date", "cust_nm", "ean_num", "year", "month", "week", "prod_desc", "sellout_qty", "sellout_amount"]
                not_null_columns: ["transaction_date"]
                name: TRATBL_sdl_kr_ecommerce_naver_sellout__null_test
                config:
                  store_failures: true
                  schema: ntawks_integration
            - test_format:
                select_columns: ["transaction_date", "cust_nm", "ean_num", "year", "month", "week", "prod_desc", "sellout_qty", "sellout_amount"]
                where_clause: "not regexp_like ('transaction_date', '[1-2][0-9][0-9][0-9]-[0-1][0-9]-[0-9][0-9]') and not regexp_like ('transaction_date', '[0-1][0-9]/[0-9][0-9]/[1-2][0-9][0-9][0-9]') and (transaction_date is not null and transaction_date != '')"              
                failure_reason: "'TRANSACTION DATE RECEIVED IS INVALID'"
                name: TRATBL_sdl_kr_ecommerce_naver_sellout__format_test
                config:
                  store_failures: true
                  schema: ntawks_integration

 

              