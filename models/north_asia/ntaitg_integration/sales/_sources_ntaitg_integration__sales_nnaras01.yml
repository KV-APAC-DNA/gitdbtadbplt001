version: 2

sources:
  - name: ntasdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: ntasdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
    
    - name: sdl_mds_kr_sales_cust_prod_master
      tags: ["mds_sdl_itg_load","transformation"]
      tests:
          - test_null:
              select_columns: ["sales_grp_cd","src_sys_cd","cust_prod_cd","ean_cd","ctry_cd"]
              not_null_columns: ["code","src_sys_cd","cust_prod_cd"]  
              name: TRATBL_sdl_mds_kr_sales_cust_prod_master__null_test
              config:
                store_failures: true
                schema: ntawks_integration
          - test_duplicate:
              select_columns: ["sales_grp_cd","src_sys_cd","cust_prod_cd","ean_cd","ctry_cd"]
              group_by_columns: ["sales_grp_cd","src_sys_cd","cust_prod_cd","ean_cd","ctry_cd"]
              name: TRATBL_sdl_mds_kr_sales_cust_prod_master__duplicate_test
              config:
                store_failures: true
                schema: ntawks_integration
    - name: sdl_mds_kr_sales_store_map
      tags: ["mds_sdl_itg_load","transformation"]
      tests:
      - test_null:
          select_columns: ["sls_ofc_code","channel","store_type","sales_group_code_code","code"]
          not_null_columns: ["code"]  
          name: TRATBL_sdl_mds_kr_sales_store_map__null_test
          config:
            store_failures: true
            schema: ntawks_integration
      - test_duplicate:
          select_columns: ["sls_ofc_code","channel","store_type","sales_group_code_code","code"]
          group_by_columns: ["sls_ofc_code","channel","store_type","sales_group_code_code","code"]
          name: TRATBL_sdl_mds_kr_sales_store_map__duplicate_test
          config:
            store_failures: true
            schema: ntawks_integration
  