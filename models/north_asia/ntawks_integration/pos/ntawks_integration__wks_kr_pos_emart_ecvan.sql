with sdl_kr_pos_emart_ecvan as 
(
    select * from {{ ref('ntawks_integration__wks_sdl_kr_pos_emart_ecvan') }}
),
final as
(   
    SELECT 
        to_date(SRC.pos_dt) AS pos_dt,
        NULL AS vend_cd,
        vend_nm AS vend_nm,
        NULL AS prod_nm,
        NULL AS vend_prod_cd,
        cast(src.prod_nm as varchar(100)) AS vend_prod_nm,
        NULL AS brnd_nm,
        src.ean AS ean_num,
        src.str_cd AS str_cd,
        src.str_nm AS str_nm,
        cast (src.sellout_qty as integer) AS sls_qty,
        CAST(REPLACE(sellout_amt, ',', '') AS NUMERIC(20, 4)) AS sls_amt,
        0 AS unit_prc_amt,
        0 AS sls_excl_vat_amt,
        0 AS stk_rtrn_amt,
        0 AS stk_recv_amt,
        0 AS avg_sell_qty,
        0 AS cum_ship_qty,
        0 AS cum_rtrn_qty,
        0 AS web_ordr_takn_qty,
        0 AS web_ordr_acpt_qty,
        0 AS dc_invnt_qty,
        0 AS invnt_qty,
        0 AS invnt_amt,
        NULL AS invnt_dt,
        NULL AS serial_num,
        NULL AS prod_delv_type,
        NULL AS prod_type,
        NULL AS dept_cd,
        NULL AS dept_nm,
        NULL AS spec_1_desc,
        NULL AS spec_2_desc,
        NULL AS cat_big,
        NULL AS cat_mid,
        NULL AS cat_small,
        NULL AS dc_prod_cd,
        NULL AS cust_dtls,
        NULL AS dist_cd,
        'KRW' AS crncy_cd,
        NULL AS src_txn_sts,
        NULL AS src_seq_num,
        'Emart' AS src_sys_cd,
        'KR' AS ctry_cd,
        NULl as src_mesg_no,
        NULL as src_mesg_code,
        NULL as src_mesg_func_code,
        NULL as src_mesg_date,
        NULL as src_sale_date_form,
        NULL as src_send_code,
        NULL as src_send_ean_code,
        NULL as src_send_name,
        NULL as src_recv_qual,
        NULL as src_recv_ean_code,
        NULL as src_recv_name,
        NULL as src_part_qual,
        NULL as src_part_ean_code,
        NULL as src_part_id,
        NULL as src_part_name,
        NULL as src_sender_id,
        NULL as src_recv_date,
        NULL as src_recv_time,
        NULL as src_file_size,
        NULL as src_file_path,
        NULL as src_lega_tran,
        NULL as src_regi_date,
        NULL as src_line_no,
        NULL as src_instore_code,
        NULL as src_mnth_sale_amnt,
        NULL as src_qty_unit,
        NULL as src_mnth_sale_qty,
        NULL as unit_of_pkg_sales,
        NULL as doc_send_date,
        NULL as unit_of_pkg_invt,
        NULL as doc_fun,
        NULL as doc_no,
        NULL as doc_fun_cd,
        NULL as buye_loc_cd,
        NULL as vend_loc_cd,
        NULL as provider_loc_cd,
        0 as comp_qty,
        NULL as unit_of_pkg_comp,
        0 as order_qty,
        NULL as unit_of_pkg_order,
        crtd_dttm AS TGT_CRT_DTTM,
        NULL AS UPDT_DTTM
    FROM sdl_kr_pos_emart_ecvan SRC
)
select * from final