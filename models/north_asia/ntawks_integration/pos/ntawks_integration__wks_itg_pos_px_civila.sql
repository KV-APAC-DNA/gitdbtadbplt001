with source as(
    select * from {{ source('ntasdl_raw', 'sdl_tw_pos_px_civila') }}
),
transformed as(
    select pos_date AS pos_dt,
		NULL AS vend_cd,
		NULL AS vend_nm,
		NULL AS prod_nm,
		civilian_product_code AS vend_prod_cd,
		product_name AS vend_prod_nm,
		brand AS brnd_nm,
		ean_code AS ean_num,
		store_code AS str_cd,
		store_name_chinese AS str_nm,
		Stock_selling_qty_by_store AS sls_qty,
		Stock_selling_amt_by_store AS sls_amt,
		unit_price AS unit_prc_amt,
		NULL AS sls_excl_vat_amt,
		Stock_return_amt_by_store AS stk_rtrn_amt,
		Stock_receive_amt_by_store AS stk_recv_amt,
		NULL AS avg_sell_qty,
		Stock_receive_qty_by_store AS cum_ship_qty,
		Stock_return_qty_by_store AS cum_rtrn_qty,
		NULL AS web_ordr_takn_qty,
		NULL AS web_ordr_acpt_qty,
		NULL AS dc_invnt_qty,
		Stock_inventory_qty AS invnt_qty,
		Stock_inventory_amt AS invnt_amt,
		NULL AS invnt_dt,
		NULL AS serial_num,
		NULL AS prod_delv_type,
		NULL AS prod_type,
		NULL AS dept_cd,
		NULL AS dept_nm,
		NULL AS spec_1_desc,
		NULL AS spec_2_desc,
		NULL AS cat_big,
		NULL AS cat_mid,
		NULL AS cat_small,
		dc AS dc_prod_cd,
		NULL AS cust_dtls,
		NULL AS dist_cd,
		'TWD' AS crncy_cd,
		NULL AS src_txn_sts,
		NULL AS src_seq_num,
		'PX 全聯' AS src_sys_cd,
		'TW' AS ctry_cd,
		upd_dttm
    from source SRC
)
select * from transformed