with edw_hcp360_kpi_rpt as (
    select * from {{ ref('hcpedw_integration__edw_hcp360_kpi_rpt') }}
),
final as
(
    select
    country::varchar(20) as country,
	source_system::varchar(20) as source_system,
	channel::varchar(20) as channel,
	activity_type::varchar(50) as activity_type,
	hcp_master_id::varchar(50) as hcp_master_id,
	employee_id::varchar(20) as employee_id,
	brand::varchar(20) as brand,
	brand_category::varchar(20) as brand_category,
	speciality::varchar(30) as speciality,
	core_noncore::varchar(20) as core_noncore,
	classification::varchar(50) as classification,
	territory::varchar(50) as territory,
	zone::varchar(50) as zone,
	hcp_created_date::date as hcp_created_date,
	activity_date::date as activity_date,
	call_source_id::varchar(18) as call_source_id,
	product_indication_name::varchar(100) as product_indication_name,
	no_of_prescription_units::number(15,2) as no_of_prescription_units,
	first_prescription_date::date as first_prescription_date,	
	planned_call_cnt::number(3,0) as planned_call_cnt,
	call_duration::number(18,1) as call_duration,
	prescription_id::varchar(50) as prescription_id,	
	noofprescritions::number(18,5) as noofprescritions,
	noofprescribers::number(18,5) as noofprescribers,	
	email_name::varchar(100) as email_name,
	is_unique::varchar(1) as is_unique,
	email_delivered_flag::varchar(1) as email_delivered_flag,
    current_timestamp()::timestamp_ntz(9) as crt_dttm,
    current_timestamp()::timestamp_ntz(9) as updt_dttm,
	target_value::number(10,2) as target_value,
	target_kpi::varchar(50) as target_kpi,
	report_brand_reference::varchar(50) as report_brand_reference,
	diagnosis::varchar(100) as diagnosis,
	region_hq::varchar(50) as region_hq,
	email_activity_type::varchar(20) as email_activity_type,
	hcp_id::varchar(50) as hcp_id,
	transaction_flag::varchar(1) as transaction_flag,
	iqvia_brand::varchar(20) as iqvia_brand,
	iqvia_pack_description::varchar(100) as iqvia_pack_description,
	iqvia_product_description::varchar(50) as iqvia_product_description,
	iqvia_pack_volume::varchar(20) as iqvia_pack_volume,
	iqvia_input_brand::varchar(50) as iqvia_input_brand,
	mat_noofprescritions::number(18,5) as mat_noofprescritions,
	mat_noofprescribers::number(18,5) as mat_noofprescribers,
	field_rep_active::varchar(1) as field_rep_active,
	mat_totalprescritions_by_brand::number(18,5) as mat_totalprescritions_by_brand,
	mat_totalprescribers_by_brand::number(18,5) as mat_totalprescribers_by_brand,
	mat_totalprescritions_jnj_brand::number(18,5) as mat_totalprescritions_jnj_brand,
	totalprescritions_by_brand::number(18,5) as totalprescritions_by_brand,
	totalprescribers_by_brand::number(18,5) as totalprescribers_by_brand,
	totalprescritions_jnj_brand::number(18,5) as totalprescritions_jnj_brand,
	call_type::varchar(50) as call_type,
	email_subject::varchar(200) as email_subject,
	totalprescritions_by_speciality::number(18,5) as totalprescritions_by_speciality,
	totalprescribers_by_speciality::number(18,5) as totalprescribers_by_speciality,
	totalprescritions_jnj_speciality::number(18,5) as totalprescritions_jnj_speciality,
	totalprescritions_by_indication::number(18,5) as totalprescritions_by_indication,
	totalprescribers_by_indication::number(18,5) as totalprescribers_by_indication,
	totalprescritions_jnj_indication::number(18,5) as totalprescritions_jnj_indication,
	year_month::varchar(25) as year_month,
	devicecategory::varchar(50) as devicecategory,
	channelgrouping::varchar(50) as channelgrouping,
	visitor_country::varchar(100) as visitor_country,
	new_visitors::number(18,5) as new_visitors,
	repeat_visitors::number(18,5) as repeat_visitors,
	all_visitor::number(18,5) as all_visitor,
	unique_pageviews::number(18,5) as unique_pageviews,
	total_downloads::number(18,5) as total_downloads,
	pages::number(18,5) as pages,
	page_sessions::number(18,5) as page_sessions,
	total_page_views::number(18,5) as total_page_views,
	total_bounces::number(18,5) as total_bounces,
	total_session_duration::number(18,5) as total_session_duration,
	sessions::number(18,5) as sessions,
	territory_id::varchar(20) as territory_id,
	region::varchar(100) as region,
	sales_unit::number(18,5) as sales_unit,
	sales_value::number(18,5) as sales_value,
	totalsales_unit_by_brand::number(18,5) as totalsales_unit_by_brand,
	totalsales_value_by_brand::number(18,5) as totalsales_value_by_brand,
	totalsales_unit_by_jnj_brand::number(18,5) as totalsales_unit_by_jnj_brand,
	totalsales_value_by_jnj_brand::number(18,5) as totalsales_value_by_jnj_brand,
	medical_event_id::varchar(18) as medical_event_id,
	event_name::varchar(80) as event_name,
	event_type::varchar(256) as event_type,
	event_role::varchar(256) as event_role,
	attendee_status::varchar(256) as attendee_status,
	event_location::varchar(40) as event_location,
	survey_question::varchar(1000) as survey_question,
	survey_response::varchar(6000) as survey_response,
	attendee_name::varchar(256) as attendee_name,
	key_message::varchar(250) as key_message,
	sales_channel::varchar(100) as sales_channel,
	sales_area::varchar(100) as sales_area,
	sales_rep_count::number(18,0) as sales_rep_count,
	survey_name::varchar(500) as survey_name,
	sample_id::varchar(20) as sample_id,
	customer_code::varchar(50) as customer_code,
	customer_name::varchar(150) as customer_name,
	retailer_code::varchar(100) as retailer_code,
	retailer_name::varchar(150) as retailer_name,
	retailer_category_cd::varchar(25) as retailer_category_cd,
	retailer_category_name::varchar(50) as retailer_category_name,
	num_buying_retailer::varchar(500) as num_buying_retailer,
	is_active::varchar(1) as is_active,
	event_status::varchar(100) as event_status,
	category::varchar(50) as category,
	udc_avbabybodydocq42019::varchar(150) as udc_avbabybodydocq42019,
	udc_babyprofesionalcac2019::varchar(150) as udc_babyprofesionalcac2019,
	variant_name::varchar(150) as variant_name
    from edw_hcp360_kpi_rpt
)
select * from final