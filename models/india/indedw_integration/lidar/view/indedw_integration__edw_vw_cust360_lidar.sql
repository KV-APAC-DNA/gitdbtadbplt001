with edw_rpt_regional_sellout_offtake as (
    select * from {{ ref('aspedw_integration__edw_rpt_regional_sellout_offtake') }}
),

result as (
select edw_rpt_regional_sellout_offtake.year,
    edw_rpt_regional_sellout_offtake.qrtr_no,
    edw_rpt_regional_sellout_offtake.mnth_id,
    edw_rpt_regional_sellout_offtake.mnth_no,
    edw_rpt_regional_sellout_offtake.cal_date,
    edw_rpt_regional_sellout_offtake.week_start_date,
    edw_rpt_regional_sellout_offtake.univ_year,
    edw_rpt_regional_sellout_offtake.univ_month,
    edw_rpt_regional_sellout_offtake.country_code,
    edw_rpt_regional_sellout_offtake.country_name,
    edw_rpt_regional_sellout_offtake.data_source,
    edw_rpt_regional_sellout_offtake.soldto_code,
    edw_rpt_regional_sellout_offtake.distributor_code,
    edw_rpt_regional_sellout_offtake.distributor_name,
    edw_rpt_regional_sellout_offtake.store_code,
    edw_rpt_regional_sellout_offtake.store_name,
    edw_rpt_regional_sellout_offtake.store_type,
    edw_rpt_regional_sellout_offtake.distributor_additional_attribute1,
    edw_rpt_regional_sellout_offtake.distributor_additional_attribute2,
    edw_rpt_regional_sellout_offtake.distributor_additional_attribute3,
    edw_rpt_regional_sellout_offtake.sap_parent_customer_key,
    edw_rpt_regional_sellout_offtake.sap_parent_customer_description,
    edw_rpt_regional_sellout_offtake.sap_customer_channel_key,
    edw_rpt_regional_sellout_offtake.sap_customer_channel_description,
    edw_rpt_regional_sellout_offtake.sap_customer_sub_channel_key,
    edw_rpt_regional_sellout_offtake.sap_sub_channel_description,
    edw_rpt_regional_sellout_offtake.sap_go_to_mdl_key,
    edw_rpt_regional_sellout_offtake.sap_go_to_mdl_description,
    edw_rpt_regional_sellout_offtake.sap_banner_key,
    edw_rpt_regional_sellout_offtake.sap_banner_description,
    edw_rpt_regional_sellout_offtake.sap_banner_format_key,
    edw_rpt_regional_sellout_offtake.sap_banner_format_description,
    edw_rpt_regional_sellout_offtake.retail_environment,
    edw_rpt_regional_sellout_offtake.region,
    edw_rpt_regional_sellout_offtake.zone_or_area,
    edw_rpt_regional_sellout_offtake.customer_segment_key,
    edw_rpt_regional_sellout_offtake.customer_segment_description,
    edw_rpt_regional_sellout_offtake.global_product_franchise,
    edw_rpt_regional_sellout_offtake.global_product_brand,
    edw_rpt_regional_sellout_offtake.global_product_sub_brand,
    edw_rpt_regional_sellout_offtake.global_product_variant,
    edw_rpt_regional_sellout_offtake.global_product_segment,
    edw_rpt_regional_sellout_offtake.global_product_subsegment,
    edw_rpt_regional_sellout_offtake.global_product_category,
    edw_rpt_regional_sellout_offtake.global_product_subcategory,
    edw_rpt_regional_sellout_offtake.global_put_up_description,
    edw_rpt_regional_sellout_offtake.ean,
    edw_rpt_regional_sellout_offtake.sku_code,
    edw_rpt_regional_sellout_offtake.sku_description,
    edw_rpt_regional_sellout_offtake.pka_product_key,
    edw_rpt_regional_sellout_offtake.pka_product_key_description,
    edw_rpt_regional_sellout_offtake.from_currency,
    edw_rpt_regional_sellout_offtake.to_currency,
    edw_rpt_regional_sellout_offtake.exchange_rate,
    edw_rpt_regional_sellout_offtake.sellout_sales_quantity,
    edw_rpt_regional_sellout_offtake.sellout_sales_value,
    edw_rpt_regional_sellout_offtake.sellout_sales_value_usd,
    edw_rpt_regional_sellout_offtake.list_price,
    edw_rpt_regional_sellout_offtake.sellout_value_list_price,
    edw_rpt_regional_sellout_offtake.sellout_value_list_price_usd,
    edw_rpt_regional_sellout_offtake.selling_price,
    edw_rpt_regional_sellout_offtake.first_scan_flag_parent_customer_level,
    edw_rpt_regional_sellout_offtake.first_scan_flag_market_level,
    edw_rpt_regional_sellout_offtake.npd_flag_market_level,
    edw_rpt_regional_sellout_offtake.npd_flag_parent_customer_level,
    edw_rpt_regional_sellout_offtake.customer_product_desc,
    (current_timestamp()::text)::timestamp without time zone as crtd_dttm,
    (current_timestamp()::text)::timestamp without time zone as updt_dttm
from edw_rpt_regional_sellout_offtake
where ((edw_rpt_regional_sellout_offtake.country_name)::text = 'India'::text)
),

final as (
    select 
        year::number(18,0) as year,
        qrtr_no::varchar(14) as qrtr_no,
        mnth_id::varchar(23) as mnth_id,
        mnth_no::number(18,0) as mnth_no,
        cal_date::date as cal_date,
        week_start_date::date as week_start_date,
        univ_year::number(18,0) as univ_year,
        univ_month::number(18,0) as univ_month,
        country_code::varchar(2) as country_code,
        country_name::varchar(50) as country_name,
        data_source::varchar(14) as data_source,
        soldto_code::varchar(255) as soldto_code,
        distributor_code::varchar(100) as distributor_code,
        distributor_name::varchar(255) as distributor_name,
        store_code::varchar(100) as store_code,
        store_name::varchar(500) as store_name,
        store_type::varchar(255) as store_type,
        distributor_additional_attribute1::varchar(150) as distributor_additional_attribute1,
        distributor_additional_attribute2::varchar(150) as distributor_additional_attribute2,
        distributor_additional_attribute3::varchar(150) as distributor_additional_attribute3,
        sap_parent_customer_key::varchar(12) as sap_parent_customer_key,
        sap_parent_customer_description::varchar(75) as sap_parent_customer_description,
        sap_customer_channel_key::varchar(12) as sap_customer_channel_key,
        sap_customer_channel_description::varchar(75) as sap_customer_channel_description,
        sap_customer_sub_channel_key::varchar(12) as sap_customer_sub_channel_key,
        sap_sub_channel_description::varchar(75) as sap_sub_channel_description,
        sap_go_to_mdl_key::varchar(12) as sap_go_to_mdl_key,
        sap_go_to_mdl_description::varchar(75) as sap_go_to_mdl_description,
        sap_banner_key::varchar(12) as sap_banner_key,
        sap_banner_description::varchar(75) as sap_banner_description,
        sap_banner_format_key::varchar(12) as sap_banner_format_key,
        sap_banner_format_description::varchar(75) as sap_banner_format_description,
        retail_environment::varchar(50) as retail_environment,
        region::varchar(150) as region,
        zone_or_area::varchar(150) as zone_or_area,
        customer_segment_key::varchar(12) as customer_segment_key,
        customer_segment_description::varchar(50) as customer_segment_description,
        global_product_franchise::varchar(30) as global_product_franchise,
        global_product_brand::varchar(30) as global_product_brand,
        global_product_sub_brand::varchar(100) as global_product_sub_brand,
        global_product_variant::varchar(100) as global_product_variant,
        global_product_segment::varchar(50) as global_product_segment,
        global_product_subsegment::varchar(100) as global_product_subsegment,
        global_product_category::varchar(50) as global_product_category,
        global_product_subcategory::varchar(50) as global_product_subcategory,
        global_put_up_description::varchar(100) as global_put_up_description,
        ean::varchar(50) as ean,
        sku_code::varchar(40) as sku_code,
        sku_description::varchar(150) as sku_description,
        pka_product_key::varchar(68) as pka_product_key,
        pka_product_key_description::varchar(255) as pka_product_key_description,
        from_currency::varchar(5) as from_currency,
        to_currency::varchar(5) as to_currency,
        exchange_rate::number(15,5) as exchange_rate,
        sellout_sales_quantity::number(38,6) as sellout_sales_quantity,
        sellout_sales_value::number(38,6) as sellout_sales_value,
        sellout_sales_value_usd::number(38,11) as sellout_sales_value_usd,
        list_price::number(38,6) as list_price,
        sellout_value_list_price::number(38,12) as sellout_value_list_price,
        sellout_value_list_price_usd::number(38,17) as sellout_value_list_price_usd,
        selling_price::number(38,4) as selling_price,
        first_scan_flag_parent_customer_level::varchar(1) as first_scan_flag_parent_customer_level,
        first_scan_flag_market_level::varchar(1) as first_scan_flag_market_level,
        npd_flag_market_level::varchar(1) as npd_flag_market_level,
        npd_flag_parent_customer_level::varchar(1) as npd_flag_parent_customer_level,
        customer_product_desc::varchar(300) as customer_product_desc,
        crtd_dttm::timestamp_ntz(9) as crtd_dttm,
        updt_dttm::timestamp_ntz(9) as updt_dttm
    from result
)

select * from final