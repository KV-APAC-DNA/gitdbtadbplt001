with v_rpt_sales_details_with_history as 
(
    select * from {{ ref('indedw_integration__v_rpt_sales_details_with_history') }}
),
final as 
(
    SELECT 
    v_rpt_sales_details_with_history.customer_code,
    v_rpt_sales_details_with_history.invoice_no,
    v_rpt_sales_details_with_history.invoice_date,
    v_rpt_sales_details_with_history.retailer_code,
    v_rpt_sales_details_with_history.product_code,
    v_rpt_sales_details_with_history.quantity,
    v_rpt_sales_details_with_history.nr_value,
    v_rpt_sales_details_with_history.achievement_nr,
    v_rpt_sales_details_with_history.invoice_status,
    v_rpt_sales_details_with_history.customer_name,
    v_rpt_sales_details_with_history.region_name,
    v_rpt_sales_details_with_history.zone_name,
    v_rpt_sales_details_with_history.territory_name,
    v_rpt_sales_details_with_history.territory_classification,
    v_rpt_sales_details_with_history.class_desc,
    v_rpt_sales_details_with_history.outlet,
    v_rpt_sales_details_with_history.channel_name,
    v_rpt_sales_details_with_history.business_channel,
    v_rpt_sales_details_with_history.loyalty_desc,
    v_rpt_sales_details_with_history.status_desc,
    v_rpt_sales_details_with_history.product_name,
    v_rpt_sales_details_with_history.product_desc,
    v_rpt_sales_details_with_history.franchise_name,
    v_rpt_sales_details_with_history.brand_name,
    v_rpt_sales_details_with_history.product_category_name,
    v_rpt_sales_details_with_history.variant_name,
    v_rpt_sales_details_with_history.mothersku_name,
    v_rpt_sales_details_with_history.day,
    v_rpt_sales_details_with_history.mth_mm,
    v_rpt_sales_details_with_history.mth_yyyymm,
    v_rpt_sales_details_with_history.qtr,
    v_rpt_sales_details_with_history.yyyyqtr,
    v_rpt_sales_details_with_history.cal_yr,
    v_rpt_sales_details_with_history.fisc_yr,
    v_rpt_sales_details_with_history.week,
    v_rpt_sales_details_with_history."month" as month,
    v_rpt_sales_details_with_history.retailer_name,
    v_rpt_sales_details_with_history.salesman_name,
    v_rpt_sales_details_with_history.salesman_code,
    v_rpt_sales_details_with_history.route_name,
    v_rpt_sales_details_with_history.route_code,
    v_rpt_sales_details_with_history.active_flag,
    v_rpt_sales_details_with_history.rtrlatitude,
    v_rpt_sales_details_with_history.rtrlongitude,
    v_rpt_sales_details_with_history.rtruniquecode,
    v_rpt_sales_details_with_history.uniquesalescode AS unique_sales_code,
    v_rpt_sales_details_with_history.createddate,
    v_rpt_sales_details_with_history.retailer_address1,
    v_rpt_sales_details_with_history.retailer_address2,
    v_rpt_sales_details_with_history.retailer_address3,
    v_rpt_sales_details_with_history.zone_classification,
    v_rpt_sales_details_with_history.state_name,
    v_rpt_sales_details_with_history.town_name,
    v_rpt_sales_details_with_history.town_classification,
    v_rpt_sales_details_with_history.achievement_amt,
    v_rpt_sales_details_with_history.gross_amt,
    v_rpt_sales_details_with_history.net_amt,
    v_rpt_sales_details_with_history.num_lines,
    v_rpt_sales_details_with_history.prd_disc_sch_amt,
    v_rpt_sales_details_with_history.tax_amt,
    v_rpt_sales_details_with_history.qps_amt,
    v_rpt_sales_details_with_history.qps_qty,
    v_rpt_sales_details_with_history.sku_rec_amt,
    v_rpt_sales_details_with_history.sku_rec_qty,
    v_rpt_sales_details_with_history.num_recsku_lines,
    v_rpt_sales_details_with_history.num_buying_retailers,
    v_rpt_sales_details_with_history.num_bills,
    v_rpt_sales_details_with_history.num_packs,
    v_rpt_sales_details_with_history.udc_hsacounter,
    v_rpt_sales_details_with_history.udc_keyaccountname,
    v_rpt_sales_details_with_history.udc_pharmacychain,
    v_rpt_sales_details_with_history.udc_onedetailingbaby,
    v_rpt_sales_details_with_history.udc_sanprovisibilitysss,
    v_rpt_sales_details_with_history.udc_sssconsoffer,
    v_rpt_sales_details_with_history.udc_platinumclub2018,
    v_rpt_sales_details_with_history.udc_sssendcaps,
    v_rpt_sales_details_with_history.udc_platinumclub2019,
    v_rpt_sales_details_with_history.udc_signature2019,
    v_rpt_sales_details_with_history.udc_premium2019,
    v_rpt_sales_details_with_history.udc_gstn,
    v_rpt_sales_details_with_history.udc_platinumq22019new,
    v_rpt_sales_details_with_history.udc_sssprogram2019,
    v_rpt_sales_details_with_history.udc_umangq32019,
    v_rpt_sales_details_with_history.udc_sssscheme2019,
    v_rpt_sales_details_with_history.udc_ssspromoter2019,
    v_rpt_sales_details_with_history.udc_rtrtypeattr,
    v_rpt_sales_details_with_history.udc_bhagidariq32019,
    v_rpt_sales_details_with_history.udc_directorclubq32019,
    v_rpt_sales_details_with_history.udc_platinumq32019new,
    v_rpt_sales_details_with_history.udc_platinumq22019,
    v_rpt_sales_details_with_history.udc_platinumq32019,
    v_rpt_sales_details_with_history.udc_bbastore,
    v_rpt_sales_details_with_history.udc_avbabybodydocq42019,
    v_rpt_sales_details_with_history.udc_orslcac2019,
    v_rpt_sales_details_with_history.udc_babyprofesionalcac2019,
    v_rpt_sales_details_with_history.udc_platinumq42019,
    v_rpt_sales_details_with_history.udc_schemesss2020,
    v_rpt_sales_details_with_history.udc_platinumq12020,
    v_rpt_sales_details_with_history.udc_platinumq32020,
    v_rpt_sales_details_with_history.udc_sssq32020,
    v_rpt_sales_details_with_history.udc_bhagidariq32020,
    v_rpt_sales_details_with_history.udc_directorclubq32020,
    v_rpt_sales_details_with_history.udc_umangq32020,
    v_rpt_sales_details_with_history.udc_daudq32020,
    v_rpt_sales_details_with_history.udc_daudq42020,
    v_rpt_sales_details_with_history.udc_platinumq42020,
    v_rpt_sales_details_with_history.udc_directorclubq42020,
    v_rpt_sales_details_with_history.udc_sssprogramq42020,
    v_rpt_sales_details_with_history.udc_bhagidariq42020,
    v_rpt_sales_details_with_history.udc_umangq42020,
    v_rpt_sales_details_with_history.udc_samriddhi,
    v_rpt_sales_details_with_history.udc_sssprogramq12021,
    v_rpt_sales_details_with_history.udc_platinumq12021,
    v_rpt_sales_details_with_history.udc_orslcac2021,
    v_rpt_sales_details_with_history.udc_bhagidariq12021,
    v_rpt_sales_details_with_history.udc_daudq12021,
    v_rpt_sales_details_with_history.udc_directorclubq12021,
    v_rpt_sales_details_with_history.udc_umangq12021,
    v_rpt_sales_details_with_history.udc_platinumq22021,
    v_rpt_sales_details_with_history.udc_sssprogramq22021,
    v_rpt_sales_details_with_history.udc_bhagidariq22021,
    v_rpt_sales_details_with_history.udc_daudq22021,
    v_rpt_sales_details_with_history.udc_directorclubq22021,
    v_rpt_sales_details_with_history.udc_umangq22021,
    v_rpt_sales_details_with_history.udc_platinumq32021,
    v_rpt_sales_details_with_history.udc_sssprogramq32021,
    v_rpt_sales_details_with_history.udc_newgtm,
    v_rpt_sales_details_with_history.udc_sssprogramq12022,
    v_rpt_sales_details_with_history.udc_ssspharmacystore,
    v_rpt_sales_details_with_history.udc_ssstotstores,
    v_rpt_sales_details_with_history.udc_platinumq12022,
    v_rpt_sales_details_with_history.udc_hsacounterq12022,
    v_rpt_sales_details_with_history.udc_bssaveenoudc2022,
    v_rpt_sales_details_with_history.udc_sssprogramq22022,
    v_rpt_sales_details_with_history.udc_platinumq22022,
    v_rpt_sales_details_with_history.udc_hsacounterq22022,
    v_rpt_sales_details_with_history.udc_ecommerce,
    v_rpt_sales_details_with_history.udc_babytopstoreactivation,
    v_rpt_sales_details_with_history.udc_platinumq32022,
    v_rpt_sales_details_with_history.udc_hsacounterq32022,
    v_rpt_sales_details_with_history.udc_platinumq42022,
    v_rpt_sales_details_with_history.udc_sssprogramq42022,
    v_rpt_sales_details_with_history.udc_sssprogramq12023,
    v_rpt_sales_details_with_history.udc_hsacounterq12023,
    v_rpt_sales_details_with_history.udc_platinumq12023,
    v_rpt_sales_details_with_history.udc_aarogyam,
    v_rpt_sales_details_with_history.udc_sssprogramq22023,
    v_rpt_sales_details_with_history.udc_ssshyperstores2023,
    v_rpt_sales_details_with_history.udc_winbirth2023,
    v_rpt_sales_details_with_history.udc_winclinic2023,
    v_rpt_sales_details_with_history.udc_hsacounterq22023,
    v_rpt_sales_details_with_history.udc_hsacounterq32023,
    v_rpt_sales_details_with_history.udc_aveenosssstores,
    v_rpt_sales_details_with_history.udc_hsacounterq42023,
    v_rpt_sales_details_with_history.udc_hsacounterq12024,
    v_rpt_sales_details_with_history.udc_q124bssprogram,
    v_rpt_sales_details_with_history.udc_specialtyprofessional2024,
    v_rpt_sales_details_with_history.retailer_category_cd,
    v_rpt_sales_details_with_history.retailer_category_name,
    v_rpt_sales_details_with_history.csrtrcode,
    v_rpt_sales_details_with_history.abi_ntid,
    v_rpt_sales_details_with_history.flm_ntid,
    v_rpt_sales_details_with_history.bdm_ntid,
    v_rpt_sales_details_with_history.rsm_ntid,
    v_rpt_sales_details_with_history.crt_dttm,
    v_rpt_sales_details_with_history.updt_dttm,
    v_rpt_sales_details_with_history.type_name,
    v_rpt_sales_details_with_history.customer_type,
    v_rpt_sales_details_with_history.mothersku_code,
    v_rpt_sales_details_with_history.salesman_status,
    v_rpt_sales_details_with_history.total_retailers,
    v_rpt_sales_details_with_history.prd_free_qty,
    v_rpt_sales_details_with_history.retailer_channel_1,
    v_rpt_sales_details_with_history.retailer_channel_2,
    v_rpt_sales_details_with_history.retailer_channel_3,
    v_rpt_sales_details_with_history.report_channel,
    v_rpt_sales_details_with_history.latest_customer_code,
    v_rpt_sales_details_with_history.latest_customer_name,
    v_rpt_sales_details_with_history.latest_territory_code,
    v_rpt_sales_details_with_history.latest_territory_name,
    v_rpt_sales_details_with_history.tlcode,
    v_rpt_sales_details_with_history.tlname,
    v_rpt_sales_details_with_history.rsrcode,
    v_rpt_sales_details_with_history.rsrname,
    v_rpt_sales_details_with_history.nielsen_townname,
    v_rpt_sales_details_with_history.nielsen_statename,
    v_rpt_sales_details_with_history.nielsen_districtname,
    v_rpt_sales_details_with_history.nielsen_subdistrictname,
    v_rpt_sales_details_with_history.nielsen_type,
    v_rpt_sales_details_with_history.nielsen_villagename,
    v_rpt_sales_details_with_history.nielsen_pincode,
    v_rpt_sales_details_with_history.nielsen_uacheck,
    v_rpt_sales_details_with_history.nielsen_uaname,
    v_rpt_sales_details_with_history.nielsen_popstrata,
    v_rpt_sales_details_with_history.latest_salesman_code,
    v_rpt_sales_details_with_history.latest_salesman_name,
    v_rpt_sales_details_with_history.latest_uniquesalescode,
    v_rpt_sales_details_with_history.prof_type,
    v_rpt_sales_details_with_history.RBM_CODE,
    v_rpt_sales_details_with_history.ZBM_CODE,
    v_rpt_sales_details_with_history.FBM_CODE,
    v_rpt_sales_details_with_history.HQ_CODE

FROM v_rpt_sales_details_with_history v_rpt_sales_details_with_history
WHERE (
        (v_rpt_sales_details_with_history.fisc_yr)::double precision >= (
            date_part(YEAR, convert_timezone('UTC', current_timestamp())::timestamp_ntz(9)) - (3)::double precision
        )
    )
    
)
select * from final