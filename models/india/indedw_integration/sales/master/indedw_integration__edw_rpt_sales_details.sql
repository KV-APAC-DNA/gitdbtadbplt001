{{
    config(
        sql_header="USE WAREHOUSE "+ env_var("DBT_ENV_CORE_DB_MEDIUM_WH")+ ";"
    )
}}

with source as 
(
    select * from {{ ref('indedw_integration__v_rpt_sales_details') }}
),
final as 
(
    select 
    customer_code::varchar(50) as customer_code,
	invoice_no::varchar(50) as invoice_no,
	invoice_date::number(18,0) as invoice_date,
	retailer_code::varchar(100) as retailer_code,
	product_code::varchar(50) as product_code,
	quantity::number(38,0) as quantity,
	nr_value::number(38,6) as nr_value,
	achievement_nr::number(38,6) as achievement_nr,
	invoice_status::varchar(1) as invoice_status,
	customer_name::varchar(150) as customer_name,
	region_name::varchar(50) as region_name,
	zone_name::varchar(50) as zone_name,
	territory_name::varchar(50) as territory_name,
	territory_classification::varchar(50) as territory_classification,
	class_desc::varchar(50) as class_desc,
	outlet::varchar(50) as outlet,
	channel_name::varchar(150) as channel_name,
	business_channel::varchar(50) as business_channel,
	loyalty_desc::varchar(50) as loyalty_desc,
	status_desc::varchar(10) as status_desc,
	product_name::varchar(50) as product_name,
	product_desc::varchar(100) as product_desc,
	franchise_name::varchar(50) as franchise_name,
	brand_name::varchar(50) as brand_name,
	product_category_name::varchar(150) as product_category_name,
	variant_name::varchar(150) as variant_name,
	mothersku_name::varchar(150) as mothersku_name,
	day::number(18,0) as day,
	mth_mm::number(18,0) as mth_mm,
	mth_yyyymm::number(18,0) as mth_yyyymm,
	qtr::number(18,0) as qtr,
	yyyyqtr::number(18,0) as yyyyqtr,
	cal_yr::number(18,0) as cal_yr,
	fisc_yr::number(18,0) as fisc_yr,
	week::number(18,0) as week,
	month::varchar(3) as month,
	retailer_name::varchar(100) as retailer_name,
	salesman_name::varchar(200) as salesman_name,
	salesman_code::varchar(100) as salesman_code,
	route_name::varchar(200) as route_name,
	route_code::varchar(100) as route_code,
	active_flag::varchar(8) as active_flag,
	rtrlatitude::varchar(40) as rtrlatitude,
	rtrlongitude::varchar(40) as rtrlongitude,
	rtruniquecode::varchar(100) as rtruniquecode,
	unique_sales_code::varchar(15) as unique_sales_code,
	createddate::timestamp_ntz(9) as createddate,
	retailer_address1::varchar(250) as retailer_address1,
	retailer_address2::varchar(250) as retailer_address2,
	retailer_address3::varchar(250) as retailer_address3,
	zone_classification::varchar(50) as zone_classification,
	state_name::varchar(50) as state_name,
	town_name::varchar(50) as town_name,
	town_classification::varchar(100) as town_classification,
	achievement_amt::number(38,6) as achievement_amt,
	gross_amt::number(38,6) as gross_amt,
	net_amt::number(38,6) as net_amt,
	num_lines::number(38,0) as num_lines,
	prd_disc_sch_amt::number(38,6) as prd_disc_sch_amt,
	tax_amt::number(38,6) as tax_amt,
	qps_amt::number(38,6) as qps_amt,
	qps_qty::number(38,0) as qps_qty,
	sku_rec_amt::number(38,6) as sku_rec_amt,
	sku_rec_qty::number(38,0) as sku_rec_qty,
	num_recsku_lines::number(38,0) as num_recsku_lines,
	num_buying_retailers::varchar(100) as num_buying_retailers,
	num_bills::varchar(151) as num_bills,
	num_packs::varchar(50) as num_packs,
	udc_hsacounter::varchar(150) as udc_hsacounter,
	udc_keyaccountname::varchar(150) as udc_keyaccountname,
	udc_pharmacychain::varchar(150) as udc_pharmacychain,
	udc_onedetailingbaby::varchar(150) as udc_onedetailingbaby,
	udc_sanprovisibilitysss::varchar(150) as udc_sanprovisibilitysss,
	udc_sssconsoffer::varchar(150) as udc_sssconsoffer,
	udc_platinumclub2018::varchar(150) as udc_platinumclub2018,
	udc_sssendcaps::varchar(150) as udc_sssendcaps,
	udc_platinumclub2019::varchar(150) as udc_platinumclub2019,
	udc_signature2019::varchar(150) as udc_signature2019,
	udc_premium2019::varchar(150) as udc_premium2019,
	udc_gstn::varchar(150) as udc_gstn,
	udc_platinumq22019new::varchar(150) as udc_platinumq22019new,
	udc_sssprogram2019::varchar(150) as udc_sssprogram2019,
	udc_umangq32019::varchar(150) as udc_umangq32019,
	udc_sssscheme2019::varchar(150) as udc_sssscheme2019,
	udc_ssspromoter2019::varchar(150) as udc_ssspromoter2019,
	udc_rtrtypeattr::varchar(150) as udc_rtrtypeattr,
	udc_bhagidariq32019::varchar(150) as udc_bhagidariq32019,
	udc_directorclubq32019::varchar(150) as udc_directorclubq32019,
	udc_platinumq32019new::varchar(150) as udc_platinumq32019new,
	udc_platinumq22019::varchar(150) as udc_platinumq22019,
	udc_platinumq32019::varchar(150) as udc_platinumq32019,
	udc_bbastore::varchar(150) as udc_bbastore,
	udc_avbabybodydocq42019::varchar(150) as udc_avbabybodydocq42019,
	udc_orslcac2019::varchar(150) as udc_orslcac2019,
	udc_babyprofesionalcac2019::varchar(150) as udc_babyprofesionalcac2019,
	udc_platinumq42019::varchar(150) as udc_platinumq42019,
	udc_schemesss2020::varchar(150) as udc_schemesss2020,
	udc_platinumq12020::varchar(150) as udc_platinumq12020,
	udc_platinumq32020::varchar(150) as udc_platinumq32020,
	udc_sssq32020::varchar(150) as udc_sssq32020,
	udc_bhagidariq32020::varchar(150) as udc_bhagidariq32020,
	udc_directorclubq32020::varchar(150) as udc_directorclubq32020,
	udc_umangq32020::varchar(150) as udc_umangq32020,
	udc_daudq32020::varchar(150) as udc_daudq32020,
	udc_daudq42020::varchar(150) as udc_daudq42020,
	udc_platinumq42020::varchar(150) as udc_platinumq42020,
	udc_directorclubq42020::varchar(150) as udc_directorclubq42020,
	udc_sssprogramq42020::varchar(150) as udc_sssprogramq42020,
	udc_bhagidariq42020::varchar(150) as udc_bhagidariq42020,
	udc_umangq42020::varchar(150) as udc_umangq42020,
	udc_samriddhi::varchar(150) as udc_samriddhi,
	udc_sssprogramq12021::varchar(150) as udc_sssprogramq12021,
	udc_platinumq12021::varchar(150) as udc_platinumq12021,
	udc_orslcac2021::varchar(150) as udc_orslcac2021,
	udc_bhagidariq12021::varchar(150) as udc_bhagidariq12021,
	udc_daudq12021::varchar(150) as udc_daudq12021,
	udc_directorclubq12021::varchar(150) as udc_directorclubq12021,
	udc_umangq12021::varchar(150) as udc_umangq12021,
	udc_platinumq22021::varchar(150) as udc_platinumq22021,
	udc_sssprogramq22021::varchar(150) as udc_sssprogramq22021,
	udc_bhagidariq22021::varchar(150) as udc_bhagidariq22021,
	udc_daudq22021::varchar(150) as udc_daudq22021,
	udc_directorclubq22021::varchar(150) as udc_directorclubq22021,
	udc_umangq22021::varchar(150) as udc_umangq22021,
	udc_platinumq32021::varchar(150) as udc_platinumq32021,
	udc_sssprogramq32021::varchar(150) as udc_sssprogramq32021,
	udc_newgtm::varchar(150) as udc_newgtm,
	udc_sssprogramq12022::varchar(150) as udc_sssprogramq12022,
	udc_ssspharmacystore::varchar(150) as udc_ssspharmacystore,
	udc_ssstotstores::varchar(150) as udc_ssstotstores,
	udc_platinumq12022::varchar(150) as udc_platinumq12022,
	udc_hsacounterq12022::varchar(150) as udc_hsacounterq12022,
	udc_bssaveenoudc2022::varchar(150) as udc_bssaveenoudc2022,
	udc_sssprogramq22022::varchar(150) as udc_sssprogramq22022,
	udc_platinumq22022::varchar(150) as udc_platinumq22022,
	udc_hsacounterq22022::varchar(150) as udc_hsacounterq22022,
	udc_ecommerce::varchar(150) as udc_ecommerce,
	udc_babytopstoreactivation::varchar(150) as udc_babytopstoreactivation,
	udc_platinumq32022::varchar(150) as udc_platinumq32022,
	udc_hsacounterq32022::varchar(150) as udc_hsacounterq32022,
	udc_platinumq42022::varchar(150) as udc_platinumq42022,
	udc_sssprogramq42022::varchar(150) as udc_sssprogramq42022,
	udc_sssprogramq12023::varchar(150) as udc_sssprogramq12023,
	udc_hsacounterq12023::varchar(150) as udc_hsacounterq12023,
	udc_platinumq12023::varchar(150) as udc_platinumq12023,
	udc_aarogyam::varchar(150) as udc_aarogyam,
	udc_sssprogramq22023::varchar(150) as udc_sssprogramq22023,
	udc_ssshyperstores2023::varchar(150) as udc_ssshyperstores2023,
	udc_winbirth2023::varchar(150) as udc_winbirth2023,
	udc_winclinic2023::varchar(150) as udc_winclinic2023,
	udc_hsacounterq22023::varchar(150) as udc_hsacounterq22023,
	udc_hsacounterq32023::varchar(150) as udc_hsacounterq32023,
	udc_aveenosssstores::varchar(150) as udc_aveenosssstores,
	udc_hsacounterq42023::varchar(150) as udc_hsacounterq42023,
	udc_hsacounterq12024::varchar(150) as udc_hsacounterq12024,
	udc_q124bssprogram::varchar(150) as udc_q124bssprogram,
	udc_specialtyprofessional2024::varchar(150) as udc_specialtyprofessional2024,
	retailer_category_cd::varchar(25) as retailer_category_cd,
	retailer_category_name::varchar(50) as retailer_category_name,
	csrtrcode::varchar(50) as csrtrcode,
	abi_ntid::varchar(1) as abi_ntid,
	flm_ntid::varchar(1) as flm_ntid,
	bdm_ntid::varchar(1) as bdm_ntid,
	rsm_ntid::varchar(1) as rsm_ntid,
	crt_dttm::timestamp_ntz(9) as crt_dttm,
	updt_dttm::timestamp_ntz(9) as updt_dttm,
	type_name::varchar(50) as type_name,
	customer_type::varchar(255) as customer_type,
	mothersku_code::varchar(50) as mothersku_code,
	salesman_status::varchar(20) as salesman_status,
	total_retailers::number(18,0) as total_retailers,
	prd_free_qty::number(18,0) as prd_free_qty,
	retailer_channel_1::varchar(200) as retailer_channel_1,
	retailer_channel_2::varchar(200) as retailer_channel_2,
	retailer_channel_3::varchar(200) as retailer_channel_3,
	report_channel::varchar(200) as report_channel,
	latest_customer_code::varchar(50) as latest_customer_code,
	latest_customer_name::varchar(150) as latest_customer_name,
	latest_territory_code::number(18,0) as latest_territory_code,
	latest_territory_name::varchar(50) as latest_territory_name,
	tlcode::varchar(50) as tlcode,
	tlname::varchar(100) as tlname,
	rsrcode::varchar(50) as rsrcode,
	rsrname::varchar(100) as rsrname,
	nielsen_townname::varchar(100) as nielsen_townname,
	nielsen_statename::varchar(100) as nielsen_statename,
	nielsen_districtname::varchar(100) as nielsen_districtname,
	nielsen_subdistrictname::varchar(100) as nielsen_subdistrictname,
	nielsen_type::varchar(10) as nielsen_type,
	nielsen_villagename::varchar(100) as nielsen_villagename,
	nielsen_pincode::number(18,0) as nielsen_pincode,
	nielsen_uacheck::varchar(100) as nielsen_uacheck,
	nielsen_uaname::varchar(100) as nielsen_uaname,
	nielsen_popstrata::varchar(100) as nielsen_popstrata,
	latest_salesman_code::varchar(50) as latest_salesman_code,
	latest_salesman_name::varchar(50) as latest_salesman_name,
	latest_uniquesalescode::varchar(50) as latest_uniquesalescode,
    prof_type::varchar(100) as prof_type,
    RBM_CODE::varchar(100) as RBM_CODE,
    ZBM_CODE::varchar(100) as ZBM_CODE,
    FBM_CODE::varchar(100) as FBM_CODE,
    HQ_CODE::varchar(100) as HQ_CODE
    from source
)
select * from final


