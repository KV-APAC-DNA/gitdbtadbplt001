version: 2

sources:  
  - name: indsdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: indsdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: sdl_mds_in_key_accounts_mapping
        tags: ["in_ecom_datamart","transformation"]
      - name: sdl_mds_in_sss_weights
        tags: ["in_sss_scorecard_mds_refresh","ingestion"]
        tests:
          - test_null__ff:
              not_null_columns: ["kpi","store_class"]
              name: TRATBL_sdl_mds_in_sss_weights__null_test
              config:
                store_failures: true
                schema: indwks_integration
          - test_duplicate__ff:
              group_by_columns: ["re","kpi","weight","store_class"]
              name: TRATBL_sdl_mds_in_sss_weights__duplicate_test
              config:
                store_failures: true
                schema: indwks_integration
      - name: sdl_mds_in_sss_score
        tags: ["in_sss_scorecard_mds_refresh","ingestion"]
        tests:
          - test_null__ff:
              not_null_columns: ["kpi","min_value","value","store_class"]
              name: TRATBL_sdl_mds_in_sss_score__null_test
              config:
                store_failures: true
                schema: indwks_integration
          - test_duplicate__ff:
              group_by_columns: ["kpi","min_value","value","store_class","re","brand","max_value"]
              name: TRATBL_sdl_mds_in_sss_score__duplicate_test
              config:
                store_failures: true
                schema: indwks_integration
      - name: sdl_mds_in_ps_msl
        tags: ["in_sss_scorecard_mds_refresh","ingestion"]
        tests:
          - test_null__ff:
              not_null_columns: ["sku_name","valid_from","valid_to","re"]
              name: TRATBL_sdl_mds_in_ps_msl__null_test
              config:
                store_failures: true
                schema: indwks_integration
          - test_duplicate__ff:
              group_by_columns: ["sku_code","sku_name","valid_from","valid_to","re"]
              name: TRATBL_sdl_mds_in_ps_msl__duplicate_test
              config:
                store_failures: true
                schema: indwks_integration
      - name: sdl_mds_in_ps_promoter_store_map
        tags: ["in_sss_scorecard_mds_refresh","ingestion"]
        tests:
          - test_null__ff:
              not_null_columns: ["channel","rtruniquecode"]
              name: TRATBL_sdl_mds_in_ps_promoter_store_map__null_test
              config:
                store_failures: true
                schema: indwks_integration
          - test_duplicate__ff:
              group_by_columns: ["channel","rtruniquecode"]
              name: TRATBL_sdl_mds_in_ps_promoter_store_map__duplicate_test
              config:
                store_failures: true
                schema: indwks_integration
      - name: sdl_sss_scorecard_data
        tags: ["in_sss_scorecard_ingestion","ingestion"]
        tests:
          - test_null__ff:
              not_null_columns: ["brand","year","quarter","kpi","jnj_id","program_type"]
              name: TRATBL_sdl_sss_scorecard_data__null_test
              config:
                store_failures: true
                schema: indwks_integration
      - name: sdl_mds_in_sss_zonal_rtr_program_mapping
        tags: ["in_sss_zonal_datamart","transformation"]
      - name: sdl_csl_rdssmweeklytarget_output
        tags: ["m_wrp_in_sdlitg_master","transformation"]

  - name: indedw_integration
    database: "{{ env_var('DBT_ENV_CORE_DB') }}"
    schema: indedw_integration
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: edw_in_invoice_fact_temp