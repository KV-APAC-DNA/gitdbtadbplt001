{{ config(
  materialized='table',
  transient=false,
  post_hook="{{ get_harmonized_brand('TRADITIONAL_ACTUAL_TV_SPEND', 'Y') }}"
) }}


select
    ts.client::varchar(16777216) as client,
    ts.cl_code::varchar(16777216) as cl_code,
    ts.cl_gstin::varchar(16777216) as cl_gstin,
    ts.product::varchar(16777216) as product,
    ts.est_no::varchar(16777216) as est_no,
    ts.est_dt::date as est_dt,
    floor(ts.est_amount, 2)::float as est_amount,
    floor(ts.est_rt10sc, 2)::float as est_rt10sc,
    ts.supp_no::varchar(16777216) as supp_no,
    ts.supp_dt::varchar(16777216) as supp_dt,
    ts.cam_code::varchar(16777216) as cam_code,
    ts.cam_des::varchar(16777216) as cam_des,
    ts.cam_rem::varchar(16777216) as cam_rem,
    ts.channel_cd::varchar(16777216) as channel_cd,
    ts.channel::varchar(16777216) as channel,
    ts.program::varchar(16777216) as program,
    ts.days::varchar(16777216) as days,
    ts.spot_date::date as spot_date,
    ts.spot_day::varchar(16777216) as spot_day,
    ts.ori_date::date as ori_date,
    ts.tele_time::varchar(16777216) as tele_time,
    ts.duration::integer as duration,
    ts.rev_date::date as rev_date,
    ts.status::varchar(16777216) as status,
    ts.ro_number::varchar(16777216) as ro_number,
    ts.ro_date::date as ro_date,
    floor(ts.ro_amount, 2)::float as ro_amount,
    floor(ts.ro_rt_10sc, 2)::float as ro_rt_10sc,
    ts.can_no::varchar(16777216) as can_no,
    ts.can_date::date as can_date,
    ts.saveest_no::varchar(16777216) as saveest_no,
    ts.currency::varchar(16777216) as currency,
    ts.moni_comp::varchar(16777216) as moni_comp,
    ts.moni_no::varchar(16777216) as moni_no,
    ts.moni_date::date as moni_date,
    ts.ad_spotord::integer as ad_spotord,
    ts.tot_spot::integer as tot_spot,
    ts.ad_time::varchar(16777216) as ad_time,
    ts.ad_lang::varchar(16777216) as ad_lang,
    ts.ob_number::varchar(16777216) as ob_number,
    ts.ob_date::date as ob_date,
    floor(ts.ob_amount, 2)::float as ob_amount,
    floor(ts.ob_rt_10sc, 2)::float as ob_rt_10sc,
    ts.vendor_cd::varchar(16777216) as vendor_cd,
    ts.ib_number::varchar(16777216) as ib_number,
    ts.ib_date::varchar(16777216) as ib_date,
    ts.entrc::varchar(16777216) as entrc,
    ts.ad_no::varchar(16777216) as ad_no,
    ts.caption::varchar(16777216) as caption,
    ts.rotocomp::varchar(16777216) as rotocomp,
    ts.vn_gstin::varchar(16777216) as vn_gstin,
    ts.pono::varchar(16777216) as pono,
    ts.po_dt::date as po_dt,
    ts.sapno::varchar(16777216) as sapno,
    ts.fa_ib_no::varchar(16777216) as fa_ib_no,
    floor(ts.aac_amt, 2)::float as aac_amt,
    floor(ts.aac_per, 2)::float as aac_per,
    floor(ts.sac_per, 2)::float as sac_per,
    floor(ts.net_ro, 2)::float as net_ro,
    floor(ts.net_ob, 2)::float as net_ob,
    floor(ts.net_ib, 2)::float as net_ib,
    ts.ro_client::varchar(16777216) as ro_client,
    ts.cat1_code::varchar(16777216) as cat1_code,
    ts.cat2_code::varchar(16777216) as cat2_code,
    ts.cat1_name::varchar(16777216) as cat1_name,
    ts.cat2_name::varchar(16777216) as cat2_name,
    floor(ts.std_rate, 2)::float as std_rate,
    floor(ts.std_cost, 2)::float as std_cost,
    floor(ts.plan_rate, 2)::float as plan_rate,
    floor(ts.plan_cost, 2)::float as plan_cost,
    ts.bill_no,
    ts.schmonth::integer as schmonth,
    ts.schyear::integer as schyear,
    ts.tape_no::varchar(16777216) as tape_no,
    ts.adtypdesc::varchar(16777216) as adtypdesc,
    ts.supbill_no::varchar(16777216) as supbill_no,
    ts.supbill_dt::date as supbill_dt,
    floor(ts.supbillamt, 2)::float as supbillamt,
    floor(ts.supbillnet, 2)::float as supbillnet,
    ts.ob_state::varchar(16777216) as ob_state,
    ts.ob_gst_on::varchar(16777216) as ob_gst_on,
    floor(ts.agngstbase, 2)::float as agngstbase,
    floor(ts.agncgstper, 2)::float as agncgstper,
    floor(ts.agncomcgst, 2)::float as agncomcgst,
    floor(ts.agnsgstper, 2)::float as agnsgstper,
    floor(ts.agncomsgst, 2)::float as agncomsgst,
    floor(ts.agnigstper, 2)::float as agnigstper,
    floor(ts.agncomigst, 2)::float as agncomigst,
    ts.recovertax::varchar(16777216) as recovertax,
    floor(ts.ob_gstbase, 2)::float as ob_gstbase,
    floor(ts.ob_cgstper, 2)::float as ob_cgstper,
    floor(ts.ob_cgstamt, 2)::float as ob_cgstamt,
    floor(ts.ob_sgstper, 2)::float as ob_sgstper,
    floor(ts.ob_sgstamt, 2)::float as ob_sgstamt,
    floor(ts.ob_igstper, 2)::float as ob_igstper,
    floor(ts.ob_igstamt, 2)::float as ob_igstamt,
    ts.irn_no::varchar(16777216) as irn_no,
    ts.ack_no::varchar(16777216) as ack_no,
    ts.ack_dt::date as ack_dt,
    ts."GROUP"::varchar(16777216) as "group",
    ts.tel_stn::varchar(16777216) as tel_stn,
    ts.key::varchar(16777216) as key,
    ts.cl_total::varchar(16777216) as cl_total,
    ts.rocl_cd::varchar(16777216) as rocl_cd,
    ts.stventer::varchar(16777216) as stventer,
    ts.est_spot::integer as est_spot,
    ts.mediam::varchar(16777216) as mediam,
    ts.pr_code::varchar(16777216) as pr_code,
    floor(ts.ob_cost, 2)::float as ob_cost_inr,
    ts.uidkey::varchar(16777216) as uidkey,
    ts.comp_grpcd::varchar(16777216) as comp_grpcd,
    ts.comp_grpnm::varchar(16777216) as comp_grpnm,
    ts.house_name::varchar(16777216) as house_name,
    ts.prov_on::varchar(16777216) as prov_on,
    'india'::varchar(16777216) as gcgh_country,
    null::varchar(16777216) as gcph_brand,
    null::varchar(16777216) as brand_harmonized_by,
    current_timestamp()::timestamp_ltz(9) as crt_dttm
--try_to_timestamp('') as updt_dttm
from {{ source(
      "indsdl_raw",
      "sdl_lidar_ff_tv_spends"
    ) }} as ts
