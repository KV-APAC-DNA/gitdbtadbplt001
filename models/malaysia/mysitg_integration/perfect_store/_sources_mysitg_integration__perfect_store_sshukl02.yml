version: 2

sources:
  - name: myssdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: snaposesdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: sdl_my_perfectstore_oos
        tests:
          - test_null:
              select_columns: ["filename","date","region","outlet","outlet_no","category","brand","product_barcode","sku_description","answer"]
              not_null_columns: ["date","outlet_no","product_barcode","answer"]
              name: TRATBL_sdl_my_perfectstore_oos__null_test
              config:
                store_failures: true
                schema: myswks_integration
      - name: sdl_my_perfectstore_promocomp
        tests:
          - test_null:
              select_columns: ["filename","date","brand","region","category","outlet_no"]
              not_null_columns: ["date","brand","outlet_no"]
              name: TRATBL_sdl_my_perfectstore_promocomp__null_test
              config:
                store_failures: true
                schema: myswks_integration
      - name: sdl_mds_my_ps_msl
        tests:
          - test_null:
              select_columns: ["name","ean","product_name","valid_from","valid_to"]
              not_null_columns: ["name","ean"]
              name: TRATBL_sdl_mds_my_ps_msl__null_test
              config:
                store_failures: true
                schema: myswks_integration
          - test_duplicate:
              select_columns: ["name","ean","product_name","valid_from","valid_to"]
              group_by_columns: ["name","ean","product_name","valid_from","valid_to"]
              name: TRATBL_sdl_mds_my_ps_msl__test_duplicate
              config:
                store_failures: true
                schema: myswks_integration
      - name: sdl_mds_my_ps_targets
        tests:
          - test_null:
              select_columns: ["kpi","channel","re","attribute1","attribute2","value"]
              not_null_columns: ["kpi","channel","re","attribute1","attribute2","value"]
              name: TRATBL_sdl_mds_my_ps_targets__null_test
              config:
                store_failures: true
                schema: myswks_integration
          - test_duplicate:
                select_columns: ["kpi","channel","re","attribute1","attribute2","value"]
                group_by_columns: ["kpi","channel","re","attribute1","attribute2","value"]
                name: TRATBL_sdl_mds_my_ps_targets__test_duplicate
                config:
                  store_failures: true
                  schema: myswks_integration
      - name: sdl_mds_my_ps_weights
        tests:
          - test_null:
              select_columns: ["name","kpi","channel"]
              not_null_columns: ["name","kpi","channel"]
              name: TRATBL_sdl_mds_my_ps_weights__null_test
              config:
                store_failures: true
                schema: myswks_integration
          - test_duplicate:
              select_columns: ["name","kpi","channel"]
              group_by_columns: ["name","kpi","channel"]
              name: TRATBL_sdl_mds_my_ps_weights__duplicate_test
              config:
                store_failures: true
                schema: myswks_integration
