{{
    config(
        sql_header="USE WAREHOUSE "+ env_var("DBT_ENV_CORE_DB_MEDIUM_WH")+ ";"
    )
}}
with source as (
    select * from {{ ref('mysedw_integration__edw_vw_my_sellin_analysis') }}
),

final as (
    select 
        data_src::varchar(12) as data_src,
        jj_year::number(18,0) as jj_year,
        jj_qtr::varchar(14) as jj_qtr,
        jj_mnth_id::varchar(23) as jj_mnth_id,
        jj_mnth_no::number(18,0) as jj_mnth_no,
        sap_cntry_cd::varchar(3) as sap_cntry_cd,
        cntry_nm::varchar(8) as cntry_nm,
        acct_no::varchar(10) as acct_no,
        acct_desc::varchar(100) as acct_desc,
        sap_state_cd::varchar(150) as sap_state_cd,
        sold_to::varchar(10) as sold_to,
        sold_to_nm::varchar(100) as sold_to_nm,
        sap_sls_org::varchar(4) as sap_sls_org,
        sap_cmp_id::varchar(6) as sap_cmp_id,
        sap_addr::varchar(150) as sap_addr,
        sap_region::varchar(150) as sap_region,
        sap_city::varchar(150) as sap_city,
        sap_post_cd::varchar(150) as sap_post_cd,
        sap_chnl_cd::varchar(2) as sap_chnl_cd,
        sap_chnl_desc::varchar(20) as sap_chnl_desc,
        sap_sls_office_cd::varchar(4) as sap_sls_office_cd,
        sap_sls_office_desc::varchar(40) as sap_sls_office_desc,
        sap_sls_grp_cd::varchar(3) as sap_sls_grp_cd,
        sap_sls_grp_desc::varchar(40) as sap_sls_grp_desc,
        sap_curr_cd::varchar(5) as sap_curr_cd,
        gch_region::varchar(50) as gch_region,
        gch_cluster::varchar(50) as gch_cluster,
        gch_subcluster::varchar(50) as gch_subcluster,
        gch_market::varchar(50) as gch_market,
        gch_retail_banner::varchar(50) as gch_retail_banner,
        loc_cust_nm::varchar(100) as loc_cust_nm,
        dstrbtr_grp_cd::varchar(20) as dstrbtr_grp_cd,
        dstrbtr_grp_nm::varchar(100) as dstrbtr_grp_nm,
        ullage::number(20,4) as ullage,
        chnl::varchar(20) as chnl,
        territory::varchar(20) as territory,
        retail_env::varchar(20) as retail_env,
        rdd_ind::varchar(10) as rdd_ind,
        matl_num::varchar(40) as matl_num,
        matl_desc::varchar(100) as matl_desc,
        matl_desc2::varchar(200) as matl_desc2,
        matl_desc3::varchar(200) as matl_desc3,
        frnchse_desc::varchar(100) as frnchse_desc,
        brnd_desc::varchar(100) as brnd_desc,
        vrnt_desc::varchar(100) as vrnt_desc,
        sku_ean_num::varchar(100) as sku_ean_num,
        global_mat_region::varchar(50) as global_mat_region,
        global_prod_franchise::varchar(30) as global_prod_franchise,
        global_prod_brand::varchar(30) as global_prod_brand,
        global_prod_variant::varchar(100) as global_prod_variant,
        global_prod_put_up_cd::varchar(10) as global_prod_put_up_cd,
        global_put_up_desc::varchar(100) as global_put_up_desc,
        put_up_desc::varchar(40) as put_up_desc,
        sap_prod_mnr_cd::varchar(18) as sap_prod_mnr_cd,
        sap_prod_mnr_desc::varchar(100) as sap_prod_mnr_desc,
        sap_prod_hier_cd::varchar(18) as sap_prod_hier_cd,
        sap_prod_hier_desc::varchar(100) as sap_prod_hier_desc,
        global_prod_sub_brand::varchar(100) as global_prod_sub_brand,
        global_prod_need_state::varchar(50) as global_prod_need_state,
        global_prod_category::varchar(50) as global_prod_category,
        global_prod_subcategory::varchar(50) as global_prod_subcategory,
        global_prod_segment::varchar(50) as global_prod_segment,
        global_prod_subsegment::varchar(100) as global_prod_subsegment,
        global_prod_size::varchar(20) as global_prod_size,
        global_prod_size_uom::varchar(20) as global_prod_size_uom,
        sku_launch_dt::timestamp_ntz(9) as sku_launch_dt,
        qty_shipper_pc::varchar(100) as qty_shipper_pc,
        prft_ctr::varchar(100) as prft_ctr,
        shelf_life::varchar(100) as shelf_life,
        npi_ind::varchar(10) as npi_ind,
        npi_strt_period::varchar(10) as npi_strt_period,
        hero_ind::varchar(10) as hero_ind,
        ciw_ctgry::varchar(100) as ciw_ctgry,
        ciw_buckt1::varchar(100) as ciw_buckt1,
        ciw_buckt2::varchar(100) as ciw_buckt2,
        bravo_desc1::varchar(100) as bravo_desc1,
        bravo_desc2::varchar(100) as bravo_desc2,
        acct_type::varchar(20) as acct_type,
        acct_type1::varchar(20) as acct_type1,
        from_crncy::varchar(5) as from_crncy,
        to_crncy::varchar(5) as to_crncy,
        exch_rate::number(15,5) as exch_rate,
        base_val::number(20,4) as base_val,
        sls_qty::number(20,4) as sls_qty,
        ret_qty::number(20,4) as ret_qty,
        sls_less_rtn_qty::number(20,4) as sls_less_rtn_qty,
        gts_val::number(20,4) as gts_val,
        ret_val::number(20,4) as ret_val,
        gts_less_rtn_val::number(20,4) as gts_less_rtn_val,
        trdng_term_val::number(20,4) as trdng_term_val,
        tp_val::number(20,4) as tp_val,
        trde_prmtn_val::number(20,4) as trde_prmtn_val,
        nts_val::number(20,4) as nts_val,
        nts_qty::number(20,4) as nts_qty,
        po_num::varchar(30) as po_num,
        sls_doc_num::varchar(50) as sls_doc_num,
        sls_doc_item::varchar(50) as sls_doc_item,
        sls_doc_type::varchar(30) as sls_doc_type,
        bill_num::varchar(50) as bill_num,
        bill_item::varchar(50) as bill_item,
        doc_creation_dt::date as doc_creation_dt,
        order_status::varchar(19) as order_status,
        item_status::varchar(24) as item_status,
        rejectn_st::varchar(20) as rejectn_st,
        rejectn_cd::varchar(30) as rejectn_cd,
        rejectn_desc::varchar(1) as rejectn_desc,
        ord_qty::number(38,4) as ord_qty,
        ord_net_price::number(38,13) as ord_net_price,
        ord_grs_trd_sls::number(38,13) as ord_grs_trd_sls,
        ord_subtotal_2::number(38,13) as ord_subtotal_2,
        ord_subtotal_3::number(38,13) as ord_subtotal_3,
        ord_subtotal_4::number(38,13) as ord_subtotal_4,
        ord_net_amt::number(38,13) as ord_net_amt,
        ord_est_nts::number(38,13) as ord_est_nts,
        missed_val::number(38,13) as missed_val,
        bill_qty_pc::number(38,4) as bill_qty_pc,
        bill_grs_trd_sls::number(38,13) as bill_grs_trd_sls,
        bill_subtotal_2::number(38,13) as bill_subtotal_2,
        bill_subtotal_3::number(38,13) as bill_subtotal_3,
        bill_subtotal_4::number(38,13) as bill_subtotal_4,
        bill_net_amt::number(38,13) as bill_net_amt,
        bill_est_nts::number(38,13) as bill_est_nts,
        bill_net_val::number(38,13) as bill_net_val,
        bill_gross_val::number(38,13) as bill_gross_val,
        trgt_type::varchar(20) as trgt_type,
        trgt_val_type::varchar(20) as trgt_val_type,
        trgt_val::number(36,11) as trgt_val,
        accrual_val::number(36,11) as accrual_val,
        le_trgt_val_wk1::number(36,11) as le_trgt_val_wk1,
        le_trgt_val_wk2::number(36,11) as le_trgt_val_wk2,
        le_trgt_val_wk3::number(36,11) as le_trgt_val_wk3,
        le_trgt_val_wk4::number(36,11) as le_trgt_val_wk4,
        le_trgt_val_wk5::number(36,11) as le_trgt_val_wk5,
        curr_prd_elapsed::number(20,6) as curr_prd_elapsed,
        elapsed_flag::varchar(1) as elapsed_flag,
        is_curr::varchar(1) as is_curr,
        afgr_num::varchar(30) as afgr_num,
        cust_dn_num::varchar(100) as cust_dn_num,
        rtn_ord_num::varchar(30) as rtn_ord_num,
        afgr_bill_num::varchar(30) as afgr_bill_num,
        dn_amt_exc_gst_val::number(38,9) as dn_amt_exc_gst_val,
        afgr_amt::number(38,9) as afgr_amt,
        rtn_ord_amt::number(38,9) as rtn_ord_amt,
        cn_amt::number(38,9) as cn_amt,
        afgr_status::varchar(30) as afgr_status,
        afgr_val::number(38,9) as afgr_val,
        afgr_cn_diff::number(38,9) as afgr_cn_diff,
        cur_period_sgt::varchar(23) as cur_period_sgt
    from source
)

select * from final