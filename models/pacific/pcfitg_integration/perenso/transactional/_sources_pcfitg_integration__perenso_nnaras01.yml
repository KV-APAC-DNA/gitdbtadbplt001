version: 2

sources:
  - name: pcfsdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: pcfsdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:

    - name: sdl_perenso_todo
      tags: ["anz_perenso_head_office_req","ingestion"]
      tests:
          - test_null:
              not_null_columns: ["todo_key","work_item_key"]
              select_columns: ["todo_key","work_item_key"]
              name: TRATBL_sdl_perenso_todo__null_test
              config:
                store_failures: true
                schema: vnmwks_integration

          - test_duplicate:
              group_by_columns: ["todo_key","work_item_key"]
              select_columns: ["todo_key","work_item_key"]
              name: TRATBL_sdl_perenso_todo__duplicate_test
              config:
                store_failures: true
                schema: vnmwks_integration
    - name: sdl_perenso_head_office_req_state
      tags: ["anz_perenso_head_office_req","ingestion"]
      tests:
          - test_null:
              not_null_columns: ["acct_key","store_chk_hdr_key","todo_key","prod_grp_key"]
              select_columns: ["acct_key","store_chk_hdr_key","todo_key","prod_grp_key"]
              name: TRATBL_sdl_perenso_head_office_req_state__null_test
              config:
                store_failures: true
                schema: vnmwks_integration

          - test_duplicate:
              group_by_columns: ["acct_key","store_chk_hdr_key","todo_key","prod_grp_key"]
              select_columns: ["acct_key","store_chk_hdr_key","todo_key","prod_grp_key"]
              name: TRATBL_sdl_perenso_head_office_req_state__duplicate_test
              config:
                store_failures: true
                schema: vnmwks_integration
    - name: sdl_perenso_head_office_req_check
      tags: ["anz_perenso_head_office_req","ingestion"]
      tests:
          - test_null:
              not_null_columns: ["store_chk_hdr_key","todo_key","prod_grp_key"]
              select_columns: ["store_chk_hdr_key","todo_key","prod_grp_key"]
              name: TRATBL_sdl_perenso_head_office_req_check__null_test
              config:
                store_failures: true
                schema: vnmwks_integration

          - test_duplicate:
              group_by_columns: ["store_chk_hdr_key","todo_key","prod_grp_key"]
              select_columns: ["store_chk_hdr_key","todo_key","prod_grp_key"]
              name: TRATBL_sdl_perenso_head_office_req_check__duplicate_test
              config:
                store_failures: true
                schema: vnmwks_integration

    - name: sdl_perenso_store_chk_hdr
      tags: ["anz_perenso_head_office_req","ingestion"]
      tests:
          - test_null:
              not_null_columns: ["store_chk_hdr_key","diary_item_key","acct_key","work_item_key"]
              select_columns: ["store_chk_hdr_key","diary_item_key","acct_key","work_item_key"]
              name: TRATBL_sdl_perenso_store_chk_hdr__null_test
              config:
                store_failures: true
                schema: vnmwks_integration

          - test_duplicate:
              group_by_columns: ["store_chk_hdr_key","diary_item_key","acct_key","work_item_key"]
              select_columns: ["store_chk_hdr_key","diary_item_key","acct_key","work_item_key"]
              name: TRATBL_sdl_perenso_store_chk_hdr__duplicate_test
              config:
                store_failures: true
                schema: vnmwks_integration
    - name: sdl_metcash_ind_grocery
      tags: ["anz_perenso_head_office_req","ingestion"]
    - name: sdl_perenso_account_group_lvl
      tags: ["anz_perenso_head_office_req","ingestion"]
      tests:
          - test_null:
              not_null_columns: ["field_key","acct_grp_lev_key"]
              select_columns: ["field_key","acct_grp_lev_key"]
              name: TRATBL_sdl_perenso_account_group_lvl__null_test
              config:
                store_failures: true
                schema: vnmwks_integration

          - test_duplicate:
              group_by_columns: ["field_key","acct_grp_lev_key"]
              select_columns: ["field_key","acct_grp_lev_key"]
              name: TRATBL_sdl_perenso_account_group_lvl__duplicate_test
              config:
                store_failures: true
                schema: vnmwks_integration
    - name: sdl_perenso_account_group
      tags: ["anz_perenso_head_office_req","ingestion"]
      tests:
          - test_null:
              not_null_columns: ["acct_grp_key","acct_grp_lev_key"]
              select_columns: ["acct_grp_key","acct_grp_lev_key"]
              name: TRATBL_sdl_perenso_account_group__null_test
              config:
                store_failures: true
                schema: vnmwks_integration

          - test_duplicate:
              group_by_columns: ["acct_grp_key","acct_grp_lev_key"]
              select_columns: ["acct_grp_key","acct_grp_lev_key"]
              name: TRATBL_sdl_perenso_account_group__duplicate_test
              config:
                store_failures: true
                schema: vnmwks_integration
    - name: sdl_perenso_account_fields
      tags: ["anz_perenso_head_office_req","ingestion"]
      tests:
          - test_null:
              not_null_columns: ["field_key","acct_type_key"]
              select_columns: ["field_key","acct_type_key"]
              name: TRATBL_sdl_perenso_account_fields__null_test
              config:
                store_failures: true
                schema: vnmwks_integration

          - test_duplicate:
              group_by_columns: ["field_key","acct_type_key"]
              select_columns: ["field_key","acct_type_key"]
              name: TRATBL_sdl_perenso_account_fields__duplicate_test
              config:
                store_failures: true
                schema: vnmwks_integration
    - name: sdl_perenso_users
      tags: ["anz_perenso_head_office_req","ingestion"]
    - name: sdl_perenso_diary_item
      tags: ["anz_perenso_sales_rep","ingestion"]


  
    



    
