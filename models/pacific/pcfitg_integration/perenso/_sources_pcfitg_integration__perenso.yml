version: 2

sources:
  - name: pcfsdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: pcfsdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
    - name: sdl_perenso_work_item
      tags: ["anz_perenso_call",""]
      tests:
          - test_null__ff:
              not_null_columns: ["work_item_key","work_item_type"]
              name: TRATBL_sdl_perenso_work_item__null_test
              config:
                store_failures: true
                schema: pcfwks_integration
          - test_duplicate__ff:
              group_by_columns: ["work_item_key","work_item_type"]
              name: TRATBL_sdl_perenso_work_item__duplicate_test
              config:
                store_failures: true
                schema: pcfwks_integration
        
    - name: sdl_perenso_diary_item_type
      tags: ["anz_perenso_call",""]
      tests:
          - test_null__ff:
              not_null_columns: ["diary_item_type_key"]
              name: TRATBL_sdl_perenso_diary_item_type__null_test
              config:
                store_failures: true
                schema: pcfwks_integration
          - test_duplicate__ff:
              group_by_columns: ["diary_item_type_key"]
              name: TRATBL_sdl_perenso_diary_item_type__duplicate_test
              config:
                store_failures: true
                schema: pcfwks_integration
    - name: sdl_perenso_call_objectives
      tags: ["anz_perenso_call",""]
      tests:
          - test_null__ff:
              not_null_columns: ["assigned_user_key","created_user_key","objective_key","acct_key"]
              name: TRATBL_sdl_perenso_call_objectives__null_test
              config:
                store_failures: true
                schema: pcfwks_integration
          
    - name: sdl_perenso_diary_item_time
      tags: ["anz_perenso_call",""]
      tests:
          - test_null:
              select_columns: ["diary_item_key"]
              not_null_columns: ["diary_item_key"]
              name: TRATBL_sdl_perenso_diary_item_time__null_test
              config:
                store_failures: true
                schema: pcfwks_integration
    - name: sdl_perenso_todo_option
      tags: ["anz_perenso_survey_ques",""]
      tests:
          - test_null:
              select_columns: ["todo_key","option_key"]
              not_null_columns: ["todo_key","option_key"]
              name: TRATBL_sdl_perenso_todo_option__null_test
              config:
                store_failures: true
                schema: pcfwks_integration
          - test_duplicate:
              select_columns: ["todo_key","option_key"]
              group_by_columns: ["todo_key","option_key"]
              name: TRATBL_sdl_perenso_todo_option__duplicate_test
              config:
                store_failures: true
                schema: pcfwks_integration
    - name: sdl_perenso_survey_result
      tags: ["anz_perenso_survey_ques",""]
      tests:
          - test_null:
              select_columns: ["store_chk_hdr_key","line_key","todo_key","prod_grp_key"]
              not_null_columns: ["store_chk_hdr_key","line_key","todo_key","prod_grp_key"]
              name: TRATBL_sdl_perenso_survey_result__null_test
              config:
                store_failures: true
                schema: pcfwks_integration
          - test_duplicate:
              select_columns: ["store_chk_hdr_key","line_key","todo_key","prod_grp_key"]
              group_by_columns: ["store_chk_hdr_key","line_key","todo_key","prod_grp_key"]
              name: TRATBL_sdl_perenso_survey_result__duplicate_test
              config:
                store_failures: true
                schema: pcfwks_integration
      
    - name: sdl_perenso_over_and_above
      tags: ["anz_perenso_over_and_above",""]
      tests:
          - test_null:
              select_columns: ["over_and_above_key","acct_key","todo_option_key","prod_grp_key"]
              not_null_columns: ["over_and_above_key","acct_key","todo_option_key","prod_grp_key"]
              name: TRATBL_sdl_perenso_over_and_above__null_test
              config:
                store_failures: true
                schema: pcfwks_integration
          - test_duplicate:
              select_columns: ["over_and_above_key","acct_key","todo_option_key","prod_grp_key"]
              group_by_columns: ["over_and_above_key","acct_key","todo_option_key","prod_grp_key"]
              name: TRATBL_sdl_perenso_over_and_above__duplicate_test
              config:
                store_failures: true
                schema: pcfwks_integration
    - name: sdl_perenso_prod_chk_distribution
      tags: ["anz_perenso_over_and_above",""]
      tests:
          - test_null__ff:
              not_null_columns: ["acct_key","prod_key"]
              name: TRATBL_sdl_perenso_prod_chk_distribution__null_test
              config:
                store_failures: true
                schema: pcfwks_integration
          - test_duplicate__ff:
              group_by_columns: ["acct_key","prod_key","start_date","end_date"]
              name: TRATBL_sdl_perenso_prod_chk_distribution__duplicate_test
              config:
                store_failures: true
                schema: pcfwks_integration

    - name: sdl_perenso_over_and_above_state
      tags: ["anz_perenso_over_and_above",""]
      tests:
          - test_null:
              select_columns: ["over_and_above_key","store_chk_hdr_key"]
              not_null_columns: ["over_and_above_key","store_chk_hdr_key"]
              name: TRATBL_sdl_perenso_over_and_above_state__null_test
              config:
                store_failures: true
                schema: pcfwks_integration
          - test_duplicate:
              select_columns: ["over_and_above_key","store_chk_hdr_key"]
              group_by_columns: ["over_and_above_key","store_chk_hdr_key"]
              name: TRATBL_sdl_perenso_over_and_above_state__duplicate_test
              config:
                store_failures: true
                schema: pcfwks_integration