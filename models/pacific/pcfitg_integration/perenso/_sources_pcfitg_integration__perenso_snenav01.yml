version: 2

sources:
  - name: pcfsdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: pcfsdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: sdl_perenso_ranging
        tags: ["anz_perenso_ranging","ingestion"]
        tests:
          - test_null:
                not_null_columns: ["acct_grp_lev_key", "ranging_key"]
                select_columns: ["acct_grp_lev_key", "ranging_key"]
                name: TRATBL_sdl_perenso_ranging__null_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
          - test_duplicate:
                group_by_columns: ["acct_grp_lev_key", "ranging_key"]
                select_columns: ["acct_grp_lev_key", "ranging_key"]
                name: TRATBL_sdl_perenso_ranging__duplicate_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
      - name: sdl_perenso_ranging_product
        tags: ["anz_perenso_ranging","ingestion"]
        tests:
          - test_null:
                not_null_columns: ["ranging_key","prod_key","acct_grp_key"]
                select_columns: ["ranging_key","prod_key","acct_grp_key"]
                name: TRATBL_sdl_perenso_ranging_product__null_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
          - test_duplicate:
                group_by_columns: ["ranging_key","prod_key","acct_grp_key"]
                select_columns: ["ranging_key","prod_key","acct_grp_key"]
                name: TRATBL_sdl_perenso_ranging_product__duplicate_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
      - name: sdl_perenso_ranging_acct_grp_rel
        tags: ["anz_perenso_ranging","ingestion"]
        tests:
          - test_null:
                not_null_columns: ["acct_grp_key","ranging_key"]
                select_columns: ["acct_grp_key","ranging_key"]
                name: TRATBL_sdl_perenso_ranging_acct_grp_rel__null_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
          - test_duplicate:
                group_by_columns: ["acct_grp_key","ranging_key"]
                select_columns: ["acct_grp_key","ranging_key"]
                name: TRATBL_sdl_perenso_ranging_acct_grp_rel__duplicate_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
      - name: sdl_perenso_account_group_reln
        tags: ["anz_perenso_account","ingestion"]
        tests:
          - test_null:
                not_null_columns: ["acct_grp_key","acct_key"]
                select_columns: ["acct_grp_key","acct_key"]
                name: TRATBL_sdl_perenso_account_group_reln__null_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
          - test_duplicate:
                group_by_columns: ["acct_grp_key","acct_key"]
                select_columns: ["acct_grp_key","acct_key"]
                name: TRATBL_sdl_perenso_account_group_reln__duplicate_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
      - name: sdl_perenso_account_reln_id
        tags: ["anz_perenso_account","ingestion"]
        tests:
          - test_null:
                not_null_columns: ["field_key","acct_key"]
                select_columns: ["field_key","acct_key","id"]
                name: TRATBL_sdl_perenso_account_reln_id__null_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
          - test_duplicate:
                group_by_columns: ["field_key","acct_key","id"]
                select_columns: ["field_key","acct_key","id"]
                name: TRATBL_sdl_perenso_account_reln_id__duplicate_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
      - name: sdl_perenso_account_type
        tags: ["anz_perenso_account","ingestion"]
        tests:
          - test_null:
                not_null_columns: ["acct_type_key"]
                select_columns: ["acct_type_key"]
                name: TRATBL_sdl_perenso_account_type__null_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
          - test_duplicate:
                group_by_columns: ["acct_type_key"]
                select_columns: ["acct_type_key"]
                name: TRATBL_sdl_perenso_account_type__duplicate_test
                config:
                  store_failures: true
                  schema: pcfwks_integration 
      - name: sdl_perenso_account
        tags: ["anz_perenso_account","ingestion"]
        tests:
          - test_null:
                not_null_columns: ["acct_key","acct_type_key"]
                select_columns: ["acct_key","acct_type_key"]
                name: TRATBL_sdl_perenso_account__null_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
          - test_duplicate:
                group_by_columns: ["acct_key","acct_type_key"]
                select_columns: ["acct_key","acct_type_key"]
                name: TRATBL_sdl_perenso_account__duplicate_test
                config:
                  store_failures: true
                  schema: pcfwks_integration 
      - name: sdl_perenso_acct_dist_acct
        tags: ["anz_perenso_account","ingestion"]
        tests:
          - test_null:
                not_null_columns: ["acct_key","branch_key"]
                select_columns: ["acct_key","branch_key","id"]
                name: TRATBL_sdl_perenso_acct_dist_acct__null_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
          - test_duplicate:
                group_by_columns: ["acct_key","branch_key","id"]
                select_columns: ["acct_key","branch_key","id"]
                name: TRATBL_sdl_perenso_acct_dist_acct__duplicate_test
                config:
                  store_failures: true
                  schema: pcfwks_integration 
      - name: sdl_perenso_distributor_detail
        tags: ["anz_perenso_account","ingestion"]
        tests:
          - test_null:
                not_null_columns: ["dist_key","branch_key"]
                select_columns: ["dist_key","branch_key"]
                name: TRATBL_sdl_perenso_distributor_detail__null_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
          - test_duplicate:
                group_by_columns: ["dist_key","branch_key"]
                select_columns: ["dist_key","branch_key"]
                name: TRATBL_sdl_perenso_distributor_detail__duplicate_test
                config:
                  store_failures: true
                  schema: pcfwks_integration
      - name: sdl_perenso_account_custom_list