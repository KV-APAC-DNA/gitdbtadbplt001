with source as(
    select * from {{ ref('pcfedw_integration__vw_invoice_analysis') }}
),
final as(
    select 
        matl_id::varchar(40) as matl_id,
        matl_desc::varchar(100) as matl_desc,
        mega_brnd_cd::varchar(10) as mega_brnd_cd,
        mega_brnd_desc::varchar(100) as mega_brnd_desc,
        brnd_cd::varchar(10) as brnd_cd,
        brnd_desc::varchar(100) as brnd_desc,
        base_prod_cd::varchar(10) as base_prod_cd,
        base_prod_desc::varchar(100) as base_prod_desc,
        variant_cd::varchar(10) as variant_cd,
        variant_desc::varchar(100) as variant_desc,
        fran_cd::varchar(18) as fran_cd,
        fran_desc::varchar(100) as fran_desc,
        grp_fran_cd::varchar(18) as grp_fran_cd,
        grp_fran_desc::varchar(100) as grp_fran_desc,
        matl_type_cd::varchar(10) as matl_type_cd,
        matl_type_desc::varchar(40) as matl_type_desc,
        prod_fran_cd::varchar(18) as prod_fran_cd,
        prod_fran_desc::varchar(100) as prod_fran_desc,
        prod_hier_cd::varchar(40) as prod_hier_cd,
        prod_hier_desc::varchar(100) as prod_hier_desc,
        prod_mjr_cd::varchar(18) as prod_mjr_cd,
        prod_mjr_desc::varchar(100) as prod_mjr_desc,
        prod_mnr_cd::varchar(18) as prod_mnr_cd,
        prod_mnr_desc::varchar(100) as prod_mnr_desc,
        mercia_plan::varchar(10) as mercia_plan,
        putup_cd::varchar(10) as putup_cd,
        putup_desc::varchar(100) as putup_desc,
        bar_cd::varchar(40) as bar_cd,
        updt_dt::timestamp_ntz(9) as updt_dt,
        cust_no::varchar(10) as cust_no,
        cmp_id::varchar(20) as cmp_id,
        channel_cd::varchar(20) as channel_cd,
        channel_desc::varchar(20) as channel_desc,
        ctry_key::varchar(150) as ctry_key,
        country::varchar(20) as country,
        state_cd::varchar(150) as state_cd,
        post_cd::varchar(150) as post_cd,
        cust_suburb::varchar(150) as cust_suburb,
        cust_nm::varchar(100) as cust_nm,
        sls_org::varchar(20) as sls_org,
        cust_del_flag::varchar(1) as cust_del_flag,
        sales_office_cd::varchar(20) as sales_office_cd,
        sales_office_desc::varchar(30) as sales_office_desc,
        sales_grp_cd::varchar(20) as sales_grp_cd,
        sales_grp_desc::varchar(30) as sales_grp_desc,
        mercia_ref::varchar(150) as mercia_ref,
        curr_cd::varchar(5) as curr_cd,
        cal_date::timestamp_ntz(9) as cal_date,
        time_id::number(18,0) as time_id,
        jj_wk::number(18,0) as jj_wk,
        jj_mnth::number(18,0) as jj_mnth,
        jj_mnth_shrt::varchar(3) as jj_mnth_shrt,
        jj_mnth_long::varchar(10) as jj_mnth_long,
        jj_qrtr::number(18,0) as jj_qrtr,
        jj_year::number(18,0) as jj_year,
        cal_mnth_id::number(18,0) as cal_mnth_id,
        jj_mnth_id::number(18,0) as jj_mnth_id,
        cal_mnth::number(18,0) as cal_mnth,
        cal_qrtr::number(18,0) as cal_qrtr,
        cal_year::number(18,0) as cal_year,
        jj_mnth_tot::number(18,0) as jj_mnth_tot,
        jj_mnth_day::number(18,0) as jj_mnth_day,
        cal_mnth_nm::varchar(10) as cal_mnth_nm,
        act_delv_dt::date as act_delv_dt,
        act_good_iss_dt::date as act_good_iss_dt,
        base_uom::varchar(4) as base_uom,
        bill_doc::varchar(10) as bill_doc,
        bill_dt::date as bill_dt,
        bill_qty_cse::number(15,4) as bill_qty_cse,
        bill_qty_difot::number(15,4) as bill_qty_difot,
        bill_qty_otif::number(15,4) as bill_qty_otif,
        bill_qty_pc::number(15,4) as bill_qty_pc,
        bill_qty_sls_uom::number(15,4) as bill_qty_sls_uom,
        bill_to_prty::varchar(10) as bill_to_prty,
        bill_typ::varchar(4) as bill_typ,
        cal_day::date as cal_day,
        cnfrm_qty_difot::number(15,4) as cnfrm_qty_difot,
        cnfrm_qty_pc::number(15,4) as cnfrm_qty_pc,
        co_cd::varchar(4) as co_cd,
        crt_dttm::timestamp_ntz(9) as crt_dttm,
        curr_key::varchar(5) as curr_key,
        cust_num::varchar(10) as cust_num,
        delv_doc_crt_dt::date as delv_doc_crt_dt,
        delv_qty_cse::number(15,4) as delv_qty_cse,
        delv_qty_pc::number(15,4) as delv_qty_pc,
        delv_qty_sls_uom::number(15,4) as delv_qty_sls_uom,
        div::varchar(2) as div,
        doc_crt_dt::date as doc_crt_dt,
        doc_curr::varchar(5) as doc_curr,
        doc_dt::date as doc_dt,
        dstr_chnl::varchar(2) as dstr_chnl,
        est_nts::number(15,4) as est_nts,
        fisc_yr::varchar(10) as fisc_yr,
        fisc_yr_src::varchar(10) as fisc_yr_src,
        fut_sls_qty::number(15,4) as fut_sls_qty,
        good_iss_dt::date as good_iss_dt,
        future_gts_val::number(31,9) as future_gts_val,
        mat_avail_dt::date as mat_avail_dt,
        matl_num::varchar(18) as matl_num,
        net_amt::number(15,4) as net_amt,
        net_bill_val::number(15,4) as net_bill_val,
        net_invc_sls::number(15,4) as net_invc_sls,
        net_ord_val::number(15,4) as net_ord_val,
        net_prc::number(15,4) as net_prc,
        nts_val::number(31,9) as nts_val,
        ord_pc_qty::number(15,4) as ord_pc_qty,
        ord_qty_cse::number(15,4) as ord_qty_cse,
        ord_qty_pc::number(15,4) as ord_qty_pc,
        ord_rsn::varchar(3) as ord_rsn,
        ord_sls_qty::number(15,4) as ord_sls_qty,
        ovrl_rej_sts::varchar(1) as ovrl_rej_sts,
        ovrl_sts_crd_chk::varchar(1) as ovrl_sts_crd_chk,
        payer::varchar(10) as payer,
        plnt::varchar(4) as plnt,
        prec_doc_itm::number(18,0) as prec_doc_itm,
        prec_doc_num::varchar(10) as prec_doc_num,
        proof_delv_dt::date as proof_delv_dt,
        rlse_dt_cr_mgmt::date as rlse_dt_cr_mgmt,
        route::varchar(6) as route,
        rqst_delv_dt::date as rqst_delv_dt,
        rsn_cd_key::varchar(29) as rsn_cd_key,
        rsn_rej::varchar(2) as rsn_rej,
        ship_to_prty::varchar(10) as ship_to_prty,
        ship_name::varchar(100) as ship_name,
        sls_doc::varchar(10) as sls_doc,
        sls_doc_cat::varchar(2) as sls_doc_cat,
        sls_doc_itm::number(18,0) as sls_doc_itm,
        sls_doc_itm_cat::varchar(4) as sls_doc_itm_cat,
        sls_doc_typ::varchar(4) as sls_doc_typ,
        sls_emp_hist::number(18,0) as sls_emp_hist,
        sls_unit::varchar(4) as sls_unit,
        sold_to_prty::varchar(10) as sold_to_prty,
        tran_ldtm::number(15,4) as tran_ldtm,
        unspp_qty::number(15,4) as unspp_qty,
        unspp_val::number(15,4) as unspp_val,
        updt_dttm::timestamp_ntz(9) as updt_dttm,
        vol_delv::number(15,4) as vol_delv,
        vol_ord::number(20,4) as vol_ord,
        to_ccy::varchar(5) as to_ccy,
        exch_rate::number(15,5) as exch_rate
    from source
)
select * from final