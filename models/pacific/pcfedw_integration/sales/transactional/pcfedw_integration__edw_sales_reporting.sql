with source as(
    select * from {{ ref('pcfedw_integration__vw_sales_reporting') }}
),
final as(
    select 
        current_timestamp() as snap_shot_dt,
        pac_source_type::varchar(6) as pac_source_type,
        pac_subsource_type::varchar(13) as pac_subsource_type,
        jj_period::number(18,0) as jj_period,
        jj_wk::number(38,0) as jj_wk,
        jj_mnth::number(18,0) as jj_mnth,
        jj_mnth_shrt::varchar(3) as jj_mnth_shrt,
        jj_mnth_long::varchar(10) as jj_mnth_long,
        jj_qrtr::number(18,0) as jj_qrtr,
        jj_year::number(18,0) as jj_year,
        jj_mnth_tot::number(18,0) as jj_mnth_tot,
        prcnt_elpsd::number(38,3) as prcnt_elpsd,
        elpsd_jj_period::number(18,0) as elpsd_jj_period,
        cust_no::varchar(10) as cust_no,
        cmp_id::varchar(20) as cmp_id,
        channel_cd::varchar(20) as channel_cd,
        channel_desc::varchar(20) as channel_desc,
        ctry_key::varchar(150) as ctry_key,
        country::varchar(20) as country,
        state_cd::varchar(150) as state_cd,
        post_cd::varchar(150) as post_cd,
        cust_suburb::varchar(150) as cust_suburb,
        cust_nm::varchar(100) as cust_nm,
        sales_office_cd::varchar(20) as sales_office_cd,
        sales_office_desc::varchar(30) as sales_office_desc,
        sales_grp_cd::varchar(20) as sales_grp_cd,
        sales_grp_desc::varchar(30) as sales_grp_desc,
        mercia_ref::varchar(150) as mercia_ref,
        pln_cnnl_cd::varchar(20) as pln_cnnl_cd,
        pln_chnl_desc::varchar(20) as pln_chnl_desc,
        cust_curr_cd::varchar(5) as cust_curr_cd,
        matl_id::varchar(40) as matl_id,
        matl_desc::varchar(100) as matl_desc,
        master_code::varchar(18) as master_code,
        parent_matl_id::varchar(18) as parent_matl_id,
        parent_matl_desc::varchar(100) as parent_matl_desc,
        mega_brnd_cd::varchar(10) as mega_brnd_cd,
        mega_brnd_desc::varchar(100) as mega_brnd_desc,
        brnd_cd::varchar(10) as brnd_cd,
        brnd_desc::varchar(100) as brnd_desc,
        base_prod_cd::varchar(10) as base_prod_cd,
        base_prod_desc::varchar(100) as base_prod_desc,
        variant_cd::varchar(10) as variant_cd,
        variant_desc::varchar(100) as variant_desc,
        fran_cd::varchar(18) as fran_cd,
        fran_desc::varchar(100) as fran_desc,
        grp_fran_cd::varchar(18) as grp_fran_cd,
        grp_fran_desc::varchar(100) as grp_fran_desc,
        matl_type_cd::varchar(10) as matl_type_cd,
        matl_type_desc::varchar(40) as matl_type_desc,
        prod_fran_cd::varchar(18) as prod_fran_cd,
        prod_fran_desc::varchar(100) as prod_fran_desc,
        prod_hier_cd::varchar(40) as prod_hier_cd,
        prod_hier_desc::varchar(100) as prod_hier_desc,
        prod_mjr_cd::varchar(18) as prod_mjr_cd,
        prod_mjr_desc::varchar(100) as prod_mjr_desc,
        prod_mnr_cd::varchar(18) as prod_mnr_cd,
        prod_mnr_desc::varchar(100) as prod_mnr_desc,
        mercia_plan::varchar(10) as mercia_plan,
        putup_cd::varchar(10) as putup_cd,
        putup_desc::varchar(100) as putup_desc,
        bar_cd::varchar(40) as bar_cd,
        prft_ctr::varchar(30) as prft_ctr,
        divest_flag::varchar(1) as divest_flag,
        key_measure::varchar(40) as key_measure,
        ciw_ctgry::varchar(40) as ciw_ctgry,
        ciw_accnt_grp::varchar(40) as ciw_accnt_grp,
        px_gl_trans_desc::varchar(40) as px_gl_trans_desc,
        px_measure::varchar(40) as px_measure,
        px_bucket::varchar(40) as px_bucket,
        sap_accnt::varchar(40) as sap_accnt,
        sap_accnt_desc::varchar(100) as sap_accnt_desc,
        local_curr_cd::varchar(10) as local_curr_cd,
        to_ccy::varchar(5) as to_ccy,
        exch_rate::number(15,5) as exch_rate,
        base_measure::number(38,7) as base_measure,
        sales_qty::number(38,5) as sales_qty,
        gts::number(38,7) as gts,
        gts_less_rtrn::number(38,7) as gts_less_rtrn,
        eff_val::number(38,7) as eff_val,
        jgf_si_val::number(38,7) as jgf_si_val,
        pmt_terms_val::number(38,7) as pmt_terms_val,
        datains_val::number(38,7) as datains_val,
        exp_adj_val::number(38,7) as exp_adj_val,
        jgf_sd_val::number(38,7) as jgf_sd_val,
        nts_val::number(38,7) as nts_val,
        tot_ciw_val::number(38,7) as tot_ciw_val,
        posted_cogs::number(38,7) as posted_cogs,
        posted_con_free_goods_val::number(38,7) as posted_con_free_goods_val,
        posted_gp::number(38,7) as posted_gp,
        cogs::number(38,7) as cogs,
        gp::number(38,7) as gp,
        futr_sls_qty::number(38,4) as futr_sls_qty,
        futr_gts::number(38,9) as futr_gts,
        futr_ts::number(17,5) as futr_ts,
        futr_nts::number(38,9) as futr_nts,
        px_qty::number(38,0) as px_qty,
        px_gts::number(38,7) as px_gts,
        px_gts_less_rtrn::number(38,7) as px_gts_less_rtrn,
        px_eff_val::number(38,7) as px_eff_val,
        px_jgf_si_val ::number(38,7) as px_jgf_si_val,
        px_pmt_terms_val::number(38,7) as px_pmt_terms_val,
        px_datains_val::number(38,7) as px_datains_val,
        px_exp_adj_val::number(38,7) as px_exp_adj_val,
        px_jgf_sd_val::number(38,7) as px_jgf_sd_val,
        px_nts::number(38,7) as px_nts,
        px_ciw_tot::number(38,7) as px_ciw_tot,
        px_cogs::number(38,7) as px_cogs,
        px_gp::number(38,7) as px_gp,
        projected_qty::number(38,5) as projected_qty,
        projected_gts_less_rtrn::number(38,7) as projected_gts_less_rtrn,
        projected_eff_val::number(38,7) as projected_eff_val,
        projected_jgf_si_val::number(38,7) as projected_jgf_si_val,
        projected_pmt_terms_val::number(38,7) as projected_pmt_terms_val,
        projected_datains_val ::number(38,7) as projected_datains_val,
        projected_exp_adj_val ::number(38,7) as projected_exp_adj_val,
        projected_jgf_sd_val::number(38,7) as projected_jgf_sd_val,
        projected_ciw_tot::number(38,7) as projected_ciw_tot,
        projected_nts::number(38,7) as projected_nts,
        projected_cogs_current::number(38,7) as projected_cogs_current,
        projected_gp_current::number(38,7) as projected_gp_current,
        projected_cogs_actual::number(38,7) as projected_cogs_actual,
        projected_gp_actual::number(38,7) as projected_gp_actual,
        goal_qty::number(18,0) as goal_qty,
        goal_gts ::number(38,7) as goal_gts,
        goal_eff_val::number(38,7) as goal_eff_val,
        goal_jgf_si_val::number(38,7) as goal_jgf_si_val,
        goal_pmt_terms_val::number(38,7) as goal_pmt_terms_val,
        goal_datains_val ::number(38,7) as goal_datains_val,
        goal_exp_adj_val ::number(38,7) as goal_exp_adj_val,
        goal_jgf_sd_val::number(38,7) as goal_jgf_sd_val,
        goal_ciw_tot::number(38,7) as goal_ciw_tot,
        goal_nts::number(38,7) as goal_nts,
        goal_cogs::number(38,7) as goal_cogs,
        goal_gp::number(38,7) as goal_gp,
        bp_qty::number(38,7) as bp_qty,
        bp_gts::number(38,7) as bp_gts,
        bp_eff_val::number(38,7) as bp_eff_val,
        bp_jgf_si_val::number(38,7) as bp_jgf_si_val,
        bp_pmt_terms_val::number(38,7) as bp_pmt_terms_val,
        bp_datains_val::number(38,7) as bp_datains_val,
        bp_exp_adj_val::number(38,7) as bp_exp_adj_val,
        bp_jgf_sd_val::number(38,7) as bp_jgf_sd_val,
        bp_ciw_tot::number(38,7) as bp_ciw_tot,
        bp_nts::number(38,7) as bp_nts,
        bp_cogs::number(38,7) as bp_cogs,
        bp_gp::number(38,7) as bp_gp,
        ju_qty::number(38,7) as ju_qty,
        ju_gts::number(38,7) as ju_gts,
        ju_eff_val::number(38,7) as ju_eff_val,
        ju_jgf_si_val::number(38,7) as ju_jgf_si_val,
        ju_pmt_terms_val::number(38,7) as ju_pmt_terms_val,
        ju_datains_val::number(38,7) as ju_datains_val,
        ju_exp_adj_val::number(38,7) as ju_exp_adj_val,
        ju_jgf_sd_val::number(38,7) as ju_jgf_sd_val,
        ju_ciw_tot::number(38,7) as ju_ciw_tot,
        ju_nts::number(38,7) as ju_nts,
        ju_cogs::number(38,7) as ju_cogs,
        ju_gp::number(38,7) as ju_gp,
        nu_qty::number(38,7) as nu_qty,
        nu_gts::number(38,7) as nu_gts,
        nu_eff_val::number(38,7) as nu_eff_val,
        nu_jgf_si_val::number(38,7) as nu_jgf_si_val,
        nu_pmt_terms_val::number(38,7) as nu_pmt_terms_val,
        nu_datains_val::number(38,7) as nu_datains_val,
        nu_exp_adj_val::number(38,7) as nu_exp_adj_val,
        nu_jgf_sd_val::number(38,7) as nu_jgf_sd_val,
        nu_ciw_tot::number(38,7) as nu_ciw_tot,
        nu_nts::number(38,7) as nu_nts,
        nu_cogs::number(38,7) as nu_cogs,
        nu_gp::number(38,7) as nu_gp,
        bme_trans::number(38,7) as bme_trans,
        incr_gts::number(38,7) as incr_gts,
        px_case_qty::number(38,0) as px_case_qty,
        px_tot_planspend::number(38,7) as px_tot_planspend,
        px_tot_paid::number(38,7) as px_tot_paid,
        px_committed_spend::number(38,7) as px_committed_spend,
        finance_cogs::number(38,7) as finance_cogs,
        gcph_franchise::varchar(100) as gcph_franchise,
        gcph_brand::varchar(100) as gcph_brand, 
        gcph_subbrand::varchar(100) as gcph_subbrand, 
        gcph_variant ::varchar(100) as gcph_variant ,
        gcph_needstate ::varchar(100) as gcph_needstate ,
        gcph_category ::varchar(100) as gcph_category ,
        gcph_subcategory::varchar(100) as gcph_subcategory,
        gcph_segment ::varchar(100) as gcph_segment ,
        gcph_subsegment::varchar(100) as gcph_subsegment    
    from source
    where pac_subsource_type <> 'SAPBW_FUTURES'
)
select * from final