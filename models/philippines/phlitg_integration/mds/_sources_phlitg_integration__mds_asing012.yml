version: 2

sources:
  - name: phlsdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: phlsdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
    - name: sdl_mds_ph_targets_by_national_and_skus
      tags: ["ph_mds_itg_refresh","ingestion"]
      tests:
          - test_null:
              select_columns: ["item_code","year"]
              not_null_columns: ["item_code","year"]
              name: TRATBL_sdl_mds_ph_targets_by_national_and_skus__null_test
              config:
                store_failures: true
                schema: phlwks_integration
          - test_duplicate:
              select_columns: ["item_code","year"]
              group_by_columns: ["item_code","year"]
              name: TRATBL_sdl_mds_ph_targets_by_national_and_skus__duplicate_test
              config:
                store_failures: true
                schema: phlwks_integration
    - name: sdl_mds_ph_gt_customer
      tags: ["ph_mds_itg_refresh","ingestion"]
      tests:
          - test_null:
              select_columns: ["code"]
              not_null_columns: ["code"]
              name: TRATBL_sdl_mds_ph_gt_customer__null_test
              config:
                store_failures: true
                schema: phlwks_integration
          - test_duplicate:
              select_columns: ["code"]
              group_by_columns: ["code"]
              name: TRATBL_sdl_mds_ph_gt_customer__duplicate_test
              config:
                store_failures: true
                schema: phlwks_integration
    - name: sdl_mds_ph_ref_pos_primary_sold_to
      tags: ["ph_mds_itg_refresh","ingestion"]
      tests:
          - test_null:
              select_columns: ["name"]
              not_null_columns: ["name"]
              name: TRATBL_sdl_mds_ph_ref_pos_primary_sold_to__null_test
              config:
                store_failures: true
                schema: phlwks_integration
          - test_duplicate:
              select_columns: ["name"]
              group_by_columns: ["name"]
              name: TRATBL_sdl_mds_ph_ref_pos_primary_sold_to__duplicate_test
              config:
                store_failures: true
                schema: phlwks_integration
    - name: sdl_mds_ph_pos_product
      tags: ["ph_mds_itg_refresh","ingestion"]
      tests:
          - test_null:
              select_columns: ["item_cd","prefix","effective_sales_cycle"]
              not_null_columns: ["item_cd","prefix","effective_sales_cycle"]
              name: TRATBL_sdl_mds_ph_pos_product__null_test
              config:
                store_failures: true
                schema: phlwks_integration
          - test_duplicate:
              select_columns: ["item_cd","prefix","effective_sales_cycle"]
              group_by_columns: ["item_cd","prefix","effective_sales_cycle"]
              name: TRATBL_sdl_mds_ph_pos_product__duplicate_test
              config:
                store_failures: true
                schema: phlwks_integration
    - name: sdl_mds_ph_ref_parent_customer
      tags: ["ph_mds_itg_refresh","ingestion"]
      tests:
          - test_null:
              select_columns: ["code"]
              not_null_columns: ["code"]
              name: TRATBL_sdl_mds_ph_ref_parent_customer__null_test
              config:
                store_failures: true
                schema: phlwks_integration
          - test_duplicate:
              select_columns: ["code"]
              group_by_columns: ["code"]
              name: TRATBL_sdl_mds_ph_ref_parent_customer__duplicate_test
              config:
                store_failures: true
                schema: phlwks_integration