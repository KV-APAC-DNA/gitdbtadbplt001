with source as (
select * from {{ ref('phledw_integration__edw_vw_ph_siso_analysis') }}   
),
final as (
    select
        jj_year::number(18,0) as jj_year,
        jj_qrtr::varchar(14) as jj_qrtr,
        jj_mnth_id::varchar(23) as jj_mnth_id,
        jj_mnth_no::number(18,0) as jj_mnth_no,
        jj_mnth_wk_no::number(38,0) as jj_mnth_wk_no,
        warehse_cd::varchar(50) as warehse_cd,
        cntry_nm::varchar(40) as cntry_nm,
        dstrbtr_grp_cd::varchar(50) as dstrbtr_grp_cd,
        region::varchar(150) as region,
        si_chnl_cd::varchar(50) as si_chnl_cd,
        si_chnl_desc::varchar(255) as si_chnl_desc,
        si_sub_chnl_cd::varchar(50) as si_sub_chnl_cd,
        si_sub_chnl_desc::varchar(255) as si_sub_chnl_desc,
        parent_customer_cd::varchar(50) as parent_customer_cd,
        parent_customer::varchar(255) as parent_customer,
        account_grp::varchar(255) as account_grp,
        trade_type::varchar(13) as trade_type,
        sls_grp_desc::varchar(255) as sls_grp_desc,
        sap_state_cd::varchar(150) as sap_state_cd,
        sap_sls_org::varchar(4) as sap_sls_org,
        sap_cmp_id::varchar(6) as sap_cmp_id,
        sap_cntry_cd::varchar(3) as sap_cntry_cd,
        sap_cntry_nm::varchar(40) as sap_cntry_nm,
        sap_addr::varchar(150) as sap_addr,
        sap_region::varchar(150) as sap_region,
        sap_city::varchar(150) as sap_city,
        sap_post_cd::varchar(150) as sap_post_cd,
        sap_chnl_cd::varchar(2) as sap_chnl_cd,
        sap_chnl_desc::varchar(20) as sap_chnl_desc,
        sap_sls_office_cd::varchar(4) as sap_sls_office_cd,
        sap_sls_office_desc::varchar(40) as sap_sls_office_desc,
        sap_sls_grp_cd::varchar(3) as sap_sls_grp_cd,
        sap_sls_grp_desc::varchar(40) as sap_sls_grp_desc,
        sap_curr_cd::varchar(5) as sap_curr_cd,
        gch_region::varchar(50) as gch_region,
        gch_cluster::varchar(50) as gch_cluster,
        gch_subcluster::varchar(50) as gch_subcluster,
        gch_market::varchar(50) as gch_market,
        gch_retail_banner::varchar(50) as gch_retail_banner,
        sku::varchar(255) as sku,
        sku_desc::varchar(100) as sku_desc,
        sap_mat_type_cd::varchar(10) as sap_mat_type_cd,
        sap_mat_type_desc::varchar(40) as sap_mat_type_desc,
        sap_base_uom_cd::varchar(10) as sap_base_uom_cd,
        sap_prchse_uom_cd::varchar(10) as sap_prchse_uom_cd,
        sap_prod_sgmt_cd::varchar(18) as sap_prod_sgmt_cd,
        sap_prod_sgmt_desc::varchar(100) as sap_prod_sgmt_desc,
        sap_base_prod_cd::varchar(10) as sap_base_prod_cd,
        sap_base_prod_desc::varchar(100) as sap_base_prod_desc,
        sap_mega_brnd_cd::varchar(10) as sap_mega_brnd_cd,
        sap_mega_brnd_desc::varchar(100) as sap_mega_brnd_desc,
        sap_brnd_cd::varchar(10) as sap_brnd_cd,
        sap_brnd_desc::varchar(100) as sap_brnd_desc,
        sap_vrnt_cd::varchar(10) as sap_vrnt_cd,
        sap_vrnt_desc::varchar(100) as sap_vrnt_desc,
        sap_put_up_cd::varchar(10) as sap_put_up_cd,
        sap_put_up_desc::varchar(100) as sap_put_up_desc,
        sap_grp_frnchse_cd::varchar(18) as sap_grp_frnchse_cd,
        sap_grp_frnchse_desc::varchar(100) as sap_grp_frnchse_desc,
        sap_frnchse_cd::varchar(18) as sap_frnchse_cd,
        sap_frnchse_desc::varchar(100) as sap_frnchse_desc,
        sap_prod_frnchse_cd::varchar(18) as sap_prod_frnchse_cd,
        sap_prod_frnchse_desc::varchar(100) as sap_prod_frnchse_desc,
        sap_prod_mjr_cd::varchar(18) as sap_prod_mjr_cd,
        sap_prod_mjr_desc::varchar(100) as sap_prod_mjr_desc,
        sap_prod_mnr_cd::varchar(18) as sap_prod_mnr_cd,
        sap_prod_mnr_desc::varchar(100) as sap_prod_mnr_desc,
        sap_prod_hier_cd::varchar(18) as sap_prod_hier_cd,
        sap_prod_hier_desc::varchar(100) as sap_prod_hier_desc,
        global_mat_region::varchar(50) as global_mat_region,
        global_prod_franchise::varchar(30) as global_prod_franchise,
        global_prod_brand::varchar(30) as global_prod_brand,
        global_prod_variant::varchar(100) as global_prod_variant,
        global_prod_put_up_cd::varchar(10) as global_prod_put_up_cd,
        global_put_up_desc::varchar(100) as global_put_up_desc,
        global_prod_sub_brand::varchar(100) as global_prod_sub_brand,
        global_prod_need_state::varchar(50) as global_prod_need_state,
        global_prod_category::varchar(50) as global_prod_category,
        global_prod_subcategory::varchar(50) as global_prod_subcategory,
        global_prod_segment::varchar(50) as global_prod_segment,
        global_prod_subsegment::varchar(100) as global_prod_subsegment,
        global_prod_size::varchar(20) as global_prod_size,
        global_prod_size_uom::varchar(20) as global_prod_size_uom,
        so_bill_doc::varchar(255) as so_bill_doc,
        so_sls_qty::number(22,6) as so_sls_qty,
        so_ret_qty::number(24,6) as so_ret_qty,
        so_sls_qty_pc::number(22,6) as so_sls_qty_pc,
        so_ret_qty_pc::number(24,6) as so_ret_qty_pc,
        so_grs_trd_sls::number(38,12) as so_grs_trd_sls,
        so_ret_val::number(38,12) as so_ret_val,
        so_trd_discnt::number(23,6) as so_trd_discnt,
        so_trd_sls::number(20,4) as so_trd_sls,
        so_net_trd_sls::number(22,6) as so_net_trd_sls,
        so_jj_grs_trd_sls::number(38,12) as so_jj_grs_trd_sls,
        so_jj_ret_val::number(38,12) as so_jj_ret_val,
        so_jj_trd_sls::number(38,8) as so_jj_trd_sls,
        so_jj_net_trd_sls::number(38,8) as so_jj_net_trd_sls,
        is_npi::varchar(10) as is_npi,
        npi_str_period::varchar(52) as npi_str_period,
        npi_end_period::varchar(52) as npi_end_period,
        is_reg::varchar(1) as is_reg,
        is_promo::varchar(40) as is_promo,
        promo_strt_period::varchar(10) as promo_strt_period,
        promo_end_period::varchar(10) as promo_end_period,
        is_mcl::varchar(1) as is_mcl,
        is_hero::varchar(75) as is_hero,
        local_mat_listpriceunit::number(38,4) as local_mat_listpriceunit,
        si_sls_qty::number(38,5) as si_sls_qty,
        si_ret_qty::number(38,5) as si_ret_qty,
        si_sls_less_rtn_qty::number(38,5) as si_sls_less_rtn_qty,
        si_gts_val::number(38,5) as si_gts_val,
        si_ret_val::number(38,5) as si_ret_val,
        si_gts_less_rtn_val::number(38,5) as si_gts_less_rtn_val,
        si_nts_qty::number(38,5) as si_nts_qty,
        si_nts_val::number(38,5) as si_nts_val,
        si_tp_val::number(38,5) as si_tp_val,
        end_stock_qty::number(20,4) as end_stock_qty,
        end_stock_val::number(20,4) as end_stock_val,
        pka_productkey::varchar(68) as pka_productkey
    from source
)
select * from final