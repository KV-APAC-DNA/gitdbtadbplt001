with source as
(
    select * from {{ ref('phledw_integration__edw_vw_ph_sellin_analysis') }}
),
final as
(
    select 
    jj_year::number(18,0) as jj_year,
	jj_qtr::varchar(14) as jj_qtr,
	jj_mnth_id::varchar(23) as jj_mnth_id,
	jj_mnth_no::number(18,0) as jj_mnth_no,
	jj_wk::varchar(1) as jj_wk,
	jj_mnth_wk_no::number(38,0) as jj_mnth_wk_no,
	sellin_bill_type::varchar(4) as sellin_bill_type,
	sls_grp_cd::varchar(1) as sls_grp_cd,
	sls_grp_desc::varchar(255) as sls_grp_desc,
	cntry_nm::varchar(40) as cntry_nm,
	region::varchar(150) as region,
	sap_state_cd::varchar(150) as sap_state_cd,
	sold_to::varchar(10) as sold_to,
	sold_to_nm::varchar(100) as sold_to_nm,
	sap_sls_org::varchar(4) as sap_sls_org,
	sap_cmp_id::varchar(6) as sap_cmp_id,
	sap_cntry_cd::varchar(3) as sap_cntry_cd,
	sap_cntry_nm::varchar(40) as sap_cntry_nm,
	sap_addr::varchar(150) as sap_addr,
	sap_region::varchar(150) as sap_region,
	sap_city::varchar(150) as sap_city,
	sap_post_cd::varchar(150) as sap_post_cd,
	sap_chnl_cd::varchar(2) as sap_chnl_cd,
	sap_chnl_desc::varchar(20) as sap_chnl_desc,
	sap_sls_office_cd::varchar(4) as sap_sls_office_cd,
	sap_sls_office_desc::varchar(40) as sap_sls_office_desc,
	sap_sls_grp_cd::varchar(3) as sap_sls_grp_cd,
	sap_sls_grp_desc::varchar(40) as sap_sls_grp_desc,
	sap_curr_cd::varchar(5) as sap_curr_cd,
	gch_region::varchar(50) as gch_region,
	gch_cluster::varchar(50) as gch_cluster,
	gch_subcluster::varchar(50) as gch_subcluster,
	gch_market::varchar(50) as gch_market,
	gch_retail_banner::varchar(50) as gch_retail_banner,
	chnl_cd::varchar(50) as chnl_cd,
	chnl_desc::varchar(255) as chnl_desc,
	sub_chnl_cd::varchar(50) as sub_chnl_cd,
	sub_chnl_desc::varchar(255) as sub_chnl_desc,
	sku::varchar(40) as sku,
	sku_desc::varchar(100) as sku_desc,
	global_mat_region::varchar(50) as global_mat_region,
	global_prod_franchise::varchar(30) as global_prod_franchise,
	global_prod_brand::varchar(30) as global_prod_brand,
	global_prod_variant::varchar(100) as global_prod_variant,
	global_prod_put_up_cd::varchar(10) as global_prod_put_up_cd,
	global_put_up_desc::varchar(100) as global_put_up_desc,
	sap_prod_mnr_cd::varchar(18) as sap_prod_mnr_cd,
	sap_prod_mnr_desc::varchar(100) as sap_prod_mnr_desc,
	sap_prod_hier_cd::varchar(18) as sap_prod_hier_cd,
	sap_prod_hier_desc::varchar(100) as sap_prod_hier_desc,
	global_prod_sub_brand::varchar(100) as global_prod_sub_brand,
	global_prod_need_state::varchar(50) as global_prod_need_state,
	global_prod_category::varchar(50) as global_prod_category,
	global_prod_subcategory::varchar(50) as global_prod_subcategory,
	global_prod_segment::varchar(75) as global_prod_segment,
	global_prod_subsegment::varchar(100) as global_prod_subsegment,
	global_prod_size::varchar(20) as global_prod_size,
	global_prod_size_uom::varchar(20) as global_prod_size_uom,
	parent_customer_cd::varchar(50) as parent_customer_cd,
	parent_customer::varchar(255) as parent_customer,
	account_grp::varchar(255) as account_grp,
	trade_type::varchar(255) as trade_type,
	is_reg::varchar(1) as is_reg,
	is_promo::varchar(1) as is_promo,
	local_mat_promo_strt_period::varchar(50) as local_mat_promo_strt_period,
	is_npi::varchar(1) as is_npi,
	is_hero::varchar(4) as is_hero,
	is_mcl::varchar(1) as is_mcl,
	local_mat_npi_strt_period::varchar(50) as local_mat_npi_strt_period,
	local_mat_listpriceunit::number(15,4) as local_mat_listpriceunit,
	sls_qty::number(38,5) as sls_qty,
	ret_qty::number(38,5) as ret_qty,
	sls_less_rtn_qty::number(38,5) as sls_less_rtn_qty,
	gts_val::number(38,5) as gts_val,
	ret_val::number(38,5) as ret_val,
	gts_less_rtn_val::number(38,5) as gts_less_rtn_val,
	nts_qty::number(38,5) as nts_qty,
	nts_val::number(38,5) as nts_val,
	tp_val::number(38,5) as tp_val,
	target_type::varchar(3) as target_type,
	iop_trgt_val::number(15,4) as iop_trgt_val,
	bp_trgt_val::number(15,4) as bp_trgt_val,
	le_trgt_val::number(15,4) as le_trgt_val,
	last_updt_dt::timestamp_ntz(9) as last_updt_dt,
	iop_gts_trgt_val::number(15,4) as iop_gts_trgt_val,
	pka_productkey::varchar(68) as pka_productkey
    from source
)
select * from final