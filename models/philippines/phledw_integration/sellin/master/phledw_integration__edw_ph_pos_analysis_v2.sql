with source as
(
    select * from {{ ref('phledw_integration__edw_vw_ph_pos_analysis_v2') }}
),
final as
(
    select 
    jj_year::number(18,0) as jj_year,
	jj_qtr::varchar(14) as jj_qtr,
	jj_mnth_id::varchar(10) as jj_mnth_id,
	jj_mnth_no::number(18,0) as jj_mnth_no,
	cntry_nm::varchar(11) as cntry_nm,
	cust_cd::varchar(10) as cust_cd,
	cust_brnch_cd::varchar(20) as cust_brnch_cd,
	mt_cust_brnch_nm::varchar(300) as mt_cust_brnch_nm,
	region_cd::varchar(255) as region_cd,
	region_nm::varchar(255) as region_nm,
	prov_cd::varchar(255) as prov_cd,
	prov_nm::varchar(255) as prov_nm,
	mncplty_cd::varchar(255) as mncplty_cd,
	mncplty_nm::varchar(255) as mncplty_nm,
	city_cd::varchar(255) as city_cd,
	city_nm::varchar(255) as city_nm,
	ae_nm::varchar(255) as ae_nm,
	ash_no::varchar(255) as ash_no,
	ash_nm::varchar(255) as ash_nm,
	pms_nm::varchar(255) as pms_nm,
	item_cd::varchar(30) as item_cd,
	mt_item_nm::varchar(500) as mt_item_nm,
	sold_to::varchar(30) as sold_to,
	sold_to_nm::varchar(100) as sold_to_nm,
	region::varchar(150) as region,
	chnl_cd::varchar(50) as chnl_cd,
	chnl_desc::varchar(255) as chnl_desc,
	sub_chnl_cd::varchar(50) as sub_chnl_cd,
	sub_chnl_desc::varchar(255) as sub_chnl_desc,
	parent_customer_cd::varchar(50) as parent_customer_cd,
	parent_customer::varchar(255) as parent_customer,
	account_grp::varchar(255) as account_grp,
	trade_type::varchar(12) as trade_type,
	sls_grp_desc::varchar(255) as sls_grp_desc,
	sap_state_cd::varchar(150) as sap_state_cd,
	sap_sls_org::varchar(4) as sap_sls_org,
	sap_cmp_id::varchar(6) as sap_cmp_id,
	sap_cntry_cd::varchar(3) as sap_cntry_cd,
	sap_cntry_nm::varchar(40) as sap_cntry_nm,
	sap_addr::varchar(150) as sap_addr,
	sap_region::varchar(150) as sap_region,
	sap_city::varchar(150) as sap_city,
	sap_post_cd::varchar(150) as sap_post_cd,
	sap_chnl_cd::varchar(2) as sap_chnl_cd,
	sap_chnl_desc::varchar(20) as sap_chnl_desc,
	sap_sls_office_cd::varchar(4) as sap_sls_office_cd,
	sap_sls_office_desc::varchar(40) as sap_sls_office_desc,
	sap_sls_grp_cd::varchar(3) as sap_sls_grp_cd,
	sap_sls_grp_desc::varchar(40) as sap_sls_grp_desc,
	sap_curr_cd::varchar(5) as sap_curr_cd,
	gch_region::varchar(50) as gch_region,
	gch_cluster::varchar(50) as gch_cluster,
	gch_subcluster::varchar(50) as gch_subcluster,
	gch_market::varchar(50) as gch_market,
	gch_retail_banner::varchar(50) as gch_retail_banner,
	sku::varchar(40) as sku,
	sku_desc::varchar(100) as sku_desc,
	sap_mat_type_cd::varchar(10) as sap_mat_type_cd,
	sap_mat_type_desc::varchar(40) as sap_mat_type_desc,
	sap_base_uom_cd::varchar(10) as sap_base_uom_cd,
	sap_prchse_uom_cd::varchar(10) as sap_prchse_uom_cd,
	sap_prod_sgmt_cd::varchar(18) as sap_prod_sgmt_cd,
	sap_prod_sgmt_desc::varchar(100) as sap_prod_sgmt_desc,
	sap_base_prod_cd::varchar(10) as sap_base_prod_cd,
	sap_base_prod_desc::varchar(100) as sap_base_prod_desc,
	sap_mega_brnd_cd::varchar(10) as sap_mega_brnd_cd,
	sap_mega_brnd_desc::varchar(100) as sap_mega_brnd_desc,
	sap_brnd_cd::varchar(10) as sap_brnd_cd,
	sap_brnd_desc::varchar(100) as sap_brnd_desc,
	sap_vrnt_cd::varchar(10) as sap_vrnt_cd,
	sap_vrnt_desc::varchar(100) as sap_vrnt_desc,
	sap_put_up_cd::varchar(10) as sap_put_up_cd,
	sap_put_up_desc::varchar(100) as sap_put_up_desc,
	sap_grp_frnchse_cd::varchar(18) as sap_grp_frnchse_cd,
	sap_grp_frnchse_desc::varchar(100) as sap_grp_frnchse_desc,
	sap_frnchse_cd::varchar(18) as sap_frnchse_cd,
	sap_frnchse_desc::varchar(100) as sap_frnchse_desc,
	sap_prod_frnchse_cd::varchar(18) as sap_prod_frnchse_cd,
	sap_prod_frnchse_desc::varchar(100) as sap_prod_frnchse_desc,
	sap_prod_mjr_cd::varchar(18) as sap_prod_mjr_cd,
	sap_prod_mjr_desc::varchar(100) as sap_prod_mjr_desc,
	sap_prod_mnr_cd::varchar(18) as sap_prod_mnr_cd,
	sap_prod_mnr_desc::varchar(100) as sap_prod_mnr_desc,
	sap_prod_hier_cd::varchar(18) as sap_prod_hier_cd,
	sap_prod_hier_desc::varchar(100) as sap_prod_hier_desc,
	global_mat_region::varchar(50) as global_mat_region,
	global_prod_franchise::varchar(30) as global_prod_franchise,
	global_prod_brand::varchar(30) as global_prod_brand,
	global_prod_variant::varchar(100) as global_prod_variant,
	global_prod_put_up_cd::varchar(10) as global_prod_put_up_cd,
	global_put_up_desc::varchar(100) as global_put_up_desc,
	global_prod_sub_brand::varchar(100) as global_prod_sub_brand,
	global_prod_need_state::varchar(50) as global_prod_need_state,
	global_prod_category::varchar(50) as global_prod_category,
	global_prod_subcategory::varchar(50) as global_prod_subcategory,
	global_prod_segment::varchar(50) as global_prod_segment,
	global_prod_subsegment::varchar(100) as global_prod_subsegment,
	global_prod_size::varchar(20) as global_prod_size,
	global_prod_size_uom::varchar(20) as global_prod_size_uom,
	is_reg::varchar(1) as is_reg,
	is_promo::varchar(1) as is_promo,
	local_mat_promo_strt_period::varchar(50) as local_mat_promo_strt_period,
	is_npi::varchar(1) as is_npi,
	is_hero::varchar(4) as is_hero,
	is_mcl::varchar(1) as is_mcl,
	local_mat_npi_strt_period::varchar(50) as local_mat_npi_strt_period,
	pos_qty::number(20,4) as pos_qty,
	pos_gts::number(20,4) as pos_gts,
	pos_item_prc::number(20,4) as pos_item_prc,
	pos_tax::number(20,4) as pos_tax,
	pos_nts::number(20,4) as pos_nts,
	conv_factor::number(20,4) as conv_factor,
	jj_qty_pc::number(20,4) as jj_qty_pc,
	jj_item_prc_per_pc::number(20,4) as jj_item_prc_per_pc,
	jj_gts::number(20,4) as jj_gts,
	jj_vat_amt::number(20,4) as jj_vat_amt,
	jj_nts::number(20,4) as jj_nts
    from source
)
select * from final