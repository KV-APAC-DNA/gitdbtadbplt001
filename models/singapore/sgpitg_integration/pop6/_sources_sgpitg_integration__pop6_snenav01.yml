sources:
  - name: sgpsdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: snaposesdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: sdl_pop6_sg_product_attribute_audits
        tags: ["pop6_sg_transaction","ingestion"]
        tests:
          - test_null:
              not_null_columns: ["visit_id","audit_form_id","section_id","field_id","dependent_on_field_id","product_attribute_id","product_attribute_value_id"]
              select_columns: ["visit_id","audit_form_id","section_id","field_id","dependent_on_field_id","product_attribute_id","product_attribute_value_id"]
              name: TRATBL_sdl_pop6_sg_product_attribute_audits__null_test
              config:
                store_failures: true
                schema: sgpwks_integration
          - test_duplicate:
              group_by_columns: ["visit_id","audit_form_id","section_id","field_id","dependent_on_field_id","product_attribute_id","product_attribute_value_id"]
              select_columns: ["visit_id","audit_form_id","section_id","field_id","dependent_on_field_id","product_attribute_id","product_attribute_value_id"]
              name: TRATBL_sdl_pop6_sg_product_attribute_audits__duplicate_test
              config:
                store_failures: true
                schema: sgpwks_integration
      - name: sdl_pop6_sg_sku_audits
        tags: ["pop6_sg_transaction","ingestion"]
        tests:
          - test_null:
              not_null_columns: ["visit_id","section_id","field_id","dependent_on_field_id","sku_id"]
              select_columns: ["visit_id","section_id","field_id","dependent_on_field_id","sku_id"]
              name: TRATBL_sdl_pop6_sg_sku_audits__null_test
              config:
                store_failures: true
                schema: sgpwks_integration
          - test_duplicate:
              group_by_columns: ["visit_id","section_id","field_id","dependent_on_field_id","sku_id"]
              select_columns: ["visit_id","section_id","field_id","dependent_on_field_id","sku_id"]
              name: TRATBL_sdl_pop6_sg_sku_audits__duplicate_test
              config:
                store_failures: true
                schema: sgpwks_integration
      - name: sdl_pop6_sg_tasks
        tags: ["pop6_sg_transaction","ingestion"]
        tests:
          - test_null:
              not_null_columns: ["visit_id","field_id","field_type"]
              select_columns: ["visit_id","field_id","field_type"]
              name: TRATBL_sdl_pop6_sg_tasks__null_test
              config:
                store_failures: true
                schema: sgpwks_integration
          - test_duplicate:
              group_by_columns: ["visit_id","field_id","field_type"]
              select_columns: ["visit_id","field_id","field_type"]
              name: TRATBL_sdl_pop6_sg_tasks__duplicate_test
              config:
                store_failures: true
                schema: sgpwks_integration
      - name: sdl_pop6_sg_general_audits
        tags: ["pop6_sg_transaction","ingestion"]
        tests:
          - test_null:
              not_null_columns: ["visit_id","audit_form_id","section_id","subsection_id","field_id"]
              select_columns: ["visit_id","audit_form_id","section_id","subsection_id","field_id"]
              name: TRATBL_sdl_pop6_sg_general_audits__null_test
              config:
                store_failures: true
                schema: sgpwks_integration
          - test_duplicate:
              group_by_columns: ["visit_id","audit_form_id","section_id","subsection_id","field_id"]
              select_columns: ["visit_id","audit_form_id","section_id","subsection_id","field_id"]
              name: TRATBL_sdl_pop6_sg_general_audits__duplicate_test
              config:
                store_failures: true
                schema: sgpwks_integration