version: 2

models:
  - name: sgpitg_integration__itg_sg_tp_closed_month
    config:
      alias: itg_sg_tp_closed_month
      tags: ["daily", "sg_transaction_sellout"]
    tests:
      - test_null:
            not_null_columns: ["customer"]
            select_columns: ["file_name","customer"]
            name: TRATBL_itg_sg_tp_closed_month_null_test
            config:
              store_failures: true
              schema: sgpwks_integration
      - test_lookup:
            select_columns: ["file_name","customer"]
            column: "upper(customer)" 
            lookup_column: "upper(zuellig_customer)"
            lookup_table: "{{ ref('sgpitg_integration__itg_sg_zuellig_customer_mapping') }} "
            filter: "upper(customer_l1) = 'ZUELLIG'"
            name: TRATBL_itg_sg_tp_closed_month_lookup_test
            config:
              store_failures: true
              schema: sgpwks_integration
  - name: sgpitg_integration__sdl_raw_sg_tp_closed_month
    config:
      alias: sdl_raw_sg_tp_closed_month
      tags: ["daily", "sg_transaction_sellout"]
  - name: sgpitg_integration__itg_sg_tp_closed_year_bal
    config:
      alias: itg_sg_tp_closed_year_bal
      tags: ["daily", "sg_transaction_sellout"]
    tests:
      - test_null:
            not_null_columns: ["customer"]
            select_columns: ["file_name","customer"]
            name: TRATBL_itg_sg_tp_closed_year_bal_null_test
            config:
              store_failures: true
              schema: sgpwks_integration
      - test_lookup:
            select_columns: ["file_name","customer"]
            column: "upper(customer)" 
            lookup_column: "upper(zuellig_customer)"
            lookup_table: "{{ ref('sgpitg_integration__itg_sg_zuellig_customer_mapping') }} "
            filter: "upper(customer_l1) = 'ZUELLIG'"
            name: TRATBL_itg_sg_tp_closed_year_bal_lookup_test
            config:
              store_failures: true
              schema: sgpwks_integration
  - name: sgpitg_integration__sdl_raw_sg_tp_closed_year_bal
    config:
      alias: sdl_raw_sg_tp_closed_year_bal
      tags: ["daily", "sg_transaction_sellout"]
    
  
