version: 2

sources:
  - name: idnsdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: idnsdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
    - name: sdl_csa_raw_sellout_sales_fact
      tags: ["","ingestion"]
      # tests:
      #   - test_null:
      #       select_columns: ["filename", "pos_cust", "account", "kode_branch", "branch_name", "tgl", "plu", "descp", "type", "value", "yearmonth"] 
      #       not_null_columns: ["account","descp","plu", "branch_name"]  
      #       name: TRATBL_sdl_id_pos_daily_idm_sellout__null_test
      #       config:
      #         store_failures: true
      #         schema: idnwks_integration
      #   - test_duplicate:
      #       select_columns: ["filename", "pos_cust", "account", "kode_branch", "branch_name", "tgl", "plu", "descp", "type", "value", "yearmonth"] 
      #       group_by_columns: ["filename", "pos_cust", "account", "kode_branch", "branch_name", "tgl", "plu", "descp", "type", "value", "yearmonth"] 
      #       name: TRATBL_sdl_id_pos_daily_idm_sellout__duplicate_test
      #       config:
      #         store_failures: true
      #         schema: idnwks_integration
    - name: sdl_dnr_raw_sellout_sales_fact
    - name: sdl_dnr_customer_dim
    - name: sdl_sdn_raw_sellout_sales_fact
    - name: sdl_spr_raw_sellout_sales_fact
    - name: sdl_pp_raw_sellout_sales_fact