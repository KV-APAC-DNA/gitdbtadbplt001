version: 2

sources:
  - name: idnsdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: idnsdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
    - name: sdl_id_pos_guardian_stock
      tags: ["id_pos_guardian","ingestion"]
      tests:
        - test_null:
            select_columns: ["filename", "pos_cust", "article", "article_desc", "category", "soh_stores", "soh_dc", "yearmonth"] 
            not_null_columns: ["category","article_desc","article"]  
            name: TRATBL_sdl_id_pos_guardian_stock__null_test
            config:
              store_failures: true
              schema: idnwks_integration
        - test_format:
            select_columns: ["filename", "pos_cust", "article", "article_desc", "category", "soh_stores", "soh_dc", "yearmonth"]
            where_clause: "(TRIM(yearmonth) != '' and TRIM(yearmonth) IS NOT NULL) and regexp_like(TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]')"
            name: TRATBL_sdl_id_pos_guardian_stock__date_check
            config:
              store_failures: true
              schema: idnwks_integration 
        # - test_duplicate:
        #     select_columns: ["filename", "pos_cust", "article", "article_desc", "category", "soh_stores", "soh_dc", "yearmonth"] 
        #     group_by_columns: ["filename", "pos_cust", "article", "article_desc", "category", "soh_stores", "soh_dc", "yearmonth"] 
        #     name: TRATBL_sdl_id_pos_guardian_stock__duplicate_test
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration
    - name: sdl_id_pos_idm_sellout
      tags: ["id_pos_idm","ingestion"]
      tests:
        - test_null:
            select_columns: ["filename", "pos_cust", "item", "description", "plu", "branch", "type", "\"values\"", "yearmonth"] 
            not_null_columns: ["item", "description", "plu", "branch"]  
            name: TRATBL_sdl_id_pos_idm_sellout__null_test
            config:
              store_failures: true
              schema: idnwks_integration
        # - test_format:
        #     select_columns: ["filename", "pos_cust", "item", "description", "plu", "branch", "type", "values", "yearmonth"]
        #     where_clause: "(TRIM(yearmonth) != '' and TRIM(yearmonth) IS NOT NULL) and regexp_like(TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]')"
        #     name: TRATBL_sdl_id_pos_idm_sellout__date_check
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration 
        # - test_duplicate:
        #     select_columns: ["filename", "pos_cust", "item", "description", "plu", "branch", "type", "values", "yearmonth"] 
        #     group_by_columns: ["filename", "pos_cust", "item", "description", "plu", "branch", "type", "values", "yearmonth"] 
        #     name: TRATBL_sdl_id_pos_idm_sellout__duplicate_test
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration

    - name: sdl_id_pos_idm_stock
      tags: ["id_pos_idm","ingestion"]
      tests:
        - test_null:
            select_columns: ["filename", "pos_cust", "item", "branch", "dc_qty", "store_qty", "units", "yearmonth"] 
            not_null_columns: ["item", "branch", "dc_qty", "store_qty", "units"]  
            name: TRATBL_sdl_id_pos_idm_stock__null_test
            config:
              store_failures: true
              schema: idnwks_integration
        # - test_format:
        #     select_columns: ["filename", "pos_cust", "item", "branch", "dc_qty", "store_qty", "units", "yearmonth"]
        #     where_clause: "(TRIM(yearmonth) != '' and TRIM(yearmonth) IS NOT NULL) and regexp_like(TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]')"
        #     name: TRATBL_sdl_id_pos_idm_stock__date_check
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration 
        # - test_duplicate:
        #     select_columns: ["filename", "pos_cust", "item", "branch", "dc_qty", "store_qty", "units", "yearmonth"] 
        #     group_by_columns: ["filename", "pos_cust", "item", "branch", "dc_qty", "store_qty", "units", "yearmonth"] 
        #     name: TRATBL_sdl_id_pos_idm_stock__duplicate_test
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration
    - name: sdl_id_pos_igr_stock
      tags: ["id_pos_idm","ingestion"]
      tests:
        - test_null:
            select_columns: ["filename", "pos_cust", "item", "branch", "qty", "unit", "yearmonth"] 
            not_null_columns: ["item", "branch", "qty", "unit"]  
            name: TRATBL_sdl_id_pos_igr_stock__null_test
            config:
              store_failures: true
              schema: idnwks_integration
        # - test_format:
        #     select_columns: ["filename", "pos_cust", "item", "branch", "qty", "unit", "yearmonth"]
        #     where_clause: "(TRIM(yearmonth) != '' and TRIM(yearmonth) IS NOT NULL) and regexp_like(TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]')"
        #     name: TRATBL_sdl_id_pos_igr_stock__date_check
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration 
        # - test_duplicate:
        #     select_columns: ["filename", "pos_cust", "item", "branch", "qty", "unit", "yearmonth"] 
        #     group_by_columns: ["filename", "pos_cust", "item", "branch", "qty", "unit", "yearmonth"] 
        #     name: TRATBL_sdl_id_pos_igr_stock__duplicate_test
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration
    - name: sdl_id_pos_igr_sellout
      tags: ["id_pos_idm","ingestion"]
      tests:
        - test_null:
            select_columns: ["filename", "pos_cust", "description", "branch", "type", "\"values\"", "yearmonth"] 
            not_null_columns: ["description", "branch", "type", "\"values\""]  
            name: TRATBL_sdl_id_pos_igr_sellout__null_test
            config:
              store_failures: true
              schema: idnwks_integration
        # - test_format:
        #     select_columns: ["filename", "pos_cust", "description", "branch", "type", "values", "yearmonth"]
        #     where_clause: "(TRIM(yearmonth) != '' and TRIM(yearmonth) IS NOT NULL) and regexp_like(TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]')"
        #     name: TRATBL_sdl_id_pos_igr_sellout__date_check
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration 
        # - test_duplicate:
        #     select_columns: ["filename", "pos_cust", "description", "branch", "type", "values", "yearmonth"] 
        #     group_by_columns: ["filename", "pos_cust", "description", "branch", "type", "values", "yearmonth"] 
        #     name: TRATBL_sdl_id_pos_igr_sellout__duplicate_test
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration
    - name: sdl_id_pos_matahari_otc_stock
      tags: ["id_pos_matahari","ingestion"]
      tests:
        - test_null:
            select_columns: ["filename", "pos_cust", "type", "loc", "store_name", "item", "item_desc", "soh", "yearmonth"] 
            not_null_columns: ["type", "loc", "store_name", "item", "item_desc", "soh"]  
            name: TRATBL_sdl_id_pos_matahari_otc_stock__null_test
            config:
              store_failures: true
              schema: idnwks_integration
        # - test_format:
        #     select_columns: ["filename", "pos_cust", "type", "loc", "store_name", "item", "item_desc", "soh", "yearmonth"]
        #     where_clause: "(TRIM(yearmonth) != '' and TRIM(yearmonth) IS NOT NULL) and regexp_like(TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]')"
        #     name: TRATBL_sdl_id_pos_matahari_otc_stock__date_check
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration 
        # - test_duplicate:
        #     select_columns: ["filename", "pos_cust", "type", "loc", "store_name", "item", "item_desc", "soh", "yearmonth"] 
        #     group_by_columns: ["filename", "pos_cust", "type", "loc", "store_name", "item", "item_desc", "soh", "yearmonth"] 
        #     name: TRATBL_sdl_id_pos_matahari_otc_stock__duplicate_test
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration
    - name: sdl_id_pos_matahari_jb_stock
      tags: ["id_pos_matahari","ingestion"]
      tests:
        - test_null:
            select_columns: ["filename", "pos_cust", "sku", "sku_desc", "qty", "retail_values", "yearmonth"] 
            not_null_columns: ["sku", "sku_desc", "qty", "retail_values"]  
            name: TRATBL_sdl_id_pos_matahari_jb_stock__null_test
            config:
              store_failures: true
              schema: idnwks_integration
        # - test_format:
        #     select_columns: ["filename", "pos_cust", "sku", "sku_desc", "qty", "retail_values", "yearmonth"]
        #     where_clause: "(TRIM(yearmonth) != '' and TRIM(yearmonth) IS NOT NULL) and regexp_like(TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]')"
        #     name: TRATBL_sdl_id_pos_matahari_jb_stock__date_check
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration 
        # - test_duplicate:
        #     select_columns: ["filename", "pos_cust", "sku", "sku_desc", "qty", "retail_values", "yearmonth"] 
        #     group_by_columns: ["filename", "pos_cust", "sku", "sku_desc", "qty", "retail_values", "yearmonth"] 
        #     name: TRATBL_sdl_id_pos_matahari_jb_stock__duplicate_test
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration
    - name: sdl_id_pos_matahari_beauty_stock
      tags: ["id_pos_matahari","ingestion"]
      tests:
        - test_null:
            select_columns: ["filename", "pos_cust", "month", "sku", "sku_desc", "year_qty", "retail_values", "yearmonth"] 
            not_null_columns: ["month", "sku", "sku_desc", "year_qty", "retail_values"]  
            name: TRATBL_sdl_id_pos_matahari_beauty_stock__null_test
            config:
              store_failures: true
              schema: idnwks_integration
        - test_format:
            select_columns: ["filename", "pos_cust", "month", "sku", "sku_desc", "year_qty", "retail_values", "yearmonth"]
            where_clause: "(TRIM(yearmonth) != '' and TRIM(yearmonth) IS NOT NULL) and regexp_like(TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( TRIM(yearmonth), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9][0-9][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-2][0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-3][0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-1][0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]') and  regexp_like( UPPER(TRIM(yearmonth)), '[0-9]_[0-9]_[1-2][0-9]_[0-9]:[0-5][0-9]')"
            name: TRATBL_sdl_id_pos_matahari_beauty_stock__date_check
            config:
              store_failures: true
              schema: idnwks_integration 
        # - test_duplicate:
        #     select_columns: ["filename", "pos_cust", "month", "sku", "sku_desc", "year_qty", "retail_values", "yearmonth"] 
        #     group_by_columns: ["filename", "pos_cust", "month", "sku", "sku_desc", "year_qty", "retail_values", "yearmonth"] 
        #     name: TRATBL_sdl_id_pos_matahari_beauty_stock__duplicate_test
        #     config:
        #       store_failures: true
        #       schema: idnwks_integration
    - name: sdl_id_pos_daily_sat_sellout
      tags: ["id_pos_daily_sat_sellout","transformation"]
    - name: sdl_id_pos_daily_basedline_sellout
      tags: ["id_pos_daily_basedline_sellout","ingestion"]
      tests:
        - test_null:
            select_columns: ["key_account", "plu", "month", "year", "roi_month"] 
            not_null_columns: ["key_account", "plu"]  
            name: TRATBL_sdl_id_pos_daily_basedline_sellout__null_test
            config:
              store_failures: true
              schema: idnwks_integration
        - test_duplicate:
            select_columns: ["key_account", "plu", "month", "year", "roi_month"] 
            group_by_columns: ["plu","roi_month","run_id","crtd_dttm" ] 
            name: TRATBL_sdl_id_pos_daily_basedline_sellout__duplicate_test
            config:
              store_failures: true
              schema: idnwks_integration