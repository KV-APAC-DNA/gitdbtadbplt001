version: 2

models:
  - name: idnedw_integration__edw_distributor_customer_dim
    config:
      alias: edw_distributor_customer_dim
      tags: ["id_dist_cust_dim_itg_edw_load","transformation"]

  - name: idnedw_integration__edw_distributor_salesman_dim
    config:
      alias: edw_distributor_salesman_dim
      tags: ["id_ivy_salesman_master_update","id_mds_itg_load","transformation"]
  - name: idnedw_integration__edw_distributor_dim
    config:
      alias: edw_distributor_dim
      tags: ["id_mds_itg_load","transformation"]
  - name: idnedw_integration__edw_distributor_product_dim
    config:
      alias: edw_distributor_product_dim
      tags: ["id_mds_itg_load","transformation"]
  - name: idnedw_integration__edw_product_dim
    config:
      alias: edw_product_dim
      tags: ["id_mds_itg_load","transformation"]
  - name: idnedw_integration__edw_indonesia_noo_analysis
    config:
      alias: edw_indonesia_noo_analysis
      tags: ["id_noo_analysis","transformation"]
    tests:
      - test_lookup:
          select_columns: ["jj_mnth","SLSMN_ID","jj_sap_dstrbtr_id"]
          column: "upper(SLSMN_ID),jj_sap_dstrbtr_id"
          lookup_column: "upper(SLSMN_ID),jj_sap_dstrbtr_id"
          lookup_table: "{{ref('idnedw_integration__edw_distributor_salesman_dim') }}"     
          failure_reason: "'SLSMN_ID,jj_sap_dstrbtr_id is not present in edw_distributor_salesman_dim'"
          name: TRATBL_edw_ID_NOO_SLSMN_ID_lookup_test
          config:
            store_failures: true
            schema: idnwks_integration    
  - name: idnedw_integration__edw_distributor_channel_dim
    config:
      alias: edw_distributor_channel_dim
      tags: ["id_mds_itg_load","transformation"]
  - name: idnedw_integration__edw_distributor_group_dim
    config:
      alias: edw_distributor_group_dim
      tags: ["id_mds_itg_load","transformation"]