{{
    config(
        materialized='table',
        pre_hook = ["{{build_ssmthsalhedda()}}","
                    UPDATE {{this}}
                    SET CAN_FLG = 1,
                        updated_date = GETDATE(),
                        updated_by = 'ETL_Batch'
                    WHERE SAL_NO IN('221701974125','221701740725','221701533273','221701595259','221701421810','221701434039','221701434040','221701446551','221701505335','221701255913','221701305718','221701060678','221700301010','221700289998','221700289997','221701736684','221700075741','221700075742','221700021699') AND  
                        KAISHA_CD = 'DCL';"]
    )
}}

with SSMTHSALHEDDA
as
(
    select * from dev_dna_load.jpdclsdl_raw.SSMTHSALHEDDA
),
final as
(
    SELECT KAISHA_CD,
        SAL_NO,
        SAL_JISK_IMP_SNSH_NO,
        SAL_SHUR_KBN,
        SAL_DEN_KBN,
        SHANIGI_KBN,
        KKNG_KBN,
        DEN_ADD_KBN,
        SKCH_TR_SITE_KBN,
        TORI_KBN,
        TORI_KENMEI,
        SM_CHANERU_CD,
        MUSYO_JUCH_KBN,
        MUSYO_TORI_RIYUU_CD,
        REND_MT_DEN_SHUBT,
        REND_MT_DEN_NO,
        HASS_MT_DEN_SHUBT,
        HASSEI_MT_DEN_NO,
        SHANAI_TORI_HACHU_NO,
        JUHACHU_TORI_PM_NO,
        SAL_KEIJ_DT,
        SAL_TANTCD,
        SAL_BMN_NAIBU_NO,
        IN_TANTCD,
        TOKUISK_CD,
        SNPO_CHUMON_NO,
        TOKUISK_SNPO_TANT_NMS,
        TOKUISK_SNPO_TANT_TEL,
        TOKUISK_SNPO_TANT_FAX,
        SHHARSK_CD,
        SHHAR_KSSAI_JKEN_NAIBU_NO,
        SHHAR_KSSAI_JKEN_NMS,
        SHHAR_KSSAI_JKEN_NMR,
        SHHARSHIME_KBN,
        SHHARSHIME_NAYOSE_KOMK,
        SKYSK_CD,
        KAIS_KSSAI_JKEN_NAIBU_NO,
        KAIS_KSSAI_JKEN_NMS,
        KAIS_KSSAI_JKEN_NMR,
        SKYSHIME_KBN,
        SKYSHIME_NAYOSE_KOMK,
        SM_SKYSK_YUUBIN_NO,
        SM_SKYSK_ADDR1,
        SM_SKYSK_ADDR2,
        SM_SKYSK_TANT_NMS,
        SM_SKYSK_TEL,
        SM_SKYSK_FAX,
        SHUKASK_CD,
        SHUKASK_NMS1,
        SHUKASK_NMS2,
        SHUKASK_YUUBIN_NO,
        SHUKASK_ADDR1,
        SHUKASK_ADDR2,
        SHUKASK_TANT_NMS,
        SHUKASK_TEL,
        SHUKASK_FAX,
        JUYOUKA_CD,
        SKCH_TR_NAIBU_NO,
        SOKO_NAIBU_NO,
        PJ_CD,
        TATNE_TUKA_CD,
        TATNE_CH_RATE_UNT,
        TATNE_CH_RATE,
        KSAI_TUKA_CD,
        KSAI_CH_RATE_UNT,
        KAJUU_HEIKIN_KSAI_CH_RATE,
        SAL_SUM_KIN,
        SHOUMI_SAL_SUM_KIN,
        SAL_SHOHZEI_SUM_KIN,
        DEN_NEBIKI_RITSU,
        DEN_NEBIKI_KIN,
        SHOUMI_DEN_NEBIKI_KIN,
        DEN_NEBIKI_SZ_KIN,
        DEN_NAF_SAL_KIN,
        DEN_NF_SHM_SAL_KIN,
        DEN_NAF_SAL_SZ_KIN,
        SAL_SUM_KIN_KSAI,
        SHOUMI_SAL_SUM_KIN_KSAI,
        SAL_SZ_SUM_KIN_KSAI,
        DEN_NB_KIN_KSAI,
        SHOUMI_DEN_NB_KIN_KSAI,
        DEN_NB_SZ_KIN_KSAI,
        DEN_NAF_SAL_KIN_KSAI,
        DEN_NF_SHM_SAL_KIN_KSAI,
        DEN_NAF_SAL_SZ_KIN_KSAI,
        SAL_SUM_KIN_KIH,
        SHOUMI_SAL_SUM_KIN_KIH,
        SAL_SZ_SUM_KIN_KIH,
        DEN_NB_KIN_KIH,
        SHOUMI_DEN_NB_KIN_KIH,
        DEN_NB_SZ_KIN_KIH,
        DEN_NAF_SAL_KIN_KIH,
        DEN_NF_SHM_SAL_KIN_KIH,
        DEN_NAF_SAL_SZ_KIN_KIH,
        SAL_GENKA_SUM_KIN,
        SHGK_SUM_KIN,
        SAL_SOU_RIEKI_SUM_KIN,
        SAL_SOU_RIEKI_RITSU,
        HANKAN_HI_TOU_SUM_KIN,
        EIGYOU_RIEKI_SUM_KIN,
        EIGYOU_RIEKI_RITSU,
        SHOKAI_SAL_DT,
        UPD_MT_SAL_NO,
        UPD_SAL_NO,
        SOSAI_SAL_NO,
        SAL_TEKYO,
        SAL_BKO,
        SAL_MEMO,
        KAKAK_KT_KEY_CD,
        SHOKAI_SAL_NO,
        KSSAI_JKEN_MOD_FLG,
        DEN_NAF_SAL_KIN_MOD_FLG,
        SAL_BNKTSU_FLG,
        YOSHIN_GENDO_KIN_OVER_FLG,
        SKCH_TR_GNDGK_OVER_FLG,
        MUSYO_TORI_FUKUMU_FLG,
        TEIKI_SAL_FUKUMU_FLG,
        MEU_SKY_FLG,
        SM_SHNIN_SHNSI_JOKYO_KBN,
        SHOUNIN_SHINSEI_NO,
        ZENKAI_SHOUNIN_SHINSEI_NO,
        SM_SHNIN_SHNSI_JOKYO_KBN_DN,
        SHNIN_SHNSI_NO_DEN,
        RINGISHO_NO,
        SIWK_ADD_JOKYO_KBN,
        CAN_SIWK_ADD_JOKYO_KBN,
        SIWK_RENKEI_NAIBU_NO,
        JIDOU_SIWK_RUN_SEQ_NO,
        AP_RENKEI_JOKYO_KBN,
        AR_RENKEI_JOKYO_KBN,
        AR_AP_RENKEI_SK_KBN,
        SAL_RIREKI_NO,
        SKY_DEN_NAIBU_NO,
        SHHAR_DEN_NAIBU_NO,
        SM_SIWK_NAIBU_NO,
        PROCESSTYPE_CD,
        JYU_HACHU_KBN,
        SOUGK_JUNGK_KBN,
        KWSE_YOYAKU_KANRI_KBN,
        KWSE_YOYAKU_KAIKEI_SHR_KBN,
        TOKUISK_SHUS_JOHO_HYOJI_FLG,
        SKYSK_SHUS_JOHO_HYOJI_FLG,
        SHUKASK_SHUS_JOHO_HYOJI_FLG,
        CAN_FLG,
        CAN_DT,
        CAN_KOUSISHA_CD,
        SM_DEN_ADD_DT,
        DEN_UPD_DT,
        DEN_KOUSISHA,
        TOUROKU_USER,
        TOUROKU_DATE,
        KOUSHIN_USER,
        KOUSHIN_DATE,
        'Src_File_Dt'
    FROM SSMTHSALHEDDA
)
select * from final