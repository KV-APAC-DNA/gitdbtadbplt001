{{
    config
    (
        materialized='incremental',
        incremental_strategy= 'delete+insert',
        unique_key= ['diusrid']
    )
}}


with source as
(
    select * from {{ source('jpdclsdl_raw', 'tbusrpram') }}
),

final as
(
    select 
        diusrid::number(38,0) as diusrid,
        dsname::varchar(30) as dsname,
        dsname2::varchar(30) as dsname2,
        dskana::varchar(30) as dskana,
        dskana2::varchar(30) as dskana2,
        dsmail::varchar(192) as dsmail,
        dspasswd::varchar(48) as dspasswd,
        diflg::number(38,0) as diflg,
        diusropt::varchar(1) as diusropt,
        didevopt::varchar(1) as didevopt,
        disndflg::varchar(1) as disndflg,
        dsctrlcd::varchar(24) as dsctrlcd,
        dsloginname::varchar(192) as dsloginname,
        diagentid::varchar(1) as diagentid,
        diorigincd::number(38,0) as diorigincd,
        diid1::number(38,0) as diid1,
        diid2::number(38,0) as diid2,
        diid3::number(38,0) as diid3,
        dshojinmei::varchar(384) as dshojinmei,
        dsbusho::varchar(384) as dsbusho,
        dsyakushoku::varchar(384) as dsyakushoku,
        dszip::varchar(15) as dszip,
        dspref::varchar(15) as dspref,
        dscity::varchar(108) as dscity,
        dsaddr::varchar(90) as dsaddr,
        dstatemono::varchar(90) as dstatemono,
        dstel::varchar(24) as dstel,
        dsfax::varchar(24) as dsfax,
        dsbirthday::varchar(28) as dsbirthday,
        diblackflg::varchar(1) as diblackflg,
        dsmemo::varchar(3000) as dsmemo,
        dikaigaiflg::varchar(1) as dikaigaiflg,
        dscountrycode::varchar(3) as dscountrycode,
        dsseibetsu::varchar(1) as dsseibetsu,
        disecessionflg::varchar(1) as disecessionflg,
        dipoint::number(38,0) as dipoint,
        dsregistdate::varchar(28) as dsregistdate,
        dipromid::number(38,0) as dipromid,
        dicertmailflg::varchar(1) as dicertmailflg,
        dsdat1::varchar(6000) as dsdat1,
        dsdat2::varchar(6000) as dsdat2,
        dsdat3::varchar(6000) as dsdat3,
        dsdat4::varchar(6000) as dsdat4,
        dsdat5::varchar(6000) as dsdat5,
        dsdat6::varchar(6000) as dsdat6,
        dsdat7::varchar(6000) as dsdat7,
        dsdat8::varchar(6000) as dsdat8,
        dsdat9::varchar(6000) as dsdat9,
        dsdat10::varchar(6000) as dsdat10,
        dsdat11::varchar(6000) as dsdat11,
        dsdat12::varchar(6000) as dsdat12,
        dsdat13::varchar(6000) as dsdat13,
        dsdat14::varchar(6000) as dsdat14,
        dsdat15::varchar(6000) as dsdat15,
        dsdat16::varchar(6000) as dsdat16,
        dsdat17::varchar(6000) as dsdat17,
        dsdat18::varchar(6000) as dsdat18,
        dsdat19::varchar(6000) as dsdat19,
        dsdat20::varchar(6000) as dsdat20,
        dsdat21::varchar(6000) as dsdat21,
        dsdat22::varchar(6000) as dsdat22,
        dsdat23::varchar(6000) as dsdat23,
        dsdat24::varchar(6000) as dsdat24,
        dsdat25::varchar(6000) as dsdat25,
        dsdat26::varchar(6000) as dsdat26,
        dsdat27::varchar(6000) as dsdat27,
        dsdat28::varchar(6000) as dsdat28,
        dsdat29::varchar(6000) as dsdat29,
        dsdat30::varchar(6000) as dsdat30,
        dsdat31::varchar(6000) as dsdat31,
        dsdat32::varchar(6000) as dsdat32,
        dsdat33::varchar(6000) as dsdat33,
        dsdat34::varchar(6000) as dsdat34,
        dsdat35::varchar(6000) as dsdat35,
        dsdat36::varchar(6000) as dsdat36,
        dsdat37::varchar(6000) as dsdat37,
        dsdat38::varchar(6000) as dsdat38,
        dsdat39::varchar(6000) as dsdat39,
        dsdat40::varchar(6000) as dsdat40,
        dsdat41::varchar(6000) as dsdat41,
        dsdat42::varchar(6000) as dsdat42,
        dsdat43::varchar(6000) as dsdat43,
        dsdat44::varchar(6000) as dsdat44,
        dsdat45::varchar(6000) as dsdat45,
        dsdat46::varchar(6000) as dsdat46,
        dsdat47::varchar(6000) as dsdat47,
        dsdat48::varchar(6000) as dsdat48,
        dsdat49::varchar(6000) as dsdat49,
        dsdat50::varchar(6000) as dsdat50,
        dsdat51::varchar(6000) as dsdat51,
        dsdat52::varchar(6000) as dsdat52,
        dsdat53::varchar(6000) as dsdat53,
        dsdat54::varchar(6000) as dsdat54,
        dsdat55::varchar(6000) as dsdat55,
        dsdat56::varchar(6000) as dsdat56,
        dsdat57::varchar(6000) as dsdat57,
        dsdat58::varchar(6000) as dsdat58,
        dsdat59::varchar(6000) as dsdat59,
        dsdat60::varchar(6000) as dsdat60,
        dsdat61::varchar(6000) as dsdat61,
        dsdat62::varchar(6000) as dsdat62,
        dsdat63::varchar(6000) as dsdat63,
        dsdat64::varchar(6000) as dsdat64,
        dsdat65::varchar(6000) as dsdat65,
        dsdat66::varchar(6000) as dsdat66,
        dsdat67::varchar(6000) as dsdat67,
        dsdat68::varchar(6000) as dsdat68,
        dsdat69::varchar(6000) as dsdat69,
        dsdat70::varchar(6000) as dsdat70,
        dsdat71::varchar(6000) as dsdat71,
        dsdat72::varchar(6000) as dsdat72,
        dsdat73::varchar(6000) as dsdat73,
        dsdat74::varchar(6000) as dsdat74,
        dsdat75::varchar(6000) as dsdat75,
        dsdat76::varchar(6000) as dsdat76,
        dsdat77::varchar(6000) as dsdat77,
        dsdat78::varchar(6000) as dsdat78,
        dsdat79::varchar(6000) as dsdat79,
        dsdat80::varchar(6000) as dsdat80,
        dsdat81::varchar(6000) as dsdat81,
        dsdat82::varchar(6000) as dsdat82,
        dsdat83::varchar(6000) as dsdat83,
        dsdat84::varchar(6000) as dsdat84,
        dsdat85::varchar(6000) as dsdat85,
        dsdat86::varchar(6000) as dsdat86,
        dsdat87::varchar(6000) as dsdat87,
        dsdat88::varchar(6000) as dsdat88,
        dsdat89::varchar(6000) as dsdat89,
        dsdat90::varchar(6000) as dsdat90,
        dsdat91::varchar(6000) as dsdat91,
        dsdat92::varchar(6000) as dsdat92,
        dsdat93::varchar(6000) as dsdat93,
        dsdat94::varchar(6000) as dsdat94,
        dsdat95::varchar(6000) as dsdat95,
        dsdat96::varchar(6000) as dsdat96,
        dsdat97::varchar(6000) as dsdat97,
        dsdat98::varchar(6000) as dsdat98,
        dsdat99::varchar(6000) as dsdat99,
        dsdat100::varchar(6000) as dsdat100,
        dsdat101::varchar(6000) as dsdat101,
        dsdat102::varchar(6000) as dsdat102,
        dsdat103::varchar(6000) as dsdat103,
        dsdat104::varchar(6000) as dsdat104,
        dsdat105::varchar(6000) as dsdat105,
        dsdat106::varchar(6000) as dsdat106,
        dsdat107::varchar(6000) as dsdat107,
        dsdat108::varchar(6000) as dsdat108,
        dsdat109::varchar(6000) as dsdat109,
        dsdat110::varchar(6000) as dsdat110,
        dsdat111::varchar(6000) as dsdat111,
        dsdat112::varchar(6000) as dsdat112,
        dsdat113::varchar(6000) as dsdat113,
        dsdat114::varchar(6000) as dsdat114,
        dsdat115::varchar(6000) as dsdat115,
        dsdat116::varchar(6000) as dsdat116,
        dsdat117::varchar(6000) as dsdat117,
        dsdat118::varchar(6000) as dsdat118,
        dsdat119::varchar(6000) as dsdat119,
        dsdat120::varchar(6000) as dsdat120,
        dsdat121::varchar(6000) as dsdat121,
        dsdat122::varchar(6000) as dsdat122,
        dsdat123::varchar(6000) as dsdat123,
        dsdat124::varchar(6000) as dsdat124,
        dsdat125::varchar(6000) as dsdat125,
        dsdat126::varchar(6000) as dsdat126,
        dsdat127::varchar(6000) as dsdat127,
        dsdat128::varchar(6000) as dsdat128,
        dsdat129::varchar(6000) as dsdat129,
        dsdat130::varchar(6000) as dsdat130,
        dsdat131::varchar(6000) as dsdat131,
        dsdat132::varchar(6000) as dsdat132,
        dsdat133::varchar(6000) as dsdat133,
        dsdat134::varchar(6000) as dsdat134,
        dsdat135::varchar(6000) as dsdat135,
        dsdat136::varchar(6000) as dsdat136,
        dsdat137::varchar(6000) as dsdat137,
        dsdat138::varchar(6000) as dsdat138,
        dsdat139::varchar(6000) as dsdat139,
        dsdat140::varchar(6000) as dsdat140,
        dsdat141::varchar(6000) as dsdat141,
        dsdat142::varchar(6000) as dsdat142,
        dsdat143::varchar(6000) as dsdat143,
        dsdat144::varchar(6000) as dsdat144,
        dsdat145::varchar(6000) as dsdat145,
        dsdat146::varchar(6000) as dsdat146,
        dsdat147::varchar(6000) as dsdat147,
        dsdat148::varchar(6000) as dsdat148,
        dsdat149::varchar(6000) as dsdat149,
        dsdat150::varchar(6000) as dsdat150,
        c_dsuid::varchar(6000) as c_dsuid,
        dsprep::varchar(28) as dsprep,
        dsren::varchar(28) as dsren,
        dselim::varchar(28) as dselim,
        diprepusr::number(38,0) as diprepusr,
        direnusr::number(38,0) as direnusr,
        dielimflg::varchar(1) as dielimflg,
        c_dsclntargetupdatedate::varchar(28) as c_dsclntargetupdatedate,
        source_file_date::varchar(10) as source_file_date,
		current_timestamp()::timestamp_ntz(9) as inserted_date,
		inserted_by::varchar(10) as inserted_by,
		current_timestamp()::timestamp_ntz(9) as updated_date,
		updated_by::varchar(100) as updated_by
    from source
)

select * from final