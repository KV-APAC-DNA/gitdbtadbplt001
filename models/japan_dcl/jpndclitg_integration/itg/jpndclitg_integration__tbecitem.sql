{{
    config
    (
        materialized='incremental',
        incremental_strategy= 'delete+insert',
        unique_key= ['diid']
    )
}}

with source as
(
    select * from {{ source('jpdclsdl_raw', 'tbecitem') }}
),

final as
(
    select 
		diid::number(38,0) as diid,
		dsitemid::varchar(45) as dsitemid,
		dsitemname::varchar(192) as dsitemname,
		dsitemnamekana::varchar(384) as dsitemnamekana,
		dsitemnamesrch::varchar(384) as dsitemnamesrch,
		diitemsalescost::number(38,0) as diitemsalescost,
		diitemsalesprc::number(38,0) as diitemsalesprc,
		ditaxdiv::varchar(1) as ditaxdiv,
		dsvalidfrom::timestamp_ntz(9) as dsvalidfrom,
		dsvalidto::timestamp_ntz(9) as dsvalidto,
		dsmemo::varchar(6000) as dsmemo,
		distockdisp::varchar(1) as distockdisp,
		distockoutdisp::varchar(1) as distockoutdisp,
		dihaisopatid::number(38,0) as dihaisopatid,
		diteishiflg::varchar(1) as diteishiflg,
		didispdivflg::varchar(1) as didispdivflg,
		diitemdivflg::varchar(3) as diitemdivflg,
		dsthumnailpath::varchar(96) as dsthumnailpath,
		dspreviewpath::varchar(96) as dspreviewpath,
		dspreviewpath2::varchar(96) as dspreviewpath2,
		dspreviewpath3::varchar(96) as dspreviewpath3,
		dspreviewpath4::varchar(96) as dspreviewpath4,
		dspreviewpath5::varchar(96) as dspreviewpath5,
		dspreviewpath6::varchar(96) as dspreviewpath6,
		dspreviewpath7::varchar(96) as dspreviewpath7,
		dspreviewpath8::varchar(96) as dspreviewpath8,
		dspreviewpath9::varchar(96) as dspreviewpath9,
		dspreviewpath10::varchar(96) as dspreviewpath10,
		dsmbpreviewpath::varchar(96) as dsmbpreviewpath,
		dslinkname::varchar(192) as dslinkname,
		dslinkurl::varchar(384) as dslinkurl,
		dilinktargetflg::varchar(1) as dilinktargetflg,
		dslinktargetname::varchar(24) as dslinktargetname,
		dihaisofreeflg::varchar(1) as dihaisofreeflg,
		diitemgroupid::number(38,0) as diitemgroupid,
		disaleslimit::number(38,0) as disaleslimit,
		diitemdefid::number(38,0) as diitemdefid,
		diitemparentid::number(38,0) as diitemparentid,
		diitemcolno::number(38,0) as diitemcolno,
		diitemrowno::number(38,0) as diitemrowno,
		disearchflg::varchar(1) as disearchflg,
		didetaildispflg::varchar(1) as didetaildispflg,
		dicreatehtmlflg::varchar(1) as dicreatehtmlflg,
		diitemprcflg::varchar(1) as diitemprcflg,
		dipointflg::varchar(1) as dipointflg,
		dipointselectflg::varchar(1) as dipointselectflg,
		dipointrate::number(38,0) as dipointrate,
		dispecialpoint::number(38,0) as dispecialpoint,
		dsspecialpointfrom::timestamp_ntz(9) as dsspecialpointfrom,
		dsspecialpointto::timestamp_ntz(9) as dsspecialpointto,
		dstemplatename::varchar(48) as dstemplatename,
		diitemcatalogprc::number(38,0) as diitemcatalogprc,
		diitemspprc::number(38,0) as diitemspprc,
		dsitemspprcfrom::timestamp_ntz(9) as dsitemspprcfrom,
		dsitemspprcto::timestamp_ntz(9) as dsitemspprcto,
		diwithdccode::varchar(1) as diwithdccode,
		disearchprc::number(38,0) as disearchprc,
		direviewnum::number(38,0) as direviewnum,
		dsreviewave::number(3,1) as dsreviewave,
		dimemberonly::varchar(1) as dimemberonly,
		dimemberlimit::number(38,0) as dimemberlimit,
		dsbiko::varchar(6000) as dsbiko,
		direcommendflg::varchar(1) as direcommendflg,
		dsoption001::varchar(6000) as dsoption001,
		dsoption002::varchar(6000) as dsoption002,
		dsoption003::varchar(6000) as dsoption003,
		dsoption004::varchar(6000) as dsoption004,
		dsoption005::varchar(6000) as dsoption005,
		dsoption006::varchar(6000) as dsoption006,
		dsoption007::varchar(6000) as dsoption007,
		dsoption008::varchar(6000) as dsoption008,
		dsoption009::varchar(6000) as dsoption009,
		dsoption010::varchar(6000) as dsoption010,
		dsoption011::varchar(6000) as dsoption011,
		dsoption012::varchar(6000) as dsoption012,
		dsoption013::varchar(6000) as dsoption013,
		dsoption014::varchar(6000) as dsoption014,
		dsoption015::varchar(6000) as dsoption015,
		dsoption016::varchar(6000) as dsoption016,
		dsoption017::varchar(6000) as dsoption017,
		dsoption018::varchar(6000) as dsoption018,
		dsoption019::varchar(6000) as dsoption019,
		dsoption020::varchar(6000) as dsoption020,
		dsoption021::varchar(6000) as dsoption021,
		dsoption022::varchar(6000) as dsoption022,
		dsoption023::varchar(6000) as dsoption023,
		dsoption024::varchar(6000) as dsoption024,
		dsoption025::varchar(6000) as dsoption025,
		dsoption026::varchar(6000) as dsoption026,
		dsoption027::varchar(6000) as dsoption027,
		dsoption028::varchar(6000) as dsoption028,
		dsoption029::varchar(6000) as dsoption029,
		dsoption030::varchar(6000) as dsoption030,
		dsoption031::varchar(6000) as dsoption031,
		dsoption032::varchar(6000) as dsoption032,
		dsoption033::varchar(6000) as dsoption033,
		dsoption034::varchar(6000) as dsoption034,
		dsoption035::varchar(6000) as dsoption035,
		dsoption036::varchar(6000) as dsoption036,
		dsoption037::varchar(6000) as dsoption037,
		dsoption038::varchar(6000) as dsoption038,
		dsoption039::varchar(6000) as dsoption039,
		dsoption040::varchar(6000) as dsoption040,
		dsoption041::varchar(6000) as dsoption041,
		dsoption042::varchar(6000) as dsoption042,
		dsoption043::varchar(6000) as dsoption043,
		dsoption044::varchar(6000) as dsoption044,
		dsoption045::varchar(6000) as dsoption045,
		dsoption046::varchar(6000) as dsoption046,
		dsoption047::varchar(6000) as dsoption047,
		dsoption048::varchar(6000) as dsoption048,
		dsoption049::varchar(6000) as dsoption049,
		dsoption050::varchar(6000) as dsoption050,
		dsoption051::varchar(6000) as dsoption051,
		dsoption052::varchar(6000) as dsoption052,
		dsoption053::varchar(6000) as dsoption053,
		dsoption054::varchar(6000) as dsoption054,
		dsoption055::varchar(6000) as dsoption055,
		dsoption056::varchar(6000) as dsoption056,
		dsoption057::varchar(6000) as dsoption057,
		dsoption058::varchar(6000) as dsoption058,
		dsoption059::varchar(6000) as dsoption059,
		dsoption060::varchar(6000) as dsoption060,
		dsoption061::varchar(6000) as dsoption061,
		dsoption062::varchar(6000) as dsoption062,
		dsoption063::varchar(6000) as dsoption063,
		dsoption064::varchar(6000) as dsoption064,
		dsoption065::varchar(6000) as dsoption065,
		dsoption066::varchar(6000) as dsoption066,
		dsoption067::varchar(6000) as dsoption067,
		dsoption068::varchar(6000) as dsoption068,
		dsoption069::varchar(6000) as dsoption069,
		dsoption070::varchar(6000) as dsoption070,
		dsoption071::varchar(6000) as dsoption071,
		dsoption072::varchar(6000) as dsoption072,
		dsoption073::varchar(6000) as dsoption073,
		dsoption074::varchar(6000) as dsoption074,
		dsoption075::varchar(6000) as dsoption075,
		dsoption076::varchar(6000) as dsoption076,
		dsoption077::varchar(6000) as dsoption077,
		dsoption078::varchar(6000) as dsoption078,
		dsoption079::varchar(6000) as dsoption079,
		dsoption080::varchar(6000) as dsoption080,
		dsoption081::varchar(6000) as dsoption081,
		dsoption082::varchar(6000) as dsoption082,
		dsoption083::varchar(6000) as dsoption083,
		dsoption084::varchar(6000) as dsoption084,
		dsoption085::varchar(6000) as dsoption085,
		dsoption086::varchar(6000) as dsoption086,
		dsoption087::varchar(6000) as dsoption087,
		dsoption088::varchar(6000) as dsoption088,
		dsoption089::varchar(6000) as dsoption089,
		dsoption090::varchar(6000) as dsoption090,
		dsoption091::varchar(6000) as dsoption091,
		dsoption092::varchar(6000) as dsoption092,
		dsoption093::varchar(6000) as dsoption093,
		dsoption094::varchar(6000) as dsoption094,
		dsoption095::varchar(6000) as dsoption095,
		dsoption096::varchar(6000) as dsoption096,
		dsoption097::varchar(6000) as dsoption097,
		dsoption098::varchar(6000) as dsoption098,
		dsoption099::varchar(6000) as dsoption099,
		dsoption100::varchar(6000) as dsoption100,
		dsoption101::varchar(6000) as dsoption101,
		dsoption102::varchar(6000) as dsoption102,
		dsoption103::varchar(6000) as dsoption103,
		dsoption104::varchar(6000) as dsoption104,
		dsoption105::varchar(6000) as dsoption105,
		dsoption106::varchar(6000) as dsoption106,
		dsoption107::varchar(6000) as dsoption107,
		dsoption108::varchar(6000) as dsoption108,
		dsoption109::varchar(6000) as dsoption109,
		dsoption110::varchar(6000) as dsoption110,
		dsoption111::varchar(6000) as dsoption111,
		dsoption112::varchar(6000) as dsoption112,
		dsoption113::varchar(6000) as dsoption113,
		dsoption114::varchar(6000) as dsoption114,
		dsoption115::varchar(6000) as dsoption115,
		dsoption116::varchar(6000) as dsoption116,
		dsoption117::varchar(6000) as dsoption117,
		dsoption118::varchar(6000) as dsoption118,
		dsoption119::varchar(6000) as dsoption119,
		dsoption120::varchar(6000) as dsoption120,
		dsoption121::varchar(6000) as dsoption121,
		dsoption122::varchar(6000) as dsoption122,
		dsoption123::varchar(6000) as dsoption123,
		dsoption124::varchar(6000) as dsoption124,
		dsoption125::varchar(6000) as dsoption125,
		dsoption126::varchar(6000) as dsoption126,
		dsoption127::varchar(6000) as dsoption127,
		dsoption128::varchar(6000) as dsoption128,
		dsoption129::varchar(6000) as dsoption129,
		dsoption130::varchar(6000) as dsoption130,
		dsoption131::varchar(6000) as dsoption131,
		dsoption132::varchar(6000) as dsoption132,
		dsoption133::varchar(6000) as dsoption133,
		dsoption134::varchar(6000) as dsoption134,
		dsoption135::varchar(6000) as dsoption135,
		dsoption136::varchar(6000) as dsoption136,
		dsoption137::varchar(6000) as dsoption137,
		dsoption138::varchar(6000) as dsoption138,
		dsoption139::varchar(6000) as dsoption139,
		dsoption140::varchar(6000) as dsoption140,
		dsoption141::varchar(6000) as dsoption141,
		dsoption142::varchar(6000) as dsoption142,
		dsoption143::varchar(6000) as dsoption143,
		dsoption144::varchar(6000) as dsoption144,
		dsoption145::varchar(6000) as dsoption145,
		dsoption146::varchar(6000) as dsoption146,
		dsoption147::varchar(6000) as dsoption147,
		dsoption148::varchar(6000) as dsoption148,
		dsoption149::varchar(6000) as dsoption149,
		dsoption150::varchar(6000) as dsoption150,
		dsprep::timestamp_ntz(9) as dsprep,
		dsren::timestamp_ntz(9) as dsren,
		dselim::timestamp_ntz(9) as dselim,
		diprepusr::number(38,0) as diprepusr,
		direnusr::number(38,0) as direnusr,
		dielimusr::number(38,0) as dielimusr,
		dielimflg::varchar(1) as dielimflg,
		source_file_date::varchar(10) as source_file_date,
		current_timestamp()::timestamp_ntz(9) as inserted_date,
		inserted_by::varchar(100) as inserted_by,
		current_timestamp()::timestamp_ntz(9) as updated_date,
		updated_by::varchar(100) as updated_by,
    from source
)

select * from final