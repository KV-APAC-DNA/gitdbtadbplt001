WITH wqwt03
AS (
  SELECT *
  FROM dev_dna_core.snapjpdcledw_integration."wqwt03通販売上明細"
  ),
transformed
AS (
  SELECT
        '売上NO', '受注年度名称', '受注半期名称', '受注四半期名称', '受注年', '受注月', TO_CHAR('受注年月日'::DATE, 'YYYY/MM/DD') AS "受注年月日",
        '出荷年度名称', '出荷半期名称', '出荷四半期名称', '出荷年', '出荷月', TO_CHAR('出荷年月日'::DATE, 'YYYY/MM/DD') AS "出荷年月日",
        '受注区分コード','C受注区分名', '返品理由コード', 'C返品理由名', 'Cキャンセルフラグ名', '取引形態区分コード', 'C取引形態区分名', '決済区分コード', 'C決済区分名', 'C削除フラグ名', 'C通信経路大区分名', 'C通信経路中区分名', 
        'C通信経路小区分名', 'C通信経路名', '購入媒体コード', 'C購入媒体名', '受注商品大々区分コード', 'C受注商品大々区分名', '受注商品大区分コード', 'C受注商品大区分名', '受注商品中区分コード', 
        'C受注商品中区分名', '受注商品コード', 'C受注商品名', '受注担当者コード', 'C受注担当者名', '受注商品SU割引後税抜金額', '受注商品数量', '消費税額', 1, '顧客NO', TO_CHAR('お届希望日'::DATE, 'YYYY/MM/DD') AS "お届希望日",
        '販促DM_店舗名', '販促DM_CC通販その他名', '部門1追加属性1', '部門1追加属性2', 
        '部門1追加属性3', '部門1追加属性4', '部門1追加属性5', '部門1追加属性6', '部門1追加属性7', '部門1追加属性8', '部門1追加属性9', '部門1追加属性10', '部門2追加属性1', '部門2追加属性2',
        '部門2追加属性3', '部門2追加属性4', '部門2追加属性5', '部門2追加属性6', '部門2追加属性7', '部門2追加属性8', '部門2追加属性9', '部門2追加属性10', '部門3追加属性1', '部門3追加属性2', 
        '部門3追加属性3', '部門3追加属性4', '部門3追加属性5', '部門3追加属性6', '部門3追加属性7', '部門3追加属性8', '部門3追加属性9', '部門3追加属性10', '部門4追加属性1', '部門4追加属性2', 
        '部門4追加属性3', '部門4追加属性4', '部門4追加属性5', '部門4追加属性6', '部門4追加属性7', '部門4追加属性8', '部門4追加属性9', '部門4追加属性10', '部門5追加属性1', '部門5追加属性2', 
        '部門5追加属性3', '部門5追加属性4', '部門5追加属性5', '部門5追加属性6', '部門5追加属性7', '部門5追加属性8', '部門5追加属性9', '部門5追加属性10', '部門6追加属性1', '部門6追加属性2', 
        '部門6追加属性3', '部門6追加属性4', '部門6追加属性5', '部門6追加属性6', '部門6追加属性7', '部門6追加属性8', '部門6追加属性9', '部門6追加属性10', '部門6追加属性11', '部門6追加属性12', 
        '部門6追加属性13', '部門6追加属性14', '部門6追加属性15', '部門6追加属性16', '部門6追加属性17', '部門6追加属性18', '部門6追加属性19', '部門6追加属性20' 
        FROM wqwt03
        WHERE 
        --TO_CHAR(DATE(TO_CHAR(出荷年月日, '99999999')), 'YYYY/MM') >= to_char(CURRENT_DATE - interval '1 years','YYYY/MM')
        TO_CHAR(TO_DATE(TO_VARCHAR('出荷年月日'), 'YYYYMMDD'), 'YYYY/MM') >= TO_CHAR(DATEADD('year', -1, CURRENT_TIMESTAMP()), 'YYYY/MM') --Timezone conversion for UTC --20220211
        --出荷年月日 >= 20200801 AND 出荷年月日 <= 20200807 AND 
        --受注区分コード = '0' AND キャンセルフラグ = 1 AND 
        --取引形態区分コード = '02' AND 決済区分コード = '11' AND C通信経路大区分名 = 'Web' AND C通信経路中区分名 = 'PC' AND C通信経路小区分名 = 'WEB売上' AND C通信経路名 = 'BS取込' AND 購入媒体コード = '00000' AND 受注商品大々区分コード = '1' AND 受注商品大区分コード = '10000' AND 受注商品中区分コード = '10050' AND 受注商品コード IN ('商品1','商品2') 
        ORDER BY '売上NO' ASC,'受注区分コード' ASC,'返品理由コード' ASC
),
final
AS (
  SELECT 
        '売上no'::varchar(24) as "売上no",
        '受注年度名称'::varchar(100) as "受注年度名称",
        '受注半期名称'::varchar(20) as "受注半期名称",
        '受注四半期名称'::varchar(100) as "受注四半期名称",
        '受注年'::varchar(16) as "受注年",
        '受注月'::varchar(8) as "受注月",
        '受注年月日'::varchar(18) as "受注年月日",
        '出荷年度名称'::varchar(100) as "出荷年度名称",
        '出荷半期名称'::varchar(20) as "出荷半期名称",
        '出荷四半期名称'::varchar(100) as "出荷四半期名称",
        '出荷年'::varchar(16) as "出荷年",
        '出荷月'::varchar(8) as "出荷月",
        '出荷年月日'::varchar(18) as "出荷年月日",
        '受注区分コード'::varchar(4) as "受注区分コード",
        'c受注区分名'::varchar(223) as "c受注区分名",
        '返品理由コード'::varchar(6) as "返品理由コード",
        'c返品理由名'::varchar(909) as "c返品理由名",
        'cキャンセルフラグ名'::varchar(19) as "cキャンセルフラグ名",
        '取引形態区分コード'::varchar(4) as "取引形態区分コード",
        'c取引形態区分名'::varchar(223) as "c取引形態区分名",
        '決済区分コード'::varchar(4) as "決済区分コード",
        'c決済区分名'::varchar(54) as "c決済区分名",
        'c削除フラグ名'::varchar(23) as "c削除フラグ名",
        'c通信経路大区分名'::varchar(60) as "c通信経路大区分名",
        'c通信経路中区分名'::varchar(60) as "c通信経路中区分名",
        'c通信経路小区分名'::varchar(60) as "c通信経路小区分名",
        'c通信経路名'::varchar(60) as "c通信経路名",
        '購入媒体コード'::varchar(10) as "購入媒体コード",
        'c購入媒体名'::varchar(394) as "c購入媒体名",
        '受注商品大々区分コード'::varchar(7) as "受注商品大々区分コード",
        'c受注商品大々区分名'::varchar(110) as "c受注商品大々区分名",
        '受注商品大区分コード'::varchar(7) as "受注商品大区分コード",
        'c受注商品大区分名'::varchar(110) as "c受注商品大区分名",
        '受注商品中区分コード'::varchar(7) as "受注商品中区分コード",
        'c受注商品中区分名'::varchar(110) as "c受注商品中区分名",
        '受注商品コード'::varchar(45) as "受注商品コード",
        'c受注商品名'::varchar(433) as "c受注商品名",
        '受注担当者コード'::varchar(48) as "受注担当者コード",
        'c受注担当者名'::varchar(73) as "c受注担当者名",
        '受注商品su割引後税抜金額'::number(18,0) as "受注商品su割引後税抜金額",
        '受注商品数量'::number(18,0) as "受注商品数量",
        '消費税額'::number(18,0) as "消費税額",
        '?column?'::number(38,0) as "?column?",
        '顧客no'::varchar(40) as "顧客no",
        'お届希望日'::varchar(18) as "お届希望日",
        '販促dm_店舗名'::varchar(12000) as "販促dm_店舗名",
        '販促dm_cc通販その他名'::varchar(12000) as "販促dm_cc通販その他名",
        '部門1追加属性1'::varchar(1) as "部門1追加属性1",
        '部門1追加属性2'::varchar(1) as "部門1追加属性2",
        '部門1追加属性3'::varchar(1) as "部門1追加属性3",
        '部門1追加属性4'::varchar(1) as "部門1追加属性4",
        '部門1追加属性5'::varchar(1) as "部門1追加属性5",
        '部門1追加属性6'::varchar(1) as "部門1追加属性6",
        '部門1追加属性7'::varchar(1) as "部門1追加属性7",
        '部門1追加属性8'::varchar(1) as "部門1追加属性8",
        '部門1追加属性9'::varchar(1) as "部門1追加属性9",
        '部門1追加属性10'::varchar(1) as "部門1追加属性10",
        '部門2追加属性1'::varchar(1) as "部門2追加属性1",
        '部門2追加属性2'::varchar(1) as "部門2追加属性2",
        '部門2追加属性3'::varchar(1) as "部門2追加属性3",
        '部門2追加属性4'::varchar(1) as "部門2追加属性4",
        '部門2追加属性5'::varchar(1) as "部門2追加属性5",
        '部門2追加属性6'::varchar(1) as "部門2追加属性6",
        '部門2追加属性7'::varchar(1) as "部門2追加属性7",
        '部門2追加属性8'::varchar(1) as "部門2追加属性8",
        '部門2追加属性9'::varchar(1) as "部門2追加属性9",
        '部門2追加属性10'::varchar(1) as "部門2追加属性10",
        '部門3追加属性1'::varchar(1) as "部門3追加属性1",
        '部門3追加属性2'::varchar(1) as "部門3追加属性2",
        '部門3追加属性3'::varchar(1) as "部門3追加属性3",
        '部門3追加属性4'::varchar(1) as "部門3追加属性4",
        '部門3追加属性5'::varchar(1) as "部門3追加属性5",
        '部門3追加属性6'::varchar(1) as "部門3追加属性6",
        '部門3追加属性7'::varchar(1) as "部門3追加属性7",
        '部門3追加属性8'::varchar(1) as "部門3追加属性8",
        '部門3追加属性9'::varchar(1) as "部門3追加属性9",
        '部門3追加属性10'::varchar(1) as "部門3追加属性10",
        '部門4追加属性1'::varchar(1) as "部門4追加属性1",
        '部門4追加属性2'::varchar(1) as "部門4追加属性2",
        '部門4追加属性3'::varchar(1) as "部門4追加属性3",
        '部門4追加属性4'::varchar(1) as "部門4追加属性4",
        '部門4追加属性5'::varchar(1) as "部門4追加属性5",
        '部門4追加属性6'::varchar(1) as "部門4追加属性6",
        '部門4追加属性7'::varchar(1) as "部門4追加属性7",
        '部門4追加属性8'::varchar(1) as "部門4追加属性8",
        '部門4追加属性9'::varchar(1) as "部門4追加属性9",
        '部門4追加属性10'::varchar(1) as "部門4追加属性10",
        '部門5追加属性1'::varchar(1) as "部門5追加属性1",
        '部門5追加属性2'::varchar(1) as "部門5追加属性2",
        '部門5追加属性3'::varchar(1) as "部門5追加属性3",
        '部門5追加属性4'::varchar(1) as "部門5追加属性4",
        '部門5追加属性5'::varchar(1) as "部門5追加属性5",
        '部門5追加属性6'::varchar(1) as "部門5追加属性6",
        '部門5追加属性7'::varchar(1) as "部門5追加属性7",
        '部門5追加属性8'::varchar(1) as "部門5追加属性8",
        '部門5追加属性9'::varchar(1) as "部門5追加属性9",
        '部門5追加属性10'::varchar(1) as "部門5追加属性10",
        '部門6追加属性1'::varchar(1) as "部門6追加属性1",
        '部門6追加属性2'::varchar(1) as "部門6追加属性2",
        '部門6追加属性3'::varchar(1) as "部門6追加属性3",
        '部門6追加属性4'::varchar(1) as "部門6追加属性4",
        '部門6追加属性5'::varchar(1) as "部門6追加属性5",
        '部門6追加属性6'::varchar(1) as "部門6追加属性6",
        '部門6追加属性7'::varchar(1) as "部門6追加属性7",
        '部門6追加属性8'::varchar(1) as "部門6追加属性8",
        '部門6追加属性9'::varchar(1) as "部門6追加属性9",
        '部門6追加属性10'::varchar(1) as "部門6追加属性10",
        '部門6追加属性11'::varchar(1) as "部門6追加属性11",
        '部門6追加属性12'::varchar(1) as "部門6追加属性12",
        '部門6追加属性13'::varchar(1) as "部門6追加属性13",
        '部門6追加属性14'::varchar(1) as "部門6追加属性14",
        '部門6追加属性15'::varchar(1) as "部門6追加属性15",
        '部門6追加属性16'::varchar(1) as "部門6追加属性16",
        '部門6追加属性17'::varchar(1) as "部門6追加属性17",
        '部門6追加属性18'::varchar(1) as "部門6追加属性18",
        '部門6追加属性19'::varchar(1) as "部門6追加属性19",
        '部門6追加属性20'::varchar(1) as "部門6追加属性20"
  FROM transformed
)
SELECT *
FROM final