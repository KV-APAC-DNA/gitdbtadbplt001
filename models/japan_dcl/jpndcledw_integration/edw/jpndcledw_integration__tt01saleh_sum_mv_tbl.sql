
with TT01SALEH_URI_MV as (
select * from DEV_DNA_CORE.SNAPJPDCLEDW_INTEGRATION.TT01SALEH_URI_MV
),
TT01SALEH_HEN_MV as (
select * from DEV_DNA_CORE.SNAPJPDCLEDW_INTEGRATION.TT01SALEH_HEN_MV
),
union_1 as (
SELECT
       SALENO as SALENO,
       JUCHKBN as JUCHKBN,
       JUCHDATE as JUCHDATE,
       KOKYANO as KOKYANO,
       HANROCODE as HANROCODE,
       SYOHANROBUNNAME as SYOHANROBUNNAME,
       CHUHANROBUNNAME as CHUHANROBUNNAME,
       DAIHANROBUNNAME as DAIHANROBUNNAME,
       MEDIACODE as MEDIACODE,
       KESSAIKBN as KESSAIKBN,
       SORYO as SORYO,
       TAX as TAX,
       SOGOKEI as SOGOKEI,
       CARDCORPCODE as CARDCORPCODE,
       HENREASONCODE as HENREASONCODE,
       CANCELFLG as CANCELFLG,
       INSERTDATE as INSERTDATE,
       INSERTTIME as INSERTTIME,
       INSERTID as INSERTID,
       UPDATEDATE as UPDATEDATE,
       UPDATETIME as UPDATETIME,
       ZIPCODE as ZIPCODE,
       TODOFUKENCODE as TODOFUKENCODE,
       HAPPENPOINT as HAPPENPOINT,
       RIYOPOINT as RIYOPOINT,
       SHUKKASTS as SHUKKASTS,
       TORIKEIKBN as TORIKEIKBN,
       TENPOCODE as TENPOCODE,
       SHUKADATE as SHUKADATE,
       RANK as RANK,
       DISPSALENO as DISPSALENO,
       KESAIID as KESAIID,
       HENREASONNAME as HENREASONNAME,
       UKETSUKEUSRID as UKETSUKEUSRID,
       UKETSUKETELCOMPANYCD as UKETSUKETELCOMPANYCD,
       SMKEIROID as SMKEIROID,
       DIPROMID as DIPROMID,
       1 as maker,
       null as SALEHROWID
 FROM
       TT01SALEH_URI_MV TT01SALEH_URI_MV
),
union_2 as (
 SELECT
       SALENO as SALENO,
       JUCHKBN as JUCHKBN,
       JUCHDATE as JUCHDATE,
       KOKYANO as KOKYANO,
       HANROCODE as HANROCODE,
       SYOHANROBUNNAME as SYOHANROBUNNAME,
       CHUHANROBUNNAME as CHUHANROBUNNAME,
       DAIHANROBUNNAME as DAIHANROBUNNAME,
       MEDIACODE as MEDIACODE,
       KESSAIKBN as KESSAIKBN,
       SORYO as SORYO,
       TAX as TAX,
       SOGOKEI as SOGOKEI,
       CARDCORPCODE as CARDCORPCODE,
       HENREASONCODE as HENREASONCODE,
       CANCELFLG as CANCELFLG,
       INSERTDATE as INSERTDATE,
       INSERTTIME as INSERTTIME,
       INSERTID as INSERTID,
       UPDATEDATE as UPDATEDATE,
       UPDATETIME as UPDATETIME,
       ZIPCODE as ZIPCODE,
       TODOFUKENCODE as TODOFUKENCODE,
       HAPPENPOINT as HAPPENPOINT,
       RIYOPOINT as RIYOPOINT,
       SHUKKASTS as SHUKKASTS,
       TORIKEIKBN as TORIKEIKBN,
       TENPOCODE as TENPOCODE,
       SHUKADATE as SHUKADATE,
       RANK as RANK,
       DISPSALENO as DISPSALENO,
       KESAIID as KESAIID,
       HENREASONNAME as HENREASONNAME,
       UKETSUKEUSRID as UKETSUKEUSRID,
       UKETSUKETELCOMPANYCD as UKETSUKETELCOMPANYCD,
       SMKEIROID as SMKEIROID,
       DIPROMID as DIPROMID,
       2 as maker,
       null as SALEHROWID
 FROM
       TT01SALEH_HEN_MV TT01SALEH_HEN_MV
 ),
 transformed as (
 select * from union_1
 union all
 select * from union_2
 ),
 final as (
 select
 	saleno::varchar(62) as saleno,
	juchkbn::varchar(12) as juchkbn,
	juchdate::number(18,0) as juchdate,
	kokyano::varchar(30) as kokyano,
	hanrocode::varchar(60) as hanrocode,
	syohanrobunname::varchar(60) as syohanrobunname,
	chuhanrobunname::varchar(60) as chuhanrobunname,
	daihanrobunname::varchar(60) as daihanrobunname,
	mediacode::varchar(12) as mediacode,
	kessaikbn::varchar(12) as kessaikbn,
	soryo::number(18,0) as soryo,
	tax::number(10,0) as tax,
	sogokei::number(18,0) as sogokei,
	cardcorpcode::varchar(60) as cardcorpcode,
	henreasoncode::varchar(60) as henreasoncode,
	cancelflg::varchar(5) as cancelflg,
	insertdate::number(18,0) as insertdate,
	inserttime::number(18,0) as inserttime,
	insertid::varchar(60) as insertid,
	updatedate::number(18,0) as updatedate,
	updatetime::number(18,0) as updatetime,
	zipcode::varchar(15) as zipcode,
	todofukencode::varchar(15) as todofukencode,
	happenpoint::number(18,0) as happenpoint,
	riyopoint::number(18,0) as riyopoint,
	shukkasts::varchar(60) as shukkasts,
	torikeikbn::varchar(12) as torikeikbn,
	tenpocode::varchar(12) as tenpocode,
	shukadate::number(18,0) as shukadate,
	rank::number(18,0) as rank,
	dispsaleno::varchar(60) as dispsaleno,
	kesaiid::number(10,0) as kesaiid,
	henreasonname::varchar(48) as henreasonname,
	uketsukeusrid::number(18,0) as uketsukeusrid,
	uketsuketelcompanycd::varchar(12) as uketsuketelcompanycd,
	smkeiroid::number(18,0) as smkeiroid,
	dipromid::number(10,0) as dipromid,
	maker::number(18,0) as maker,
	salehrowid::varchar(1) as salehrowid,
    current_timestamp()::timestamp_ntz(9) as inserted_date,
    'etl_batch'::varchar(100) as inserted_by ,
    current_timestamp::timestamp_ntz(9) as updated_date,
    null::varchar(100) as updated_by
    from transformed
 )
 select * from final