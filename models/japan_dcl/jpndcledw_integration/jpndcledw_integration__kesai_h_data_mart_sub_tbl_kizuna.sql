with KESAI_H_DATA_MART_SUB_N as(
    select * from DEV_DNA_CORE.SNAPJPDCLEDW_INTEGRATION.KESAI_H_DATA_MART_SUB_N
),
union1 as(
SELECT CN.SALENO,
	CN.JUCHKBN,
	CN.JUCHYM,
	CN.JUCHDATE,
	CN.JUCHQUARTER,
	CN.JUCHJIGYOKI,
	CN.KOKYANO,
	CN.TORIKEIKBN,
	CN.CANCELFLG,
	CN.HANROCODE,
	CN.SYOHANROBUNNAME,
	CN.CHUHANROBUNNAME,
	CN.DAIHANROBUNNAME,
	CN.MEDIACODE,
	CN.SORYO,
	CN.TAX,
	CN.SOGOKEI,
	CN.TENPOCODE,
	CN.SHUKAYM,
	CN.SHUKADATE,
	CN.SHUKAQUARTER,
	CN.SHUKAJIGYOKI,
	CN.ZIPCODE,
	CN.TODOFUKENCODE,
	CN.RIYOPOINT,
	CN.HAPPENPOINT,
	CN.KESSAIKBN,
	CN.CARDCORPCODE,
	CN.HENREASONCODE,
	CN.MOTOINSERTID,
	CN.MOTOINSERTDATE,
	CN.MOTOUPDATEDATE,
	CN.INSERTDATE,
	CN.INSERTTIME,
	CN.INSERTID,
	CN.UPDATEDATE,
	CN.UPDATETIME,
	CN.UPDATEID,
	CN.RANK,
	CN.DISPSALENO,
	CN.KESAIID,
	CN.ORDERCODE,
	CN.HENREASONNAME,
	CN.UKETSUKEUSRID,
	CN.UKETSUKETELCOMPANYCD,
	CN.SMKEIROID,
	CN.DIPROMID,
	CN.SALENO_TRM,
	CN.DICOLLECTPRC,
	CN.DITOUJITSUHAISOPRC,
	CN.DIDISCOUNTALL,
	CN.C_DIDISCOUNTPRC,
	CN.POINT_EXCHANGE,
	CN.LOGINCODE,
	CN.MAKER,
	CN.TODOFUKEN_CODE,
	CN.SHUKKASTS,
	CN.DIVOUCHERCODE,
	CN.DITAXRATE,
	CN.DISEIKYUREMAIN,
	CN.DINYUKINSTS,
	CN.DICARDNYUKINSTS,
	CN.DISOKOID,
	CN.DIHAISOKEITAI
FROM KESAI_H_DATA_MART_SUB_N CN
WHERE CN.MAKER = 1

),
union2 as( 

SELECT CN.SALENO,
	CN.JUCHKBN,
	CN.JUCHYM,
	CN.JUCHDATE,
	CN.JUCHQUARTER,
	CN.JUCHJIGYOKI,
	CN.KOKYANO,
	CN.TORIKEIKBN,
	CN.CANCELFLG,
	CN.HANROCODE,
	CN.SYOHANROBUNNAME,
	CN.CHUHANROBUNNAME,
	CN.DAIHANROBUNNAME,
	CN.MEDIACODE,
	NVL(CN.SORYO, 0) AS SORYO,
	NVL(CN.TAX, 0) AS TAX,
	NVL(CN.SOGOKEI, 0) AS SOGOKEI,
	CN.TENPOCODE,
	CN.SHUKAYM,
	CN.SHUKADATE,
	CN.SHUKAQUARTER,
	CN.SHUKAJIGYOKI,
	CN.ZIPCODE,
	CN.TODOFUKENCODE,
	NVL(CN.RIYOPOINT, 0) AS RIYOPOINT,
	CN.HAPPENPOINT,
	CN.KESSAIKBN,
	CN.CARDCORPCODE,
	CN.HENREASONCODE,
	CN.MOTOINSERTID,
	CN.MOTOINSERTDATE,
	CN.MOTOUPDATEDATE,
	CN.INSERTDATE,
	CN.INSERTTIME,
	CN.INSERTID,
	CN.UPDATEDATE,
	CN.UPDATETIME,
	CN.UPDATEID,
	CN.RANK,
	CN.DISPSALENO,
	CN.KESAIID,
	CN.ORDERCODE,
	CN.HENREASONNAME,
	CN.UKETSUKEUSRID,
	CN.UKETSUKETELCOMPANYCD,
	CN.SMKEIROID,
	CN.DIPROMID,
	CN.SALENO_TRM,
	NVL(CN.DICOLLECTPRC, 0) AS DICOLLECTPRC,
	NVL(CN.DITOUJITSUHAISOPRC, 0) AS DITOUJITSUHAISOPRC,
	NVL(CN.DIDISCOUNTALL, 0) AS DIDISCOUNTALL,
	NVL(C_DIDISCOUNTPRC, 0) AS C_DIDISCOUNTPRC,
	CN.POINT_EXCHANGE,
	CN.LOGINCODE,
	CN.MAKER,
	CN.TODOFUKEN_CODE,
	CN.SHUKKASTS,
	CN.DIVOUCHERCODE,
	CN.DITAXRATE,
	NVL(CN.DISEIKYUREMAIN, 0) AS DISEIKYUREMAIN,
	CN.DINYUKINSTS,
	CN.DICARDNYUKINSTS,
	CN.DISOKOID,
	CN.DIHAISOKEITAI
FROM KESAI_H_DATA_MART_SUB_N CN
WHERE CN.MAKER = 2

),
transformed as(
    select * from union1
    union all
    select * from union2
)
select * from transformed