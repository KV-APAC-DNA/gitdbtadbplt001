WITH "wqwt03通販売上明細" AS
(
    SELECT * FROM {{ source('jpdcledw_integration','"WQWT03通販売上明細"') }}
),

final AS
(
	SELECT "wqwt03通販売上明細"."売上no",
		"wqwt03通販売上明細"."受注年度名称",
		"wqwt03通販売上明細"."受注半期名称",
		"wqwt03通販売上明細"."受注四半期名称",
		"wqwt03通販売上明細"."受注年",
		"wqwt03通販売上明細"."受注月",
		to_char((DATE (to_char("wqwt03通販売上明細"."受注年月日", '99999999'::TEXT)))::TIMESTAMP without TIME zone, 'YYYY/MM/DD'::TEXT) AS "受注年月日",
		"wqwt03通販売上明細"."出荷年度名称",
		"wqwt03通販売上明細"."出荷半期名称",
		"wqwt03通販売上明細"."出荷四半期名称",
		"wqwt03通販売上明細"."出荷年",
		"wqwt03通販売上明細"."出荷月",
		to_char((DATE (to_char("wqwt03通販売上明細"."出荷年月日", '99999999'::TEXT)))::TIMESTAMP without TIME zone, 'YYYY/MM/DD'::TEXT) AS "出荷年月日",
		"wqwt03通販売上明細"."受注区分コード",
		"wqwt03通販売上明細"."c受注区分名",
		"wqwt03通販売上明細"."返品理由コード",
		"wqwt03通販売上明細"."c返品理由名",
		"wqwt03通販売上明細"."cキャンセルフラグ名",
		"wqwt03通販売上明細"."取引形態区分コード",
		"wqwt03通販売上明細"."c取引形態区分名",
		"wqwt03通販売上明細"."決済区分コード",
		"wqwt03通販売上明細"."c決済区分名",
		"wqwt03通販売上明細"."c削除フラグ名",
		"wqwt03通販売上明細"."c通信経路大区分名",
		"wqwt03通販売上明細"."c通信経路中区分名",
		"wqwt03通販売上明細"."c通信経路小区分名",
		"wqwt03通販売上明細"."c通信経路名",
		"wqwt03通販売上明細"."購入媒体コード",
		"wqwt03通販売上明細"."c購入媒体名",
		"wqwt03通販売上明細"."受注商品大々区分コード",
		"wqwt03通販売上明細"."c受注商品大々区分名",
		"wqwt03通販売上明細"."受注商品大区分コード",
		"wqwt03通販売上明細"."c受注商品大区分名",
		"wqwt03通販売上明細"."受注商品中区分コード",
		"wqwt03通販売上明細"."c受注商品中区分名",
		"wqwt03通販売上明細"."受注商品コード",
		"wqwt03通販売上明細"."c受注商品名",
		"wqwt03通販売上明細"."受注担当者コード",
		"wqwt03通販売上明細"."c受注担当者名",
		"wqwt03通販売上明細"."受注商品su割引後税抜金額",
		"wqwt03通販売上明細"."受注商品数量",
		"wqwt03通販売上明細"."消費税額",
		1,
		"wqwt03通販売上明細"."顧客no",
		to_char((DATE (to_char("wqwt03通販売上明細"."お届希望日", '99999999'::TEXT)))::TIMESTAMP without TIME zone, 'YYYY/MM/DD'::TEXT) AS "お届希望日",
		"wqwt03通販売上明細"."販促dm_店舗名",
		"wqwt03通販売上明細"."販促dm_cc通販その他名",
		"wqwt03通販売上明細"."部門1追加属性1",
		"wqwt03通販売上明細"."部門1追加属性2",
		"wqwt03通販売上明細"."部門1追加属性3",
		"wqwt03通販売上明細"."部門1追加属性4",
		"wqwt03通販売上明細"."部門1追加属性5",
		"wqwt03通販売上明細"."部門1追加属性6",
		"wqwt03通販売上明細"."部門1追加属性7",
		"wqwt03通販売上明細"."部門1追加属性8",
		"wqwt03通販売上明細"."部門1追加属性9",
		"wqwt03通販売上明細"."部門1追加属性10",
		"wqwt03通販売上明細"."部門2追加属性1",
		"wqwt03通販売上明細"."部門2追加属性2",
		"wqwt03通販売上明細"."部門2追加属性3",
		"wqwt03通販売上明細"."部門2追加属性4",
		"wqwt03通販売上明細"."部門2追加属性5",
		"wqwt03通販売上明細"."部門2追加属性6",
		"wqwt03通販売上明細"."部門2追加属性7",
		"wqwt03通販売上明細"."部門2追加属性8",
		"wqwt03通販売上明細"."部門2追加属性9",
		"wqwt03通販売上明細"."部門2追加属性10",
		"wqwt03通販売上明細"."部門3追加属性1",
		"wqwt03通販売上明細"."部門3追加属性2",
		"wqwt03通販売上明細"."部門3追加属性3",
		"wqwt03通販売上明細"."部門3追加属性4",
		"wqwt03通販売上明細"."部門3追加属性5",
		"wqwt03通販売上明細"."部門3追加属性6",
		"wqwt03通販売上明細"."部門3追加属性7",
		"wqwt03通販売上明細"."部門3追加属性8",
		"wqwt03通販売上明細"."部門3追加属性9",
		"wqwt03通販売上明細"."部門3追加属性10",
		"wqwt03通販売上明細"."部門4追加属性1",
		"wqwt03通販売上明細"."部門4追加属性2",
		"wqwt03通販売上明細"."部門4追加属性3",
		"wqwt03通販売上明細"."部門4追加属性4",
		"wqwt03通販売上明細"."部門4追加属性5",
		"wqwt03通販売上明細"."部門4追加属性6",
		"wqwt03通販売上明細"."部門4追加属性7",
		"wqwt03通販売上明細"."部門4追加属性8",
		"wqwt03通販売上明細"."部門4追加属性9",
		"wqwt03通販売上明細"."部門4追加属性10",
		"wqwt03通販売上明細"."部門5追加属性1",
		"wqwt03通販売上明細"."部門5追加属性2",
		"wqwt03通販売上明細"."部門5追加属性3",
		"wqwt03通販売上明細"."部門5追加属性4",
		"wqwt03通販売上明細"."部門5追加属性5",
		"wqwt03通販売上明細"."部門5追加属性6",
		"wqwt03通販売上明細"."部門5追加属性7",
		"wqwt03通販売上明細"."部門5追加属性8",
		"wqwt03通販売上明細"."部門5追加属性9",
		"wqwt03通販売上明細"."部門5追加属性10",
		"wqwt03通販売上明細"."部門6追加属性1",
		"wqwt03通販売上明細"."部門6追加属性2",
		"wqwt03通販売上明細"."部門6追加属性3",
		"wqwt03通販売上明細"."部門6追加属性4",
		"wqwt03通販売上明細"."部門6追加属性5",
		"wqwt03通販売上明細"."部門6追加属性6",
		"wqwt03通販売上明細"."部門6追加属性7",
		"wqwt03通販売上明細"."部門6追加属性8",
		"wqwt03通販売上明細"."部門6追加属性9",
		"wqwt03通販売上明細"."部門6追加属性10",
		"wqwt03通販売上明細"."部門6追加属性11",
		"wqwt03通販売上明細"."部門6追加属性12",
		"wqwt03通販売上明細"."部門6追加属性13",
		"wqwt03通販売上明細"."部門6追加属性14",
		"wqwt03通販売上明細"."部門6追加属性15",
		"wqwt03通販売上明細"."部門6追加属性16",
		"wqwt03通販売上明細"."部門6追加属性17",
		"wqwt03通販売上明細"."部門6追加属性18",
		"wqwt03通販売上明細"."部門6追加属性19",
		"wqwt03通販売上明細"."部門6追加属性20"
	FROM "wqwt03通販売上明細"
    WHERE TO_CHAR(TO_DATE(TO_CHAR("wqwt03通販売上明細"."出荷年月日"), 'YYYYMMDD'), 'YYYY/MM') >= TO_CHAR(DATEADD(year, -3, CURRENT_DATE), 'YYYY/MM')
	ORDER BY "wqwt03通販売上明細"."売上no",
		"wqwt03通販売上明細"."受注区分コード",
		"wqwt03通販売上明細"."返品理由コード"
)

SELECT * FROM final