with source as (
    select * from {{ ref('aspedw_integration__edw_vw_pop6_analysis_active_data') }}
),
final as (
    select
        data_type as "data_type",
        cntry_cd as "cntry_cd",
        visit_id as "visit_id",
        task_group as "task_group",
        task_id as "task_id",
        task_name as "task_name",
        audit_form_id as "audit_form_id",
        audit_form as "audit_form",
        section_id as "section_id",
        section as "section",
        subsection_id as "subsection_id",
        subsection as "subsection",
        field_id as "field_id",
        field_code as "field_code",
        field_label as "field_label",
        field_type as "field_type",
        dependent_on_field_id as "dependent_on_field_id",
        sku_id as "sku_id",
        sku as "sku",
        response as "response",
        visit_date as "visit_date",
        check_in_datetime as "check_in_datetime",
        check_out_datetime as "check_out_datetime",
        popdb_id as "popdb_id",
        pop_code as "pop_code",
        pop_name as "pop_name",
        address as "address",
        check_in_longitude as "check_in_longitude",
        check_in_latitude as "check_in_latitude",
        check_out_longitude as "check_out_longitude",
        check_out_latitude as "check_out_latitude",
        check_in_photo as "check_in_photo",
        check_out_photo as "check_out_photo",
        username as "username",
        user_full_name as "user_full_name",
        superior_username as "superior_username",
        superior_name as "superior_name",
        planned_visit as "planned_visit",
        cancelled_visit as "cancelled_visit",
        cancellation_reason as "cancellation_reason",
        cancellation_note as "cancellation_note",
        promotion_plan_id as "promotion_plan_id",
        promotion_code as "promotion_code",
        promotion_name as "promotion_name",
        promotion_mechanics as "promotion_mechanics",
        promotion_type as "promotion_type",
        promotion_price as "promotion_price",
        promotion_compliance as "promotion_compliance",
        actual_price as "actual_price",
        non_compliance_reason as "non_compliance_reason",
        photo as "photo",
        product_attribute_id as "product_attribute_id",
        product_attribute as "product_attribute",
        product_attribute_value_id as "product_attribute_value_id",
        product_attribute_value as "product_attribute_value",
        pop_status as "pop_status",
        pop_longitude as "pop_longitude",
        pop_latitude as "pop_latitude",
        country as "country",
        channel as "channel",
        retail_environment_ps as "retail_environment_ps",
        customer as "customer",
        sales_group_code as "sales_group_code",
        sales_group_name as "sales_group_name",
        customer_grade as "customer_grade",
        external_pop_code as "external_pop_code",
        business_unit_name as "business_unit_name",
        territory_or_region as "territory_or_region",
        prod_status as "prod_status",
        productdb_id as "productdb_id",
        barcode as "barcode",
        unit_price as "unit_price",
        display_order as "display_order",
        launch_date as "launch_date",
        largest_uom_quantity as "largest_uom_quantity",
        middle_uom_quantity as "middle_uom_quantity",
        smallest_uom_quantity as "smallest_uom_quantity",
        company as "company",
        sku_english as "sku_english",
        sku_code as "sku_code",
        ps_category as "ps_category",
        ps_segment as "ps_segment",
        ps_category_segment as "ps_category_segment",
        country_l1 as "country_l1",
        regional_franchise_l2 as "regional_franchise_l2",
        franchise_l3 as "franchise_l3",
        brand_l4 as "brand_l4",
        sub_category_l5 as "sub_category_l5",
        platform_l6 as "platform_l6",
        variance_l7 as "variance_l7",
        pack_size_l8 as "pack_size_l8",
        sap_matl_num as "sap_matl_num",
        msl_rank as "msl_rank",
        user_status as "user_status",
        userdb_id as "userdb_id",
        first_name as "first_name",
        last_name as "last_name",
        team as "team",
        authorisation_group as "authorisation_group",
        email_address as "email_address",
        user_longitude as "user_longitude",
        user_latitude as "user_latitude",
        display_plan_id as "display_plan_id",
        display_type as "display_type",
        display_code as "display_code",
        display_name as "display_name",
        display_start_date as "display_start_date",
        display_end_date as "display_end_date",
        checklist_method as "checklist_method",
        display_number as "display_number",
        display_comments as "display_comments",
        "y/n_flag" as "y/n_flag",
        mkt_share as "mkt_share",
        planned_visit_date as "planned_visit_date",
        visited_flag as "visited_flag",
        facing as "facing",
        is_eyelevel as "is_eyelevel"
    from source
    where cntry_cd='KR'
)
select * from final