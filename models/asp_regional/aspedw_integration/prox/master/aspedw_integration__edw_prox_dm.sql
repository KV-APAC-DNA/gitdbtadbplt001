with source as
(
    select * from {{ ref('aspedw_integration__edw_vw_prox_dm') }}
),
final as
(
    select year::varchar(50) as year,
    mnth_id::varchar(23) as mnth_id,
    mnth_no::varchar(11) as mnth_no,
    univ_year::varchar(50) as univ_year,
    univ_month::varchar(11) as univ_month,
    country_code::varchar(50) as country_code,
    data_source::varchar(16) as data_source,
    soldto_code::varchar(255) as soldto_code,
    distributor_code::varchar(100) as distributor_code,
    distributor_name::varchar(150) as distributor_name,
    distributor_additional_attribute1::varchar(225) as distributor_additional_attribute1,
    distributor_additional_attribute2::varchar(225) as distributor_additional_attribute2,
    distributor_additional_attribute3::varchar(225) as distributor_additional_attribute3,
    sap_parent_customer_key::varchar(18) as sap_parent_customer_key,
    sap_parent_customer_description::varchar(112) as sap_parent_customer_description,
    sap_customer_channel_key::varchar(18) as sap_customer_channel_key,
    sap_customer_channel_description::varchar(112) as sap_customer_channel_description,
    sap_customer_sub_channel_key::varchar(18) as sap_customer_sub_channel_key,
    sap_sub_channel_description::varchar(112) as sap_sub_channel_description,
    sap_go_to_mdl_key::varchar(18) as sap_go_to_mdl_key,
    sap_go_to_mdl_description::varchar(112) as sap_go_to_mdl_description,
    sap_banner_key::varchar(18) as sap_banner_key,
    sap_banner_description::varchar(112) as sap_banner_description,
    sap_banner_format_key::varchar(18) as sap_banner_format_key,
    sap_banner_format_description::varchar(112) as sap_banner_format_description,
    retail_environment::varchar(75) as retail_environment,
    customer_segment_key::varchar(18) as customer_segment_key,
    region::varchar(1) as region,
    zone_or_area::varchar(1) as zone_or_area,
    customer_segment_description::varchar(75) as customer_segment_description,
    global_product_brand::varchar(1500) as global_product_brand,
    global_product_franchise::varchar(1) as global_product_franchise,
    global_product_category::varchar(300) as global_product_category,
    sls_org::varchar(1) as sls_org,
    from_currency::varchar(5) as from_currency,
    to_currecy::varchar(3) as to_currecy,
    exchange_rate::number(15,5) as exchange_rate,
    exrt_from_ratio::number(9,0) as exrt_from_ratio,
    exrt_to_ratio::number(9,0) as exrt_to_ratio,
    sellout_sales_quantity::number(38,11) as sellout_sales_quantity,
    sellout_sales_value::number(38,11) as sellout_sales_value,
    sellout_sales_value_usd::number(38,22) as sellout_sales_value_usd,
    sellout_value_list_price::number(38,11) as sellout_value_list_price,
    sellout_value_list_price_usd::number(38,22) as sellout_value_list_price_usd,
    tpm_customer_cd::varchar(255) as tpm_customer_cd,
    tpm_customer_nm::varchar(1500) as tpm_customer_nm,
    tpm_brand_cd::varchar(300) as tpm_brand_cd,
    tpm_brand_nm::varchar(1500) as tpm_brand_nm,
    tpm_channel::varchar(300) as tpm_channel,
    tpm_sub_channel::varchar(150) as tpm_sub_channel,
    market_portfolio::varchar(1) as market_portfolio,
    customer_segmentation::varchar(300) as customer_segmentation,
    tpm_expensesubcategory::varchar(382) as tpm_expensesubcategory,
    tpm_budgettype::varchar(75) as tpm_budgettype,
    tpm_budgetamount::number(38,11) as tpm_budgetamount,
    tpm_used_budget::number(38,11) as tpm_used_budget,
    tpm_budgetbalance::number(38,11) as tpm_budgetbalance,
    tpm_ytdcommitment::number(38,11) as tpm_ytdcommitment,
    tpm_ytgcommitment::number(38,11) as tpm_ytgcommitment,
    tpm_commitment::number(38,11) as tpm_commitment,
    tpm_penddingamount::number(38,11) as tpm_penddingamount,
    tpm_paid::number(38,11) as tpm_paid,
    tpm_approvedpayment::number(38,11) as tpm_approvedpayment,
    tpm_pendingapprovalpayment::number(38,11) as tpm_pendingapprovalpayment,
    tpm_availabletopay::number(38,11) as tpm_availabletopay,
    tpm_draftamount::number(38,11) as tpm_draftamount,
    tpm_budgetowner::varchar(1000) as tpm_budgetowner,
    tpm_budgetamount_usd::number(38,22) as tpm_budgetamount_usd,
    tpm_used_budget_usd::number(38,22) as tpm_used_budget_usd,
    tpm_budgetbalance_usd::number(38,22) as tpm_budgetbalance_usd,
    tpm_ytdcommitment_usd::number(38,22) as tpm_ytdcommitment_usd,
    tpm_ytgcommitment_usd::number(38,22) as tpm_ytgcommitment_usd,
    tpm_commitment_usd::number(38,22) as tpm_commitment_usd,
    tpm_penddingamount_usd::number(38,22) as tpm_penddingamount_usd,
    tpm_paid_usd::number(38,22) as tpm_paid_usd,
    tpm_approvedpayment_usd::number(38,22) as tpm_approvedpayment_usd,
    tpm_pendingapprovalpayment_usd::number(38,22) as tpm_pendingapprovalpayment_usd,
    tpm_availabletopay_usd::number(38,22) as tpm_availabletopay_usd,
    tpm_draftamount_usd::number(38,22) as tpm_draftamount_usd,
    tpm_customertype::varchar(255) as tpm_customertype,
    tpm_hqsoldtocode::varchar(50) as tpm_hqsoldtocode,
    tpm_hqsoldtoname::varchar(1000) as tpm_hqsoldtoname,
    tpm_contractno::varchar(50) as tpm_contractno,
    tpm_contracttempno::varchar(50) as tpm_contracttempno,
    tpm_contracttitle::varchar(1000) as tpm_contracttitle,
    tpm_themecode::varchar(50) as tpm_themecode,
    tpm_themename::varchar(1000) as tpm_themename,
    tpm_objective::varchar(255) as tpm_objective,
    tpm_feespaid::varchar(255) as tpm_feespaid,
    tpm_contractrevenuerecognitionstartdate::timestamp_ntz(9) as tpm_contractrevenuerecognitionstartdate,
    tpm_contractrevenuerecognitionenddate::timestamp_ntz(9) as tpm_contractrevenuerecognitionenddate,
    tpm_contractpromoexecutionstartdate::timestamp_ntz(9) as tpm_contractpromoexecutionstartdate,
    tpm_contractpromoexecutionenddate::timestamp_ntz(9) as tpm_contractpromoexecutionenddate,
    tpm_contractcreatedate::timestamp_ntz(9) as tpm_contractcreatedate,
    tpm_contractapprovaldate::timestamp_ntz(9) as tpm_contractapprovaldate,
    tpm_contractstatus::varchar(255) as tpm_contractstatus,
    tpm_dateback::varchar(50) as tpm_dateback,
    tpm_datebackreason::varchar(1000) as tpm_datebackreason,
    tpm_expenseid::varchar(50) as tpm_expenseid,
    tpm_contract_customercode::varchar(50) as tpm_contract_customercode,
    tpm_contract_customername::varchar(1000) as tpm_contract_customername,
    tpm_rebateno::varchar(50) as tpm_rebateno,
    tpm_rebateactivityname::varchar(200) as tpm_rebateactivityname,
    tpm_customercontractno::varchar(500) as tpm_customercontractno,
    tpm_expenserevenuerecognitionstartdate::timestamp_ntz(9) as tpm_expenserevenuerecognitionstartdate,
    tpm_expenserevenuerecognitionenddate::timestamp_ntz(9) as tpm_expenserevenuerecognitionenddate,
    tpm_expensepromoexecutionstartdate::timestamp_ntz(9) as tpm_expensepromoexecutionstartdate,
    tpm_expensepromoexecutionenddate::timestamp_ntz(9) as tpm_expensepromoexecutionenddate,
    tpm_expenseclosed::varchar(50) as tpm_expenseclosed,
    tpm_closeuser::varchar(255) as tpm_closeuser,
    tpm_closetime::timestamp_ntz(9) as tpm_closetime,
    tpm_contracttype::varchar(255) as tpm_contracttype,
    tpm_conditiontype::varchar(50) as tpm_conditiontype,
    tpm_glaccount::varchar(50) as tpm_glaccount,
    tpm_expensetypename::varchar(1000) as tpm_expensetypename,
    tpm_profitcenter::varchar(1000) as tpm_profitcenter,
    tpm_ppgcode::varchar(50) as tpm_ppgcode,
    tpm_ppgname::varchar(1000) as tpm_ppgname,
    tpm_rate::varchar(21) as tpm_rate,
    tpm_materialcode::varchar(50) as tpm_materialcode,
    tpm_materialname::varchar(1000) as tpm_materialname,
    tpm_rtmchannel::varchar(255) as tpm_rtmchannel,
    tpm_paymentmethod::varchar(255) as tpm_paymentmethod,
    tpm_expenseamount::number(38,11) as tpm_expenseamount,
    tpm_commitmentamount::number(38,11) as tpm_commitmentamount,
    tpm_accrualreleaseamountwithouttax::number(38,11) as tpm_accrualreleaseamountwithouttax,
    tpm_closeamount::number(38,11) as tpm_closeamount,
    tpm_paidamount::number(38,11) as tpm_paidamount,
    tpm_approvedamount::number(38,11) as tpm_approvedamount,
    tpm_unpaidamount::number(38,11) as tpm_unpaidamount,
    tpm_agingdays::number(18,0) as tpm_agingdays,
    tpm_aging::varchar(255) as tpm_aging,
    tpm_applicant::varchar(255) as tpm_applicant,
    tpm_contractdescription::varchar(4000) as tpm_contractdescription,
    tpm_documentlink::varchar(4000) as tpm_documentlink,
    tpm_withattachment::varchar(50) as tpm_withattachment,
    tpm_dtsmarkuprate::varchar(21) as tpm_dtsmarkuprate,
    expenseamount_usd::number(38,22) as expenseamount_usd,
    commitmentamount_usd::number(38,22) as commitmentamount_usd,
    accrualreleaseamountwithouttax_usd::number(38,22) as accrualreleaseamountwithouttax_usd,
    paidamount_usd::number(38,22) as paidamount_usd,
    approvedamount_usd::number(38,22) as approvedamount_usd,
    unpaidamount_usd::number(38,22) as unpaidamount_usd,
    availabletopay_usd::number(38,22) as availabletopay_usd,
    closeamount_usd::number(38,22) as closeamount_usd,
    tpm_paymentno::varchar(50) as tpm_paymentno,
    tpm_paymentstatus::varchar(255) as tpm_paymentstatus,
    tpm_paytocode::varchar(50) as tpm_paytocode,
    tpm_paytoname::varchar(1000) as tpm_paytoname,
    tpm_paymenttitle::varchar(4000) as tpm_paymenttitle,
    tpm_reverseno::varchar(50) as tpm_reverseno,
    tpm_oldreverseno::varchar(50) as tpm_oldreverseno,
    tpm_invoicenumber::varchar(200) as tpm_invoicenumber,
    tpm_invoicetype::varchar(255) as tpm_invoicetype,
    tpm_sapdocnumber::varchar(50) as tpm_sapdocnumber,
    tpm_sapdocdate::timestamp_ntz(9) as tpm_sapdocdate,
    tpm_paymentamountwithouttax::number(38,11) as tpm_paymentamountwithouttax,
    tpm_invoiceamountwithouttax::number(38,11) as tpm_invoiceamountwithouttax,
    tpm_vatcode::varchar(50) as tpm_vatcode,
    tpm_vatamount::number(38,11) as tpm_vatamount,
    tpm_whtcode::varchar(50) as tpm_whtcode,
    tpm_whtamount::number(38,11) as tpm_whtamount,
    tpm_amountpayable::number(38,11) as tpm_amountpayable,
    tpm_supportingdocuments::varchar(4000) as tpm_supportingdocuments,
    tpm_currentapprovaluser::varchar(4000) as tpm_currentapprovaluser,
    tpm_rejectreason::varchar(4000) as tpm_rejectreason,
    tpm_contractnotemp::varchar(50) as tpm_contractnotemp,
    tpm_paymentstartdate::timestamp_ntz(9) as tpm_paymentstartdate,
    tpm_paymentenddate::timestamp_ntz(9) as tpm_paymentenddate,
    tpm_autoallocate::varchar(50) as tpm_autoallocate,
    tpm_parked::varchar(50) as tpm_parked,
    tpm_payfromaccrual::varchar(50) as tpm_payfromaccrual,
    tpm_accrualglaccount::varchar(50) as tpm_accrualglaccount,
    tpm_contractoriginalamount::number(38,11) as tpm_contractoriginalamount,
    tpm_contractavailabletopay::number(38,11) as tpm_contractavailabletopay,
    tpm_plannedbalance::number(38,11) as tpm_plannedbalance,
    tpm_saprebateno::varchar(50) as tpm_saprebateno,
    tpm_rebatesettlementno::varchar(50) as tpm_rebatesettlementno,
    tpm_sapcmno::varchar(50) as tpm_sapcmno,
    tpm_sapcmdate::timestamp_ntz(9) as tpm_sapcmdate,
    tpm_contractdetailstatus::varchar(50) as tpm_contractdetailstatus,
    tpm_createuser::varchar(255) as tpm_createuser,
    tpm_createtime::timestamp_ntz(9) as tpm_createtime,
    tpm_applicantdate::timestamp_ntz(9) as tpm_applicantdate,
    tpm_approvedate::timestamp_ntz(9) as tpm_approvedate,
    tpm_postingdate::timestamp_ntz(9) as tpm_postingdate,
    tpm_postingperiod::varchar(50) as tpm_postingperiod,
    tpm_fillingid::varchar(1000) as tpm_fillingid,
    tpm_endtoendleadtime::number(18,0) as tpm_endtoendleadtime,
    tpm_salesinputleadtime::number(18,0) as tpm_salesinputleadtime,
    tpm_salesapprovalleadtime::number(18,0) as tpm_salesapprovalleadtime,
    tpm_mrc::varchar(50) as tpm_mrc,
    tpm_printatddate::timestamp_ntz(9) as tpm_printatddate,
    tpm_invoicenovat::varchar(50) as tpm_invoicenovat,
    tpm_invoicenowht::varchar(50) as tpm_invoicenowht,
    tpm_businesstaxcode::varchar(50) as tpm_businesstaxcode,
    tpm_businesstaxamount::number(38,11) as tpm_businesstaxamount,
    tpm_businesstax::varchar(50) as tpm_businesstax,
    paymentamountwithouttax_usd::number(38,22) as paymentamountwithouttax_usd,
    invoiceamountwithouttax_usd::number(38,22) as invoiceamountwithouttax_usd,
    vatamount_usd::number(38,22) as vatamount_usd,
    whtamount_usd::number(38,22) as whtamount_usd,
    amountpayable_usd::number(38,22) as amountpayable_usd,
    contractoriginalamount_usd::number(38,22) as contractoriginalamount_usd,
    contractavailabletopay_usd::number(38,22) as contractavailabletopay_usd,
    plannedbalance_usd::number(38,22) as plannedbalance_usd,
    businesstaxamount_usd::number(38,22) as businesstaxamount_usd,
    tpm_commitment_monthly::number(38,11) as tpm_commitment_monthly,
    tpm_commitment_monthly_usd::number(38,22) as tpm_commitment_monthly_usd,
    tpm_commitment_monthly_flag::varchar(50) as tpm_commitment_monthly_flag,
    sellin_sales_quantity::number(38,11) as sellin_sales_quantity,
    sellin_sales_value::number(38,11) as sellin_sales_value,
    sellin_sales_value_usd::number(38,11) as sellin_sales_value_usd,
    sellin_value_list_price::number(38,11) as sellin_value_list_price,
    sellin_value_list_price_usd::number(38,11) as sellin_value_list_price_usd,
    country_name::varchar(50) as country_name,
    dm_date::date as dm_date
 from source
)
select * from final