{{
    config(
        alias="wks_itg_cust_base",
        sql_header="ALTER SESSION SET TIMEZONE = 'Asia/Singapore';",
        materialized="incremental",
        incremental_strategy="merge",
        unique_key=["kunnr"],
        merge_exclude_columns=["crt_dttm"],
        tags=[""]
    )
}}

with
    source as 
        (select * from {{ ref('aspitg_integration__stg_sdl_sap_ecc_customer_base') }}
        ),

    final as (
        select
            mandt,
            kunnr,
            adrnr,
            anred,
            aufsd,
            bahne,
            bahns,
            bbbnr,
            bbsnr,
            begru,
            brsch,
            bubkz,
            datlt,
            erdat,
            ernam,
            exabl,
            faksd,
            fiskn,
            knazk,
            knrza,
            konzs,
            ktokd,
            kukla,
            land1,
            lifnr,
            lifsd,
            locco,
            loevm,
            name1,
            name2,
            name3,
            name4,
            niels,
            ort01,
            ort02,
            pfach,
            pstl2,
            pstlz,
            regio,
            counc,
            cityc,
            rpmkr,
            sortl,
            sperr,
            spras,
            stcd1,
            stcd2,
            stkza,
            stkzu,
            stras,
            telbx,
            telf1,
            telf2,
            telfx,
            teltx,
            telx1,
            lzone,
            xcpdk,
            xzemp,
            vbund,
            stceg,
            dear1,
            dear2,
            dear3,
            dear4,
            dear5,
            dear6,
            gform,
            bran1,
            bran2,
            bran3,
            bran4,
            bran5,
            ekont,
            umsat,
            umjah,
            uwaer,
            jmzah,
            jmjah,
            katr1,
            katr2,
            katr3,
            katr4,
            katr5,
            katr6,
            katr7,
            katr8,
            katr9,
            katr10,
            stkzn,
            umsa1,
            txjcd,
            mcod1,
            mcod2,
            mcod3,
            periv,
            abrvw,
            inspbydebi,
            inspatdebi,
            ktocd,
            pfort,
            werks,
            dtams,
            dtaws,
            duefl,
            hzuor,
            sperz,
            etikg,
            civve,
            milve,
            kdkg1,
            kdkg2,
            kdkg3,
            kdkg4,
            kdkg5,
            xknza,
            fityp,
            stcdt,
            stcd3,
            stcd4,
            xicms,
            xxipi,
            xsubt,
            cfopc,
            txlw1,
            txlw2,
            ccc01,
            ccc02,
            ccc03,
            ccc04,
            cassd,
            knurl,
            current_timestamp()::timestamp_ntz(9) as crt_dttm,
            current_timestamp()::timestamp_ntz(9) as updt_dttm
            from source
        
    )

select * from final
