with source as (
    select * from {{ ref('aspitg_integration__itg_invnt') }}
),
final as(
     SELECT
    LCL_CRNCY,
    base_unit,
    MATL_no,
    STRG_loc,
    stk_type,
    stk_CAT,
    co_cd,
    matl_plnt_VIEW,
    BTCH_NUM,
    plnt,
    WHSE_NUM,
    STRG_bin,
    strg_type,
    SPL_stck_val,
    spl_stck_indica,
    doc_dt,
    VALUT_cls,
    VALUT_area,
    VALUT_type,
    PSTNG_dt,
    CAL_DAY,
    WH_MSTR,
    VERS,
    val_type,
    VEND,
    sold_to_prty,
    MVMT_ind_sec,
    CRNCY,
    FISC_yr_VRNT,
    fisc_yr,
    Cal_yr,
    CAL_mo,
    QTR,
    Cal_YR_QTR,
    CAL_YR_WK,
    PSTNG_PER,
    Half_yr,
    WKDAY,
    fisc_yr_per,
    CAL_YR_MON,
    SUM(STCK_REC_VAL) AS STCK_REC_VAL,
    SUM(iss_STCK_val) AS iss_STCK_val,
    SUM(iss_BLOK_qty) AS iss_BLOK_qty,
    SUM(cng_stk_qty_iss) AS cng_stk_qty_iss,
    SUM(iss_qty_QUAL) AS iss_qty_QUAL,
    SUM(iss_qty_TRST) AS iss_qty_TRST,
    SUM(RCPT_qty_blok) AS RCPT_qty_blok,
    SUM(cns_STCK_RCPT) AS cns_STCK_RCPT,
    SUM(RCPT_qty_qual) AS RCPT_qty_qual,
    SUM(RCPT_qty_trst) AS RCPT_qty_trst,
    SUM(iss_qty_SCRAP) AS iss_qty_SCRAP,
    SUM(iss_val_SCRAP) AS iss_val_SCRAP,
    SUM(RCPT_tot_stck) AS RCPT_tot_stck,
    SUM(iss_tot_stck) AS iss_tot_stck,
    SUM(iss_qty_stck_val) AS iss_qty_stck_val,
    SUM(rec_qty_val_stck) AS rec_qty_val_stck,
    SUM(vdr_cnsgnmnt_stck_cnval) AS vdr_cnsgnmnt_stck_cnval,
    SUM(rec_val_Q_stck) AS rec_val_Q_stck,
    SUM(rec_val_blok) AS rec_val_blok,
    SUM(iss_val_blok) AS iss_val_blok,
    SUM(iss_val_Q_stck) AS iss_val_Q_stck,
    SUM(rec_val_trst) AS rec_val_trst,
    SUM(iss_val_trst) AS iss_val_trst,
    SUM(iss_val_cons_stck) AS iss_val_cons_stck,
    SUM(rcpt_val_cons_stk) AS rcpt_val_cons_stk,
    SUM(bw_PRCH_val) AS bw_PRCH_val,
    SUM(bw_amt_bunitm) AS bw_amt_bunitm,
    SUM(DELV_cost) AS DELV_cost,
    SUM(std_matl_cost) AS std_matl_cost,
    SUM(PRC_unit) AS PRC_unit,
    SUM(LINE_CNT) AS LINE_CNT
  FROM source
  GROUP BY
    LCL_CRNCY,
    base_unit,
    MATL_no,
    STRG_loc,
    stk_type,
    stk_CAT,
    co_cd,
    matl_plnt_VIEW,
    BTCH_NUM,
    plnt,
    WHSE_NUM,
    STRG_bin,
    strg_type,
    SPL_stck_val,
    spl_stck_indica,
    doc_dt,
    VALUT_cls,
    VALUT_area,
    VALUT_type,
    PSTNG_dt,
    CAL_DAY,
    WH_MSTR,
    VERS,
    val_type,
    VEND,
    sold_to_prty,
    MVMT_ind_sec,
    CRNCY,
    FISC_yr_VRNT,
    fisc_yr,
    Cal_yr,
    CAL_mo,
    QTR,
    Cal_YR_QTR,
    CAL_YR_WK,
    PSTNG_PER,
    Half_yr,
    WKDAY,
    fisc_yr_per,
    CAL_YR_MON
)

select * from final