with source as (
    select * from {{ ref('aspitg_integration__itg_invnt') }}
),
final as(
    SELECT
    trim(lcl_crncy) as lcl_crncy,
    trim(base_unit) as base_unit,
    trim(matl_no) as matl_no,
    trim(strg_loc) as strg_loc,
    trim(stk_type) as stk_type,
    trim(stk_cat) as stk_cat,
    trim(co_cd) as co_cd,
    trim(matl_plnt_view) as matl_plnt_view,
    trim(btch_num) as btch_num,
    trim(plnt) as plnt,
    trim(whse_num) as whse_num,
    trim(strg_bin) as strg_bin,
    trim(strg_type) as strg_type,
    trim(spl_stck_val) as spl_stck_val,
    trim(spl_stck_indica) as spl_stck_indica,
    trim(doc_dt) as doc_dt,
    trim(valut_cls) as valut_cls,
    trim(valut_area) as valut_area,
    trim(valut_type) as valut_type,
    trim(pstng_dt) as pstng_dt,
    trim(cal_day) as cal_day,
    trim(wh_mstr) as wh_mstr,
    trim(vers) as vers,
    trim(val_type) as val_type,
    trim(vend) as vend,
    trim(sold_to_prty) as sold_to_prty,
    trim(mvmt_ind_sec) as mvmt_ind_sec,
    trim(crncy) as crncy,
    trim(fisc_yr_vrnt) as fisc_yr_vrnt,
    trim(fisc_yr) as fisc_yr,
    trim(cal_yr) as cal_yr,
    trim(cal_mo) as cal_mo,
    trim(qtr) as qtr,
    trim(cal_yr_qtr) as cal_yr_qtr,
    trim(cal_yr_wk) as cal_yr_wk,
    trim(pstng_per) as pstng_per,
    trim(half_yr) as half_yr,
    trim(wkday) as wkday,
    trim(fisc_yr_per) as fisc_yr_per,
    trim(cal_yr_mon) as cal_yr_mon,
    SUM(stck_rec_val) as stck_rec_val,
    SUM(iss_stck_val) as iss_stck_val,
    SUM(iss_blok_qty) as iss_blok_qty,
    SUM(cng_stk_qty_iss) as cng_stk_qty_iss,
    SUM(iss_qty_qual) as iss_qty_qual,
    SUM(iss_qty_trst) as iss_qty_trst,
    SUM(rcpt_qty_blok) as rcpt_qty_blok,
    SUM(cns_stck_rcpt) as cns_stck_rcpt,
    SUM(rcpt_qty_qual) as rcpt_qty_qual,
    SUM(rcpt_qty_trst) as rcpt_qty_trst,
    SUM(iss_qty_scrap) as iss_qty_scrap,
    SUM(iss_val_scrap) as iss_val_scrap,
    SUM(rcpt_tot_stck) as rcpt_tot_stck,
    SUM(iss_tot_stck) as iss_tot_stck,
    SUM(iss_qty_stck_val) as iss_qty_stck_val,
    SUM(rec_qty_val_stck) as rec_qty_val_stck,
    SUM(vdr_cnsgnmnt_stck_cnval) as vdr_cnsgnmnt_stck_cnval,
    SUM(rec_val_q_stck) as rec_val_q_stck,
    SUM(rec_val_blok) as rec_val_blok,
    SUM(iss_val_blok) as iss_val_blok,
    SUM(iss_val_q_stck) as iss_val_q_stck,
    SUM(rec_val_trst) as rec_val_trst,
    SUM(iss_val_trst) as iss_val_trst,
    SUM(iss_val_cons_stck) as iss_val_cons_stck,
    SUM(rcpt_val_cons_stk) as rcpt_val_cons_stk,
    SUM(bw_prch_val) as bw_prch_val,
    SUM(bw_amt_bunitm) as bw_amt_bunitm,
    SUM(delv_cost) as delv_cost,
    SUM(std_matl_cost) as std_matl_cost,
    SUM(prc_unit) as prc_unit,
    SUM(line_cnt) as line_cnt
FROM source
GROUP BY
    trim(lcl_crncy),
    trim(base_unit),
    trim(matl_no),
    trim(strg_loc),
    trim(stk_type),
    trim(stk_cat),
    trim(co_cd),
    trim(matl_plnt_view),
    trim(btch_num),
    trim(plnt),
    trim(whse_num),
    trim(strg_bin),
    trim(strg_type),
    trim(spl_stck_val),
    trim(spl_stck_indica),
    trim(doc_dt),
    trim(valut_cls),
    trim(valut_area),
    trim(valut_type),
    trim(pstng_dt),
    trim(cal_day),
    trim(wh_mstr),
    trim(vers),
    trim(val_type),
    trim(vend),
    trim(sold_to_prty),
    trim(mvmt_ind_sec),
    trim(crncy),
    trim(fisc_yr_vrnt),
    trim(fisc_yr),
    trim(cal_yr),
    trim(cal_mo),
    trim(qtr),
    trim(cal_yr_qtr),
    trim(cal_yr_wk),
    trim(pstng_per),
    trim(half_yr),
    trim(wkday),
    trim(fisc_yr_per),
    trim(cal_yr_mon)
)

select * from final