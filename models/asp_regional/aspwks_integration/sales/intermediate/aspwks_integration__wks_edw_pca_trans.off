with itg_pca_trans as(
    select * from aspitg_integration.itg_pca_trans
),
edw_acct_hier as(
    select * from aspedw_integration.edw_acct_hier
),
final as(
 SELECT fisc_yr_per,
       fisc_yr_vrnt,
       fisc_yr,
       pstng_per,
       crncy,
       uom,
       itg_pca_trans.acct_num,
       chrt_of_acct,
       co_cd,
       cntl_area,
       crncy_type,
       ptnr_prft_ctr,
       prft_ctr,
       vers,
       depr_area,
       orig_obj_type,
       trad_ptnr,
       ptnr_co_cd,
       partorobtype_pca,
       obj_cls,
       mvmt_type,
       sum(cum_bal) as cum_bal,
       sum(tot_cr_postgs) as tot_cr_postgs,
       sum(tot_dr_postgs) as tot_dr_postgs,
       sum(qty) as qty,
       sum(mvmt_for_per) as mvmt_for_per ,
       valut_view,
       ra_vers,
       val_type,
       func_area,
       ptnr_f_area,
       plnt,
       rep_matl,
       pca_actv,
        measure_name,
       measure_code
       FROM itg_pca_trans
       INNER JOIN edw_acct_hier B ON LTRIM (RTRIM (itg_pca_trans.acct_num)) = LTRIM (RTRIM (B.acct_num))
group by 
fisc_yr_per,
       fisc_yr_vrnt,
       fisc_yr,
       pstng_per,
       crncy,
       uom,
       itg_pca_trans.acct_num,
       chrt_of_acct,
       co_cd,
       cntl_area,
       crncy_type,
       ptnr_prft_ctr,
       prft_ctr,
       vers,
       depr_area,
       orig_obj_type,
       trad_ptnr,
       ptnr_co_cd,
       partorobtype_pca,
       obj_cls,
       mvmt_type,
       valut_view,
       ra_vers,
       val_type,
       func_area,
       ptnr_f_area,
       plnt,
       rep_matl,
       pca_actv,
       measure_name,
       measure_code)
select * from final