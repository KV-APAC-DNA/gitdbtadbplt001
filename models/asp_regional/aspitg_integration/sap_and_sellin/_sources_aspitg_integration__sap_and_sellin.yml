version: 2

sources:
  - name: aspsdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: aspsdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: sdl_sap_ecc_material_base

  - name: aspitg_integration
    database: "{{ env_var('DBT_ENV_CORE_DB') }}"
    schema: aspitg_integration
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
    - name : itg_crncy_conv 
    - name : itg_crncy_mult
    - name : itg_ciw_acct_hier_name_mapping
    - name:  itg_otif_glbl_con_reporting
    - name:  itg_query_parameters

  - name: aspwks_integration
    database: "{{ env_var('DBT_ENV_CORE_DB') }}"
    schema: aspwks_integration
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
    - name : sap_transactional_processed_files
    
  - name: aspedw_integration
    database: "{{ env_var('DBT_ENV_CORE_DB') }}"
    schema: aspedw_integration
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: edw_sap_matl_num_ean_mapping
      - name: edw_account_jjplbw_hier
      - name: edw_account_xref
      - name: edw_okr_brand_map
      - name: edw_code_descriptions_manual
      - name: edw_subchnl_retail_env_mapping
      - name: edw_account_ciw_xref

  - name: bwa_access
    freshness:
      error_after:
        count: 24
        period: hour
      filter: _deleted_='F'
    loaded_at_field: _CREATETIME_
    database: "{{ env_var('DBT_ENV_CDL_DB') }}"
    schema: bwa_access
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: bwa_material_attribute
        freshness:
          error_after:
            count: 24
            period: hour
          filter: material <> 'NA' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_cdl_sales
      - name: bwa_copa10
      - name: bwa_cdl_delivery
      - name: bwa_product_hierarchy_text
      - name: bwa_copa17
      - name: bwa_zc_sd
      - name: bwa_customer_sales
      - name: bwa_distribution_channel_text
      - name: bwa_list_price
      - name: bwa_material_uom
      - name: bwa_account_text
      - name: bwa_material_plant
      - name: bwa_plant_text
      - name: bwa_plant_attr      
      - name: bwa_material_sales_text      
      - name: bwa_material_plant_text
      - name: bwa_dna_material_bomlist
      - name: bwa_account_attr
      - name: bwa_material_sales
      - name: bwa_azocalday00
      - name: bwa_mcomp_code
      - name: bwa_mprofit_ctr
        freshness:
          error_after:
            count: 24
            period: hour
          filter: resp_pers <> ' ' and dateto = '99991231' or (profit_ctr in ('0074700707', '0000000799') and resp_pers <> ' ') and  _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_msalesorg
      - name: bwa_tcomp_code
      - name: bwa_tcountry
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tcurr
      - name: bwa_tcustomer
      - name: bwa_tmaterial
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tprofit_ctr
        freshness:
          error_after:
            count: 24
            period: hour
          filter: txtsh <> ' ' and dateto = '99991231' or (profit_ctr in ('0074700707', '0000000799','0000005556','0000500169') and txtsh <> ' ') and  _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tsales_grp
      - name: bwa_tsales_off
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tsalesorg
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tzpcust
      - name: bwa_tzchannel
      - name: bwa_tzschannel
      - name: bwa_tzbannerf
      - name: bwa_tzbanner
      - name: bwa_tzgotomod
      - name: bwa_tzlcus_gr1
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tzlcus_gr2
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tzlcus_gr3
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tzlcus_gr4
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tzlcus_gr5
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tzlcus_gr6
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tzlcus_gr7
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tzlcus_gr8
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tzneed
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_tzstrong
        freshness:
          error_after:
            count: 24
            period: hour
          filter: LANGU = 'E' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_material_type_text
      - name: bwa_cdl_billing
      - name: bwa_inventory
        freshness:
          error_after:
            count: 24
            period: hour
          filter: loc_currcy != 'LOC_CURRCY' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: bwa_cdl_billing_cond
        
  - name: apc_access
    freshness:
      error_after:
        count: 24
        period: hour
      filter: _deleted_='F'
    loaded_at_field: _CREATETIME_
    database: "{{ env_var('DBT_ENV_CDL_DB') }}"
    schema: apc_access
    quoting:
      database: false
      schema: false
      identifier: false
    tables: 
      - name: apc_knvv
      - name: apc_knvp
      - name: apc_marm
        freshness:
          error_after:
            count: 24
            period: hour
          filter: mandt='888' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: apc_mbew
        freshness:
          error_after:
            count: 24
            period: hour
          filter: mandt='888' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: apc_mbewh
        freshness:
          error_after:
            count: 24
            period: hour
          filter: mandt='888' and _deleted_='F'
        loaded_at_field: _CREATETIME_
      - name: apc_tvm1t
        freshness:
          error_after:
            count: 24
            period: hour
          filter: spras = 'E' and _deleted_='F' and mandt='888'
        loaded_at_field: _CREATETIME_
      - name: apc_tvm2t
        freshness:
          error_after:
            count: 24
            period: hour
          filter: spras = 'E' and _deleted_='F' and mandt='888'
        loaded_at_field: _CREATETIME_
      - name: apc_tvm3t
        freshness:
          error_after:
            count: 24
            period: hour
          filter: spras = 'E' and _deleted_='F' and mandt='888'
        loaded_at_field: _CREATETIME_
      - name: apc_tvm4t
        freshness:
          error_after:
            count: 24
            period: hour
          filter: spras = 'E' and _deleted_='F' and mandt='888'
        loaded_at_field: _CREATETIME_
      - name: apc_tvm5t
        freshness:
          error_after:
            count: 24
            period: hour
          filter: spras = 'E' and _deleted_='F' and mandt='888'
        loaded_at_field: _CREATETIME_
      - name: apc_mara
      - name: apc_ztranfran
      - name: apc_ztranbrand
      - name: apc_ztransbrand
      - name: apc_ztranvariant
      - name: apc_ztransvariant
      - name: apc_ztranflav
      - name: apc_ztraningr
      - name: apc_ztranappl
      - name: apc_ztranleng
      - name: apc_ztranshape
      - name: apc_ztranspf
      - name: apc_ztrancover
      - name: apc_ztranform
      - name: apc_ztransize
      - name: apc_ztranchar
      - name: apc_ztranpack
      - name: apc_ztranattrib13
      - name: apc_ztranattrib14
      - name: apc_ztransku
      - name: apc_ztranrelabel
      - name: apc_kna1
        freshness:
          error_after:
            count: 24
            period: hour
          filter: mandt='888'
        loaded_at_field: _CREATETIME_
  - name: mds_access
    database: "{{ env_var('DBT_ENV_CDL_DB') }}"
    schema: mds_access
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: mds_gcph_brand
      - name: mds_gcgh_geographyhierarchy
      - name: mds_gcch_gcgh_hierarchy
      - name: mds_gcph_category