with  
source as (

    select * from {{ source('apc_access', 'apc_kna1') }}
),
final as (
    select
        trim(mandt) as mandt,
        trim(kunnr) as kunnr,
        trim(adrnr) as adrnr,
        trim(anred) as anred,
        trim(aufsd) as aufsd,
        trim(bahne) as bahne,
        trim(bahns) as bahns,
        bbbnr::number as bbbnr,
        bbsnr::number as bbsnr,
        trim(begru) as begru,
        trim(brsch) as brsch,
        bubkz::number as bubkz,
        trim(datlt) as datlt,
        try_to_date(erdat,'YYYYMMDD') as erdat,
        trim(ernam) as ernam,
        trim(exabl) as exabl,
        trim(faksd) as faksd,
        trim(fiskn) as fiskn,
        trim(knazk) as knazk,
        trim(knrza) as knrza,
        trim(konzs) as konzs,
        trim(ktokd) as ktokd,
        trim(kukla) as kukla,
        trim(land1) as land1,
        trim(lifnr) as lifnr,
        trim(lifsd) as lifsd,
        trim(locco) as locco,
        trim(loevm) as loevm,
        trim(name1) as name1,
        trim(name2) as name2,
        trim(name3) as name3,
        trim(name4) as name4,
        trim(niels) as niels,
        trim(ort01) as ort01,
        trim(ort02) as ort02,
        trim(pfach) as pfach,
        trim(pstl2) as pstl2,
        trim(pstlz) as pstlz,
        trim(regio) as regio,
        trim(counc) as counc,
        trim(cityc) as cityc,
        trim(rpmkr) as rpmkr,
        trim(sortl) as sortl,
        trim(sperr) as sperr,
        trim(spras) as spras,
        trim(stcd1) as stcd1,
        trim(stcd2) as stcd2,
        trim(stkza) as stkza,
        trim(stkzu) as stkzu,
        trim(stras) as stras,
        trim(telbx) as telbx,
        trim(telf1) as telf1,
        trim(telf2) as telf2,
        trim(telfx) as telfx,
        trim(teltx) as teltx,
        trim(telx1) as telx1,
        trim(lzone) as lzone,
        trim(xcpdk) as xcpdk,
        trim(xzemp) as xzemp,
        trim(vbund) as vbund,
        trim(stceg) as stceg,
        trim(dear1) as dear1,
        trim(dear2) as dear2,
        trim(dear3) as dear3,
        trim(dear4) as dear4,
        trim(dear5) as dear5,
        trim(dear6) as dear6,
        trim(gform) as gform,
        trim(bran1) as bran1,
        trim(bran2) as bran2,
        trim(bran3) as bran3,
        trim(bran4) as bran4,
        trim(bran5) as bran5,
        trim(ekont) as ekont,
        trim(umsat) as umsat,
        umjah::number as umjah,
        trim(uwaer) as uwaer,
        jmzah::number as jmzah,
        jmjah::number as jmjah,
        trim(katr1) as katr1,
        trim(katr2) as katr2,
        trim(katr3) as katr3,
        trim(katr4) as katr4,
        trim(katr5) as katr5,
        trim(katr6) as katr6,
        trim(katr7) as katr7,
        trim(katr8) as katr8,
        trim(katr9) as katr9,
        trim(katr10) as katr10,
        trim(stkzn) as stkzn,
        trim(umsa1) as umsa1,
        trim(txjcd) as txjcd,
        trim(mcod1) as mcod1,
        trim(mcod2) as mcod2,
        trim(mcod3) as mcod3,
        trim(periv) as periv,
        trim(abrvw) as abrvw,
        trim(inspbydebi) as inspbydebi,
        trim(inspatdebi) as inspatdebi,
        trim(ktocd) as ktocd,
        trim(pfort) as pfort,
        trim(werks) as werks,
        trim(dtams) as dtams,
        trim(dtaws) as dtaws,
        trim(duefl) as duefl,
        hzuor::number as hzuor,
        trim(sperz) as sperz,
        trim(etikg) as etikg,
        trim(civve) as civve,
        trim(milve) as milve,
        trim(kdkg1) as kdkg1,
        trim(kdkg2) as kdkg2,
        trim(kdkg3) as kdkg3,
        trim(kdkg4) as kdkg4,
        trim(kdkg5) as kdkg5,
        trim(xknza) as xknza,
        trim(fityp) as fityp,
        trim(stcdt) as stcdt,
        trim(stcd3) as stcd3,
        trim(stcd4) as stcd4,
        trim(xicms) as xicms,
        trim(xxipi) as xxipi,
        trim(xsubt) as xsubt,
        trim(cfopc) as cfopc,
        trim(txlw1) as txlw1,
        trim(txlw2) as txlw2,
        trim(ccc01) as ccc01,
        trim(ccc02) as ccc02,
        trim(ccc03) as ccc03,
        trim(ccc04) as ccc04,
        trim(cassd) as cassd,
        trim(knurl) as knurl,
        current_timestamp()::timestamp_ntz(9) as crt_dttm,
        current_timestamp()::timestamp_ntz(9) as updt_dttm
    from source
    where mandt='888'
)

select * from final  