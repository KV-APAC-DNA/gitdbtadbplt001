with source as (

    select * from {{ source('bwa_access', 'bwa_material_plant') }}

),

final as (
    select
        coalesce(trim(plant),'') as plant,
        coalesce(trim(mat_plant),'') as mat_plant,
        coalesce(abckey,'') as abckey,
        coalesce(del_flag,'') as del_flag,
        coalesce(dismm,'') as dismm,
        coalesce(gr_pr_time,'') as gr_pr_time,
        coalesce(mrp_contrl,'') as mrp_contrl,
        coalesce(stge_pd_un,'') as stge_pd_un,
        coalesce(plnd_delry,'') as plnd_delry,
        coalesce(prodsched,'') as prodsched,
        coalesce(co_area,'') as co_area,
        coalesce(profit_ctr,'') as profit_ctr,
        coalesce(pur_group,'') as pur_group,
        coalesce(replentime,'') as replentime,
        coalesce(rpa_qtyuom,'') as rpa_qtyuom,
        coalesce(base_uom,'') as base_uom,
        coalesce(country,'') as country,
        coalesce(val_class,'') as val_class,
        coalesce(currency,'') as currency,
        coalesce(g_avv040,'') as g_avv040,
        coalesce(bic_zsproctyp,'') as zsproctyp,
        coalesce(bic_zminlot,'') as zminlot,
        coalesce(bic_zrndgval,'') as zrndgval,
        coalesce(material,'') as material,
        coalesce(vendor,'') as vendor,
        coalesce(bic_zproctyp,'') as zproctyp,
        coalesce(bic_zprdcssor,'') as zprdcssor,
        coalesce(bic_zbaseqtyb,'') as zbaseqtyb,
        coalesce(bic_zcostlotb,'') as zcostlotb,
        coalesce(bic_zladgr,'') as zladgr,
        coalesce(bic_zitark,'') as zitark,
        coalesce(bic_zavl_chk,'') as zavl_chk,
        coalesce(bic_zmmppstat,'') as zmmppstat,
        coalesce(bic_zkautb,'') as zkautb,
        coalesce(stocktype,'') as stocktype,
        coalesce(bic_zsrlt_ind,'') as zsrlt_ind,
        coalesce(bic_zusequ,'') as zusequ,
        coalesce(bic_zdisgr,'') as zdisgr,
        coalesce(bic_zreord,'') as zreord,
        coalesce(bic_zfxhor,'') as zfxhor,
        coalesce(bic_zlfrhy,'') as zlfrhy,
        coalesce(bic_zlotsz,'') as zlotsz,
        coalesce(bic_zbstma,'') as zbstma,
        coalesce(bic_zbstfe,'') as zbstfe,
        coalesce(bic_zmabst,'') as zmabst,
        coalesce(bic_ztakzt,'') as ztakzt,
        coalesce(bic_zkzech,'') as zkzech,
        coalesce(bic_zlgpro,'') as zlgpro,
        coalesce(bic_zrgekz,'') as zrgekz,
        coalesce(bic_zlgfsb,'') as zlgfsb,
        coalesce(bic_zplan_cal,'') as zplan_cal,
        coalesce(bic_zfhori,'') as zfhori,
        coalesce(eisbe_qty,'') as eisbe_qty,
        coalesce(bic_zrwpro,'') as zrwpro,
        coalesce(bic_zper_ind,'') as zper_ind,
        coalesce(bic_zstrgr,'') as zstrgr,
        coalesce(bic_zvrmod,'') as zvrmod,
        coalesce(bic_zvint1,'') as zvint1,
        coalesce(bic_zvint2,'') as zvint2,
        coalesce(bic_zaltsl,'') as zaltsl,
        coalesce(bic_zfrtme,'') as zfrtme,
        coalesce(bic_zsfcpf,'') as zsfcpf,
        coalesce(undelivtol,'') as undelivtol,
        coalesce(ovdelivtol,'') as ovdelivtol,
        coalesce(bic_zausme,'') as zausme,
        coalesce(bic_zabcin,'') as zabcin,
        coalesce(bic_zins_int,'') as zins_int,
        coalesce(bic_zssqss,'') as zssqss,
        coalesce(bic_zcert_typ,'') as zcert_typ,
        coalesce(bic_zqssys,'') as zqssys,
        coalesce(bic_zsobsk,'') as zsobsk,
        coalesce(bic_zawsls,'') as zawsls,
        coalesce(price_ctrl,'') as price_ctrl,
        coalesce(price_avg,'') as price_avg,
        coalesce(bic_zdevalind,'') as zdevalind,
        coalesce(bic_zekalr,'') as zekalr,
        coalesce(origingrp,'') as origingrp,
        coalesce(bic_zorig_ind,'') as zorig_ind,
        coalesce(bic_zpln_prc,'') as zpln_prc,
        coalesce(bic_zpln_prc1,'') as zpln_prc1,
        try_to_date(bic_zpprc1dat,'yyyymmdd') as zpprc1dat,
        coalesce(bic_zkosgr,'') as zkosgr,
        coalesce(price_unit,'') as price_unit,
        coalesce(bic_zmrp_ctl,'') as zmrp_ctl,
        try_to_date(bic_zlaunchd,'yyyymmdd') as zlaunchd,
        coalesce(bic_znpi_ind,'') as znpi_ind,
        coalesce(bic_zprv_prc,'') as zprv_prc,
        coalesce(bic_zpln_prc2,'') as zpln_prc2,
        try_to_date(bic_zpprc2dat,'yyyymmdd') as zpprc2dat,
        coalesce(bic_zpln_prc3,'') as zpln_prc3,
        try_to_date(bic_zpprc3dat,'yyyymmdd') as zpprc3dat,
        iff(bic_zlaunchw='00000000',0,bic_zlaunchw) as zlaunchw,
        iff(bic_zlaunchmt='00000000',0,bic_zlaunchmt) as zlaunchmt,
        coalesce(bic_zskuseg,'') as zskuseg,
        coalesce(bic_zsuccecsr,'') as zsuccecsr,
        coalesce(bic_zsui_ind,'') as zsui_ind,
        coalesce(bic_ztmarkup,'') as ztmarkup,
        bic_zimarkup::number(10) as zimarkup,
        coalesce(bic_zmdactind,'') as zmdactind,
        coalesce(bic_zsnp_plnr,'') as zsnp_plnr,
        coalesce(bic_ztrp_plnr,'') as ztrp_plnr,
        coalesce(bic_ztlb_swch,'') as ztlb_swch,
        coalesce(bic_zmin_stck,'') as zmin_stck,
        coalesce(bic_zmax_stck,'') as zmax_stck,
        coalesce(bic_zrfs_ind,'') as zrfs_ind,
        coalesce(bic_zexpiry,'') as zexpiry,
        coalesce(bic_zdmd_plnr,'') as zdmd_plnr,
        coalesce(bic_zdmd_prof,'') as zdmd_prof,
        coalesce(bic_zday_supl,'') as zday_supl,
        coalesce(bic_zmin_shlf,'') as zmin_shlf,
        coalesce(bic_zgi_prcet,'') as zgi_prcet,
        coalesce(bic_zppds_hzn,'') as zppds_hzn,
        coalesce(bic_zserv_lev,'') as zserv_lev,
        coalesce(bic_zzncost,'') as zzncost,
        try_to_date(bic_zmmstd,'yyyymmdd') as zmmstd,
        coalesce(bic_zpstat,'') as zpstat,
        coalesce(bic_zrondval,'') as zrondval,
        coalesce(bic_zsnpph,'') as zsnpph,
        coalesce(bic_zsnpphp,'') as zsnpphp,
        coalesce(bic_zsstkres,'') as zsstkres,
        coalesce(bic_zstkth,'') as zstkth,
        coalesce(bic_zstkthp,'') as zstkthp,
        coalesce(bic_zreglic,'') as zreglic,
        coalesce(bic_zmsdpsbm,'') as zmsdpsbm,
        coalesce(bic_zschkhor,'') as zschkhor,
        coalesce(bic_zreqctyp,'') as zreqctyp,
        coalesce(bic_zreqcflg,'') as zreqcflg,
        coalesce(bic_zpegpmax,'') as zpegpmax,
        coalesce(bic_zdplpu,'') as zdplpu,
        coalesce(bic_zdplfsso,'') as zdplfsso,
        coalesce(bic_zdplfsfc,'') as zdplfsfc,
        coalesce(bic_zatdsp,'') as zatdsp,
        coalesce(bic_zatddm,'') as zatddm,
        coalesce(bic_zpegstatg,'') as zpegstatg,
        coalesce(bic_zfedem,'') as zfedem,
        coalesce(bic_zdplfs,'') as zdplfs,
        coalesce(bic_zsnppullh,'') as zsnppullh,
        coalesce(bic_zsnppushh,'') as zsnppushh,
        coalesce(apo_prdcst,'') as apo_prdcst,
        coalesce(bic_zfutmax,'') as zfutmax,
        coalesce(bic_zpastmax,'') as zpastmax,
        coalesce(apo_scost,'') as apo_scost,
        coalesce(unit,'') as unit,
        apo_bstfe::number(10) as apo_bstfe,
        coalesce(apo_lsexct,'') as apo_lsexct,
        coalesce(bic_zpervr,'') as zpervr,
        coalesce(apo_numper,'') as apo_numper,
        coalesce(bic_zppdshozn,'') as zppdshozn,
        coalesce(bic_zz_expiry,'') as zz_expiry,
        coalesce(apo_pplnnr,'') as apo_pplnnr,
        coalesce(bic_zsnpshipf,'') as zsnpshipf,
        coalesce(bic_zlapen,'') as zlapen,
        coalesce(bic_zmaxla,'') as zmaxla,
        bic_zndpen::number(10) as zndpen,
        coalesce(bic_zprodh,'') as zprodh,
        coalesce(bic_znpi_indr,'') as znpi_indr,
        coalesce(bic_zkstdcst,'') as zkstdcst,
        try_to_date(id_credat,'yyyymmdd') as id_credat,
        coalesce(bic_zprdtype,'') as zprdtype,
        coalesce(bic_zparent,'') as zparent,
        coalesce(bic_zcpy_hist,'') as zcpy_hist,
        coalesce(bic_zabc,'') as zabc,
        coalesce(bic_zfc_indc,'') as zfc_indc,
        coalesce(bic_zjitind,'') as zjitind,
        coalesce(bic_zrpltm_s,'') as zrpltm_s,
        coalesce(bic_zminstk_s,'') as zminstk_s,
        coalesce(bic_zmaxstk_s,'') as zmaxstk_s,
        coalesce(bic_zdayspl_s,'') as zdayspl_s,
        coalesce(bic_zservlv_s,'') as zservlv_s,
        coalesce(bic_zfedem_s,'') as zfedem_s,
        coalesce(fiscvarnt,'') as fiscvarnt,
        coalesce(bic_zcostyear,'') as zcostyear,
        coalesce(bic_zfutstpr,'') as zfutstpr,
        current_timestamp()::timestamp_ntz(9) as crt_dttm,
        current_timestamp()::timestamp_ntz(9) as updt_dttm
    from source
    where _deleted_='F'
)

select * from final
