with sdl_PROX_MD_Theme as(
    select * from {{ source('aspsdl_raw', 'sdl_prox_md_theme') }}
    where filename not in (
        select distinct file_name from {{source('aspwks_integration','TRATBL_ssdl_prox_md_theme____null_test')}}
    )
),
final as(
SELECT 
ID::VARCHAR(50) as ID,
THEMECODE::VARCHAR(50) as THEMECODE,
THEMENAME::VARCHAR(1000) as THEMENAME,
EXPENSESUBCATEGORY::VARCHAR(50) as EXPENSESUBCATEGORY,
EXPENSETYPECODE::VARCHAR(50) as EXPENSETYPECODE,
CREATEUSERID::VARCHAR(50) as CREATEUSERID,
STATUS::VARCHAR(50) as STATUS,
CREATETIME::TIMESTAMP_NTZ(9) as CREATETIME,
LASTMODIFYTIME::TIMESTAMP_NTZ(9) as LASTMODIFYTIME,
LASTMODIFYUSERID::VARCHAR(50) as LASTMODIFYUSERID,
APPLICATIONID::VARCHAR(50) as APPLICATIONID,
FILENAME::VARCHAR(100) as FILENAME,
RUN_ID::VARCHAR(50) as RUN_ID,
CRT_DTTM::TIMESTAMP_NTZ(9) as CRT_DTTM
FROM sdl_PROX_MD_Theme)
select * from final

