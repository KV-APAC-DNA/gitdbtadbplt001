version: 2

sources:
  - name: aspsdl_raw
    database: "{{ env_var('DBT_ENV_LOAD_DB') }}"
    schema: aspsdl_raw
    quoting:
      database: false
      schema: false
      identifier: false
    tables:
      - name: sdl_mds_apac_dcl_customers
        tags: ["mds","travel_retail_mds"]
        tests:
          - test_null:
              not_null_columns: ["cust_num","ctry_key_code","retailer_name_code","location_name","sales_location_name","sales_channel_name"]
              select_columns: ["cust_num","ctry_key_code","retailer_name_code","location_name","sales_location_name","sales_channel_name"]
              name: TRATBL_sdl_mds_apac_dcl_customers_null_test
              config:
                store_failures: true
                schema: aspwks_integration
          - test_duplicate:
              group_by_columns: ["cust_num","ctry_key_code","retailer_name_code","location_name","sales_location_name","sales_channel_name"]
              select_columns: ["cust_num","ctry_key_code","retailer_name_code","location_name","sales_location_name","sales_channel_name"] 
              name: TRATBL_sdl_mds_apac_dcl_customers_duplicate_test
              config:
                store_failures: true
                schema: aspwks_integration
      - name: sdl_mds_apac_dcl_products
        tags: ["mds","travel_retail_mds"]
        tests:
          - test_null:
              not_null_columns: ["country_code",'"dcl code"','"sap code"','"sales channel_name"']
              name: TRATBL_sdl_mds_apac_dcl_products_null_test
              config:
                store_failures: true
                schema: aspwks_integration
          - test_duplicate:
              group_by_columns: ["country_code",'"dcl code"','"sales channel_name"']
              select_columns: ["country_code",'"dcl code"','"sales channel_name"'] 
              name: TRATBL_sdl_mds_apac_dcl_products_duplicate_test
              config:
                store_failures: true
                schema: aspwks_integration
      - name: sdl_mds_apac_dcl_targets
        tags: ["mds","travel_retail_mds"]
        tests:
          - test_null:
              not_null_columns: ["target_type_code","country_code","sales_channel_name","year_code"]
              name: TRATBL_sdl_mds_apac_dcl_targets_null_test
              config:
                store_failures: true
                schema: aspwks_integration
          - test_duplicate:
              group_by_columns: ["target_type_code","country_code","sales_channel_name","year_code"]
              select_columns: ["target_type_code","country_code","sales_channel_name","year_code"] 
              name: TRATBL_sdl_mds_apac_dcl_targets_duplicate_test
              config:
                store_failures: true
                schema: aspwks_integration
      - name: sdl_mds_ap_greenlight_skus
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_ap_company_dim
        tags: ["mds","rg_mds_dna"]
      - name: sdl_rg_mds_log
        tags: ["mds","rg_mds_dna","travel_retail_mds"]
      - name: sdl_mds_ap_dso
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_ap_otif
        tags: ["mds","rg_mds_dna"]   
      - name: sdl_mds_ap_sales_ops_map
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_ap_ecom_oneview_config
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_rg_ecom_plan
        tags: ["mds","rg_mds_dna"]
        tests:
          - test_null:
              not_null_columns: ["cluster","country","sub_country","fisc_month","fisc_year","franchise","type","target_ori"]
              name: TRATBL_sdl_mds_rg_ecom_plan_null_test
              config:
                store_failures: true
                schema: aspwks_integration
          - test_duplicate:
              group_by_columns: ["cluster","country","sub_country","fisc_month","fisc_year","franchise","type"]
              select_columns: ["cluster","country","sub_country","fisc_month","fisc_year","franchise","type","target_ori"]
              name: TRATBL_sdl_mds_rg_ecom_plan_duplicate_test
              config:
                store_failures: true
                schema: aspwks_integration
      - name: sdl_mds_rg_profit_center_franchise_mapping
        tags: ["mds","rg_mds_dna"]
        tests:
          - test_null:
              not_null_columns: ["prod_minor","profit_center","prod_minor_desc","need_state","franchise_l1"]
              name: TRATBL_sdl_mds_rg_profit_center_franchise_mapping_null_test
              config:
                store_failures: true
                schema: aspwks_integration
          - test_duplicate:
              group_by_columns: ["prod_minor","profit_center","prod_minor_desc","need_state","franchise_l1"]
              need_counts: no
              name: TRATBL_sdl_mds_rg_profit_center_franchise_mapping_duplicate_test
              config:
                store_failures: true
                schema: aspwks_integration
      - name: sdl_mds_rg_ps_market_coverage
        tags: ["mds","rg_mds_dna"]
        tests:
          - test_null:
              not_null_columns: ["name", "channel", "coverage"]
              name: TRATBL_sdl_mds_rg_ps_market_coverage_null_test
              config:
                store_failures: true
                schema: aspwks_integration
          - test_duplicate:
              group_by_columns: ["name","channel"]
              select_columns: ["name","channel","coverage"] 
              name: TRATBL_sdl_mds_rg_ps_market_coverage_duplicate_test
              config:
                store_failures: true
                schema: aspwks_integration
      - name: sdl_mds_rg_ecom_digital_shelf_customer_mapping
        tags: ["mds","rg_mds_dna"]
        tests:
          - test_null:
              not_null_columns: ["market", "online_store"]
              name: TRATBL_sdl_mds_rg_ecom_digital_shelf_customer_mapping_null_test
              config:
                store_failures: true
                schema: aspwks_integration
          - test_duplicate:
              group_by_columns: ["market", "online_store"]
              need_counts: no 
              name: TRATBL_sdl_mds_rg_ecom_digital_shelf_customer_mapping_duplicate_test
              config:
                store_failures: true
                schema: aspwks_integration
      - name: sdl_mds_rg_tih_distributor_closure
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_rg_sfmc_gender
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_rg_sfmc_attributes
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_ap_price_tracker_category_mapping
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_rg_ecom_digital_salesweight
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_ap_okr_actuals
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_ap_okr_targets
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_ap_customer360_config
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_ap_profit_center_ppm
        tags: ["mds","rg_mds_dna"]
      - name: sdl_mds_ap_pre_apsc_master
        tags: ["mds","rg_mds_dna"] 