
with sdl_hcp_osea_mc_cycle_plan_summary
as
(
select * from {{ source('hcposesdl_raw', 'sdl_hcp_osea_mc_cycle_plan_summary') }}
)
,
transformed as
(
select 
MC_CYCLE_PLAN_SUMMARY_ID,
 (CASE WHEN UPPER(IS_DELETED) = 'TRUE' THEN 1 WHEN UPPER(IS_DELETED) IS NULL THEN 0 WHEN UPPER(IS_DELETED) = ' ' THEN 0 ELSE 0 END) AS IS_DELETED,
CYCLE_NAME_SUMMARY,
RECORD_TYPE_ID,
CREATED_DATE,
CREATED_BY_ID,
LAST_MODIFIED_DATE,
LAST_MODIFIED_BY_ID,
SYSTEM_MODSTAMP,
MAY_EDIT,
CASE WHEN UPPER(IS_LOCKED) = 'TRUE' THEN 1 WHEN UPPER(IS_LOCKED) = 'FALSE' THEN 0 ELSE 0 END AS IS_LOCKED,	          
CYCLE_PLAN,
ATTAINMENT,
CHANNEL,
INTERACTIONS_EARNED,
INTERACTIONS_GOAL,
LAST_CALCULATED,
PERCENT_OF_ALL_GOALS,
PRODUCT,
SUMMARY_FOR,
VEEVA_EXTERNAL_ID,
DETAIL_GROUP,
STATUS,
TEAM_ATTAINMENT,
TEAM_INTERACTIONS_EARNED,
TEAM_INTERACTIONS_GOAL,
TEAM_STATUS,
LEGACY_ID,
ACTUAL_CALL,
current_timestamp() as INSERTED_DATE,
       NULL as UPDATED_DATE 
from sdl_hcp_osea_mc_cycle_plan_summary
)
,
final as
(select 
	MC_CYCLE_PLAN_SUMMARY_ID::VARCHAR(18) AS MC_CYCLE_PLAN_SUMMARY_ID,
IS_DELETED::NUMBER(38,0) AS IS_DELETED,
CYCLE_NAME_SUMMARY::VARCHAR(255) AS CYCLE_NAME_SUMMARY,
RECORD_TYPE_ID::VARCHAR(18) AS RECORD_TYPE_ID,
CREATED_DATE::TIMESTAMP_NTZ(9) AS CREATED_DATE,
CREATED_BY_ID::VARCHAR(18) AS CREATED_BY_ID,
LAST_MODIFIED_DATE::TIMESTAMP_NTZ(9) AS LAST_MODIFIED_DATE,
LAST_MODIFIED_BY_ID::VARCHAR(18) AS LAST_MODIFIED_BY_ID,
SYSTEM_MODSTAMP::TIMESTAMP_NTZ(9) AS SYSTEM_MODSTAMP,
MAY_EDIT::VARCHAR(10) AS MAY_EDIT,
IS_LOCKED::NUMBER(38,0) AS IS_LOCKED,
CYCLE_PLAN::VARCHAR(40) AS CYCLE_PLAN,
ATTAINMENT::NUMBER(15,1) AS ATTAINMENT,
CHANNEL::VARCHAR(40) AS CHANNEL,
INTERACTIONS_EARNED::NUMBER(9,2) AS INTERACTIONS_EARNED,
INTERACTIONS_GOAL::NUMBER(9,2) AS INTERACTIONS_GOAL,
LAST_CALCULATED::TIMESTAMP_NTZ(9) AS LAST_CALCULATED,
PERCENT_OF_ALL_GOALS::NUMBER(3,0) AS PERCENT_OF_ALL_GOALS,
PRODUCT::VARCHAR(50) AS PRODUCT,
SUMMARY_FOR::VARCHAR(1300) AS SUMMARY_FOR,
VEEVA_EXTERNAL_ID::VARCHAR(100) AS VEEVA_EXTERNAL_ID,
DETAIL_GROUP::VARCHAR(100) AS DETAIL_GROUP,
STATUS::VARCHAR(50) AS STATUS,
TEAM_ATTAINMENT::NUMBER(15,1) AS TEAM_ATTAINMENT,
TEAM_INTERACTIONS_EARNED::NUMBER(9,2) AS TEAM_INTERACTIONS_EARNED,
TEAM_INTERACTIONS_GOAL::NUMBER(9,2) AS TEAM_INTERACTIONS_GOAL,
TEAM_STATUS::VARCHAR(100) AS TEAM_STATUS,
LEGACY_ID::VARCHAR(255) AS LEGACY_ID,
ACTUAL_CALL::VARCHAR(18) AS ACTUAL_CALL,
	inserted_date::timestamp_ntz(9) as inserted_date,
	updated_date::timestamp_ntz(9) as updated_date
	from transformed
)

select * from final 
