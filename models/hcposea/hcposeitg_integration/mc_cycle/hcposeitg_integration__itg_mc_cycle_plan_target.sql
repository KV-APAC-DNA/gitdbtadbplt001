
with sdl_hcp_osea_mc_cycle_plan_target
as
(
select * from {{ source('hcposesdl_raw', 'sdl_hcp_osea_mc_cycle_plan_target') }}
)
,
transformed as
(
select 
MC_CYCLE_PLAN_TARGET_ID,
(CASE WHEN UPPER(IS_DELETED) = 'TRUE' THEN 1 WHEN UPPER(IS_DELETED) IS NULL THEN 0 WHEN UPPER(IS_DELETED) = ' ' THEN 0 ELSE 0 END) AS IS_DELETED,
CYCLE_PLAN_TARGET,
RECORD_TYPE_ID,
CREATED_DATE,
CREATED_BY_ID,
LAST_MODIFIED_DATE,
LAST_MODIFIED_BY_ID,
SYSTEM_MODSTAMP,
MAY_EDIT,
CASE WHEN UPPER(IS_LOCKED) = 'TRUE' THEN 1 WHEN UPPER(IS_LOCKED) = 'FALSE' THEN 0 ELSE 0 END AS IS_LOCKED,	          
CYCLE_PLAN,
CHANNEL_ATTAINMENT,
CHANNEL_INTERACTIONS_ACTUAL,
CHANNEL_INTERACTIONS_EARNED,
CHANNEL_INTERACTIONS_GOAL,
CHANNEL_INTERACTIONS_MAX,
CHANNEL_INTERACTIONS_REMAINING,
CHANNEL_STATUS,
EXTERNAL_ID,
LAST_CALCULATED,
PRODUCT_ATTAINMENT,
PRODUCT_INTERACTIONS_EARNED,
PRODUCT_INTERACTIONS_GOAL,
PRODUCT_STATUS,
STATUS,
TARGET,
VEEVA_EXTERNAL_ID,
TEAM_CHANNEL_ATTAINMENT,
TEAM_CHANNEL_INTERACTIONS_ACTUAL,
TEAM_CHANNEL_INTERACTIONS_EARNED,
TEAM_CHANNEL_INTERACTIONS_GOAL,
TEAM_CHANNEL_INTERACTIONS_MAX,
TEAM_CHANNEL_INTERACTIONS_REMAINING,
TEAM_CHANNEL_STATUS,
TEAM_PRODUCT_ATTAINMENT,
TEAM_PRODUCT_INTERACTIONS_EARNED,
TEAM_PRODUCT_INTERACTIONS_GOAL,
TEAM_PRODUCT_STATUS,
GOALS_EDITED,
CHILD_ACCOUNT,
FURIGANA,
LOCATION,
PARENT_CHILD_NAME,
LAST_CYCLE_PROGRESS_GENERATED,
MASTER_ALIGN_ID,
COUNTRY_CODE,
LEGACY_ID,
CHANNEL_ACTUAL_ACHIEVEMENT,
MC_CYCLE_PLAN_ID18,
MC_CYCLE_PLAN_TARGET_ID18,
OWNER_MANAGER,
TARGET_ID18,
PRIMARY_PARENT_NAME,
SPECIALTY,
CITY,
NEW_CHANNEL_INTERACTIONS_GOALS,
NEW_PRODUCT_INTERACTIONS_GOALS,
current_timestamp() as INSERTED_DATE,
       NULL as UPDATED_DATE 
from sdl_hcp_osea_mc_cycle_plan_target
)
,
final as
(select 
	MC_CYCLE_PLAN_TARGET_ID::VARCHAR(18) AS MC_CYCLE_PLAN_TARGET_ID,
    IS_DELETED::NUMBER(38,0) AS IS_DELETED,
CYCLE_PLAN_TARGET::VARCHAR(255) AS CYCLE_PLAN_TARGET,
RECORD_TYPE_ID::VARCHAR(18) AS RECORD_TYPE_ID,
CREATED_DATE::TIMESTAMP_NTZ(9) AS CREATED_DATE,
CREATED_BY_ID::VARCHAR(18) AS CREATED_BY_ID,
LAST_MODIFIED_DATE::TIMESTAMP_NTZ(9) AS LAST_MODIFIED_DATE,
LAST_MODIFIED_BY_ID::VARCHAR(18) AS LAST_MODIFIED_BY_ID,
SYSTEM_MODSTAMP::TIMESTAMP_NTZ(9) AS SYSTEM_MODSTAMP,
MAY_EDIT::VARCHAR(10) AS MAY_EDIT,
IS_LOCKED::NUMBER(38,0) AS IS_LOCKED,
CYCLE_PLAN::VARCHAR(50) AS CYCLE_PLAN,
CHANNEL_ATTAINMENT::NUMBER(18,1) AS CHANNEL_ATTAINMENT,
CHANNEL_INTERACTIONS_ACTUAL::NUMBER(18,1) AS CHANNEL_INTERACTIONS_ACTUAL,
CHANNEL_INTERACTIONS_EARNED::NUMBER(18,1) AS CHANNEL_INTERACTIONS_EARNED,
CHANNEL_INTERACTIONS_GOAL::NUMBER(18,1) AS CHANNEL_INTERACTIONS_GOAL,
CHANNEL_INTERACTIONS_MAX::NUMBER(18,1) AS CHANNEL_INTERACTIONS_MAX,
CHANNEL_INTERACTIONS_REMAINING::NUMBER(18,1) AS CHANNEL_INTERACTIONS_REMAINING,
CHANNEL_STATUS::VARCHAR(100) AS CHANNEL_STATUS,
EXTERNAL_ID::VARCHAR(100) AS EXTERNAL_ID,
LAST_CALCULATED::TIMESTAMP_NTZ(9) AS LAST_CALCULATED,
PRODUCT_ATTAINMENT::NUMBER(18,3) AS PRODUCT_ATTAINMENT,
PRODUCT_INTERACTIONS_EARNED::NUMBER(18,1) AS PRODUCT_INTERACTIONS_EARNED,
PRODUCT_INTERACTIONS_GOAL::NUMBER(18,1) AS PRODUCT_INTERACTIONS_GOAL,
PRODUCT_STATUS::VARCHAR(40) AS PRODUCT_STATUS,
STATUS::VARCHAR(100) AS STATUS,
TARGET::VARCHAR(100) AS TARGET,
VEEVA_EXTERNAL_ID::VARCHAR(100) AS VEEVA_EXTERNAL_ID,
TEAM_CHANNEL_ATTAINMENT::NUMBER(18,3) AS TEAM_CHANNEL_ATTAINMENT,
TEAM_CHANNEL_INTERACTIONS_ACTUAL::NUMBER(18,1) AS TEAM_CHANNEL_INTERACTIONS_ACTUAL,
TEAM_CHANNEL_INTERACTIONS_EARNED::NUMBER(18,1) AS TEAM_CHANNEL_INTERACTIONS_EARNED,
TEAM_CHANNEL_INTERACTIONS_GOAL::NUMBER(18,1) AS TEAM_CHANNEL_INTERACTIONS_GOAL,
TEAM_CHANNEL_INTERACTIONS_MAX::NUMBER(18,1) AS TEAM_CHANNEL_INTERACTIONS_MAX,
TEAM_CHANNEL_INTERACTIONS_REMAINING::NUMBER(18,1) AS TEAM_CHANNEL_INTERACTIONS_REMAINING,
TEAM_CHANNEL_STATUS::VARCHAR(40) AS TEAM_CHANNEL_STATUS,
TEAM_PRODUCT_ATTAINMENT::NUMBER(18,1) AS TEAM_PRODUCT_ATTAINMENT,
TEAM_PRODUCT_INTERACTIONS_EARNED::NUMBER(18,1) AS TEAM_PRODUCT_INTERACTIONS_EARNED,
TEAM_PRODUCT_INTERACTIONS_GOAL::NUMBER(18,1) AS TEAM_PRODUCT_INTERACTIONS_GOAL,
TEAM_PRODUCT_STATUS::VARCHAR(40) AS TEAM_PRODUCT_STATUS,
GOALS_EDITED::VARCHAR(30) AS GOALS_EDITED,
CHILD_ACCOUNT::VARCHAR(100) AS CHILD_ACCOUNT,
FURIGANA::VARCHAR(1300) AS FURIGANA,
LOCATION::VARCHAR(100) AS LOCATION,
PARENT_CHILD_NAME::VARCHAR(1300) AS PARENT_CHILD_NAME,
LAST_CYCLE_PROGRESS_GENERATED::NUMBER(18,1) AS LAST_CYCLE_PROGRESS_GENERATED,
MASTER_ALIGN_ID::VARCHAR(36) AS MASTER_ALIGN_ID,
COUNTRY_CODE::VARCHAR(2) AS COUNTRY_CODE,
LEGACY_ID::VARCHAR(255) AS LEGACY_ID,
CHANNEL_ACTUAL_ACHIEVEMENT::NUMBER(18,4) AS CHANNEL_ACTUAL_ACHIEVEMENT,
MC_CYCLE_PLAN_ID18::VARCHAR(1300) AS MC_CYCLE_PLAN_ID18,
MC_CYCLE_PLAN_TARGET_ID18::VARCHAR(1300) AS MC_CYCLE_PLAN_TARGET_ID18,
OWNER_MANAGER::VARCHAR(1300) AS OWNER_MANAGER,
TARGET_ID18::VARCHAR(1300) AS TARGET_ID18,
PRIMARY_PARENT_NAME::VARCHAR(255) AS PRIMARY_PARENT_NAME,
SPECIALTY::VARCHAR(100) AS SPECIALTY,
CITY::VARCHAR(40) AS CITY,
NEW_CHANNEL_INTERACTIONS_GOALS::VARCHAR(11) AS NEW_CHANNEL_INTERACTIONS_GOALS,
NEW_PRODUCT_INTERACTIONS_GOALS::VARCHAR(11) AS NEW_PRODUCT_INTERACTIONS_GOALS,
	inserted_date::timestamp_ntz(9) as inserted_date,
	updated_date::timestamp_ntz(9) as updated_date
	from transformed
)

select * from final 
