
with sdl_hcp_osea_mc_cycle_plan
as
(
select * from {{ source('hcposesdl_raw', 'sdl_hcp_osea_mc_cycle_plan') }}
)
,
transformed as
(
select 
MC_CYCLE_PLAN_ID,
OWNER_ID,
 (CASE WHEN UPPER(IS_DELETED) = 'TRUE' THEN 1 WHEN UPPER(IS_DELETED) IS NULL THEN 0 WHEN UPPER(IS_DELETED) = ' ' THEN 0 ELSE 0 END) AS IS_DELETED,
CYCLE_PLAN_NAME,
RECORD_TYPE_ID,
CREATED_DATE,
CREATED_BY_ID,
LAST_MODIFIED_DATE,
LAST_MODIFIED_BY_ID,
SYSTEM_MODSTAMP,
MAY_EDIT,
CASE WHEN UPPER(IS_LOCKED) = 'TRUE' THEN 1 WHEN UPPER(IS_LOCKED) = 'FALSE' THEN 0 ELSE 0 END AS IS_LOCKED,	          
LAST_VIEWED_DATE,
LAST_REFERENCED_DATE,
CHANNEL_INTERACTION_ATTAINMENT,
CHANNEL_INTERACTION_STATUS,
CHANNEL_INTERACTIONS_EARNED,
CHANNEL_INTERACTIONS_GOAL,
CYCLE,
DAYS_REMAINING,
DAYS_TOTAL,
DESCRIPTION,
END_DATE,
EXTERNAL_ID,
LAST_CALCULATED,
LOCK,
PERCENT_CYCLE_COMPLETED,
PRODUCT_INTERACTION_ATTAINMENT,
PRODUCT_INTERACTION_STATUS,
PRODUCT_INTERACTIONS_EARNED,
PRODUCT_INTERACTIONS_GOAL,
START_DATE,
STATUS,
TERRITORY,
VEEVA_EXTERNAL_ID,
TEAM_CHANNEL_ATTAINMENT,
TEAM_CHANNEL_INTERACTIONS_EARNED,
TEAM_CHANNEL_INTERACTIONS_GOAL,
TEAM_CHANNEL_STATUS,
TEAM_PRODUCT_ATTAINMENT,
TEAM_PRODUCT_INTERACTIONS_EARNED,
TEAM_PRODUCT_INTERACTIONS_GOAL,
TEAM_PRODUCT_STATUS,
GOAL_EDIT_STATUS,
MASTER_ALIGN_ID,
COUNTRY_CODE,
LEGACY_ID,
GOAL_EDIT_APPROVED,
MANAGER_EMAIL,
OWNER_WWID,
current_timestamp() as INSERTED_DATE,
       NULL as UPDATED_DATE 
from sdl_hcp_osea_mc_cycle_plan
)
,
final as
(select 
	MC_CYCLE_PLAN_ID::VARCHAR(18) AS MC_CYCLE_PLAN_ID,
OWNER_ID::VARCHAR(18) AS OWNER_ID,
IS_DELETED::NUMBER(38,0) as IS_DELETED,
CYCLE_PLAN_NAME::VARCHAR(255) AS CYCLE_PLAN_NAME,
RECORD_TYPE_ID::VARCHAR(18) AS RECORD_TYPE_ID,
CREATED_DATE::TIMESTAMP_NTZ(9) AS CREATED_DATE,
CREATED_BY_ID::VARCHAR(18) AS CREATED_BY_ID,
LAST_MODIFIED_DATE::TIMESTAMP_NTZ(9) AS LAST_MODIFIED_DATE,
LAST_MODIFIED_BY_ID::VARCHAR(18) AS LAST_MODIFIED_BY_ID,
SYSTEM_MODSTAMP::TIMESTAMP_NTZ(9) AS SYSTEM_MODSTAMP,
MAY_EDIT::VARCHAR(10) AS MAY_EDIT,
IS_LOCKED::NUMBER(38,0) as IS_LOCKED,
LAST_VIEWED_DATE::TIMESTAMP_NTZ(9) AS LAST_VIEWED_DATE,
LAST_REFERENCED_DATE::TIMESTAMP_NTZ(9) AS LAST_REFERENCED_DATE,
CHANNEL_INTERACTION_ATTAINMENT::NUMBER(18,1) AS CHANNEL_INTERACTION_ATTAINMENT,
CHANNEL_INTERACTION_STATUS::VARCHAR(100) AS CHANNEL_INTERACTION_STATUS,
CHANNEL_INTERACTIONS_EARNED::NUMBER(18,1) AS CHANNEL_INTERACTIONS_EARNED,
CHANNEL_INTERACTIONS_GOAL::NUMBER(18,1) AS CHANNEL_INTERACTIONS_GOAL,
CYCLE::VARCHAR(20) AS CYCLE,
DAYS_REMAINING::NUMBER(18,1) AS DAYS_REMAINING,
DAYS_TOTAL::NUMBER(18,1) AS DAYS_TOTAL,
DESCRIPTION::VARCHAR(1000) AS DESCRIPTION,
END_DATE::DATE AS END_DATE,
EXTERNAL_ID::VARCHAR(100) AS EXTERNAL_ID,
LAST_CALCULATED::TIMESTAMP_NTZ(9) AS LAST_CALCULATED,
LOCK::VARCHAR(200) AS LOCK,
PERCENT_CYCLE_COMPLETED::NUMBER(18,1) AS PERCENT_CYCLE_COMPLETED,
PRODUCT_INTERACTION_ATTAINMENT::NUMBER(18,1) AS PRODUCT_INTERACTION_ATTAINMENT,
PRODUCT_INTERACTION_STATUS::VARCHAR(100) AS PRODUCT_INTERACTION_STATUS,
PRODUCT_INTERACTIONS_EARNED::NUMBER(18,1) AS PRODUCT_INTERACTIONS_EARNED,
PRODUCT_INTERACTIONS_GOAL::NUMBER(18,1) AS PRODUCT_INTERACTIONS_GOAL,
START_DATE::DATE AS START_DATE,
STATUS::VARCHAR(100) AS STATUS,
TERRITORY::VARCHAR(100) AS TERRITORY,
VEEVA_EXTERNAL_ID::VARCHAR(100) AS VEEVA_EXTERNAL_ID,
TEAM_CHANNEL_ATTAINMENT::NUMBER(18,1) AS TEAM_CHANNEL_ATTAINMENT,
TEAM_CHANNEL_INTERACTIONS_EARNED::NUMBER(18,1) AS TEAM_CHANNEL_INTERACTIONS_EARNED,
TEAM_CHANNEL_INTERACTIONS_GOAL::NUMBER(18,1) AS TEAM_CHANNEL_INTERACTIONS_GOAL,
TEAM_CHANNEL_STATUS::VARCHAR(100) AS TEAM_CHANNEL_STATUS,
TEAM_PRODUCT_ATTAINMENT::VARCHAR(100) AS TEAM_PRODUCT_ATTAINMENT,
TEAM_PRODUCT_INTERACTIONS_EARNED::NUMBER(18,1) AS TEAM_PRODUCT_INTERACTIONS_EARNED,
TEAM_PRODUCT_INTERACTIONS_GOAL::NUMBER(18,1) AS TEAM_PRODUCT_INTERACTIONS_GOAL,
TEAM_PRODUCT_STATUS::VARCHAR(100) AS TEAM_PRODUCT_STATUS,
GOAL_EDIT_STATUS::VARCHAR(100) AS GOAL_EDIT_STATUS,
MASTER_ALIGN_ID::VARCHAR(100) AS MASTER_ALIGN_ID,
COUNTRY_CODE::VARCHAR(2) AS COUNTRY_CODE,
LEGACY_ID::VARCHAR(255) AS LEGACY_ID,
GOAL_EDIT_APPROVED::VARCHAR(100) AS GOAL_EDIT_APPROVED,
MANAGER_EMAIL::VARCHAR(100) AS MANAGER_EMAIL,
OWNER_WWID::VARCHAR(100) AS OWNER_WWID,
	inserted_date::timestamp_ntz(9) as inserted_date,
	updated_date::timestamp_ntz(9) as updated_date
	from transformed
)

select * from final 
