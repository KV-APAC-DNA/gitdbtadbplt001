with itg_USER
as
(
select * from {{ ref('hcposeitg_integration__itg_user') }}
)
,
transformed 
as
(
SELECT * FROM itg_USER WHERE LOWER(USER_LICENSE)!='not applicable for regional service cloud'
)
,
final
as
(select 
	EMPLOYEE_KEY::VARCHAR(32) AS EMPLOYEE_KEY,
	EMPLOYEE_SOURCE_ID::VARCHAR(18) AS EMPLOYEE_SOURCE_ID,
	USER_NAME::VARCHAR(80) AS USER_NAME,
	EMPLOYEE_NAME::VARCHAR(121) AS EMPLOYEE_NAME,
	COMPANY_NAME::VARCHAR(80) AS COMPANY_NAME,
	DIVISION::VARCHAR(80) AS DIVISION,
	DEPARTMENT::VARCHAR(80) AS DEPARTMENT,
	TITLE::VARCHAR(80) AS TITLE,
	COUNTRY::VARCHAR(80) AS COUNTRY,
	ADDRESS::VARCHAR(255) AS ADDRESS,
	EMAIL::VARCHAR(128) AS EMAIL,
	PHONE::VARCHAR(40) AS PHONE,
	MOBILE_PHONE::VARCHAR(40) AS MOBILE_PHONE,
	ALIAS::VARCHAR(8) AS ALIAS,
	NICKNAME::VARCHAR(40) AS NICKNAME,
	IS_ACTIVE::NUMBER(38,0) AS IS_ACTIVE,
	TIMEZONESIDKEY::VARCHAR(40) AS TIMEZONESIDKEY,
	USER_ROLE_SOURCE_ID::VARCHAR(18) AS USER_ROLE_SOURCE_ID,
	RECEIVES_INFO_EMAILS::NUMBER(38,0) AS RECEIVES_INFO_EMAILS,
	EMPLOYEE_PROFILE_ID::VARCHAR(18) AS EMPLOYEE_PROFILE_ID,
	LOCAL_EMPLOYEE_NUMBER::VARCHAR(20) AS LOCAL_EMPLOYEE_NUMBER,
	MANAGER_SOURCE_ID::VARCHAR(18) AS MANAGER_SOURCE_ID,
	LAST_LOGIN_DATE::TIMESTAMP_NTZ(9) AS LAST_LOGIN_DATE,
	CREATED_DATE::TIMESTAMP_NTZ(9) AS CREATED_DATE,
	CREATED_BY_ID::VARCHAR(18) AS CREATED_BY_ID,
	LAST_MODIFIED_DATE::TIMESTAMP_NTZ(9) AS LAST_MODIFIED_DATE,
	LAST_MODIFIED_BY_ID::VARCHAR(18) AS LAST_MODIFIED_BY_ID,
	FEDERATION_IDENTIFIER::VARCHAR(512) AS FEDERATION_IDENTIFIER,
	LAST_IPAD_SYNC::TIMESTAMP_NTZ(9) AS LAST_IPAD_SYNC,
	COUNTRY_CODE::VARCHAR(8) AS COUNTRY_CODE,
	WWID::VARCHAR(9) AS WWID,
	REGION::VARCHAR(80) AS REGION,
	PROFILE_GROUP_AP::VARCHAR(1300) AS PROFILE_GROUP_AP,
	USER_LICENSE::VARCHAR(1300) AS USER_LICENSE,
	MANAGER_NAME::VARCHAR(80) AS MANAGER_NAME,
	MANAGER_WWID::VARCHAR(9) AS MANAGER_WWID,
	INSERTED_DATE::TIMESTAMP_NTZ(9) AS INSERTED_DATE,
	UPDATED_DATE::TIMESTAMP_NTZ(9) AS UPDATED_DATE,
	MSL_PRIMARY_RESPONSIBLE_TA::VARCHAR(255) AS MSL_PRIMARY_RESPONSIBLE_TA,
	MSL_SECONDARY_RESPONSIBLE_TA::VARCHAR(255) AS MSL_SECONDARY_RESPONSIBLE_TA,
	LAST_NAME::VARCHAR(80) AS LAST_NAME,
	FIRST_NAME::VARCHAR(40) AS FIRST_NAME,
	CITY::VARCHAR(40) AS CITY,
	STATE::VARCHAR(80) AS STATE,
	POSTAL_CODE::VARCHAR(20) AS POSTAL_CODE,
	USER_TYPE::VARCHAR(40) AS USER_TYPE,
	LANGUAGE_LOCAL_KEY::VARCHAR(40) AS LANGUAGE_LOCAL_KEY,
	LAST_MOBILE_SYNC::TIMESTAMP_NTZ(9) AS LAST_MOBILE_SYNC,
	VEEVA_USER_TYPE::VARCHAR(255) AS VEEVA_USER_TYPE,
	VEEVA_COUNTRY_CODE::VARCHAR(255) AS VEEVA_COUNTRY_CODE,
	SHC_USER_FRANCHISE::VARCHAR(255) AS SHC_USER_FRANCHISE
from transformed 

)

select * from final 






