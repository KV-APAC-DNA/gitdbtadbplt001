{{
    config(
        materialized= "incremental",
        incremental_strategy= "append",
        pre_hook = "{% if is_incremental() %}
                delete from {{this}}
where call_source_id in (select stg.call_source_id
                         from dev_dna_load.hcposesdl_raw.sdl_hcp_osea_call stg
                         where stg.call_source_id = call_source_id)
and   country_code in (select distinct upper(country) from dev_dna_load.hcposesdl_raw.sdl_hcp_osea_call);
                    {% endif %}"
    )
}}
with 
sdl_hcp_osea_call as
(
	select * from dev_dna_load.hcposesdl_raw.sdl_hcp_osea_call
)
,
transformed 
AS
(
SELECT MD5(CALL_SOURCE_ID||COUNTRY) AS CALL_KEY,
       CALL_SOURCE_ID,
       OWNER_SOURCE_ID,
       (CASE WHEN UPPER(IS_DELETED) = 'TRUE' THEN 1 WHEN UPPER(IS_DELETED) IS NULL THEN 0 WHEN UPPER(IS_DELETED) = ' ' THEN 0 ELSE 0 END) AS IS_DELETED,
       CALL_NAME,
       RECORD_TYPE_SOURCE_ID,
       CREATED_DATE,
       CREATED_BY_ID,
       LAST_MODIFIED_DATE,
       LAST_MODIFIED_BY_ID,
       LAST_ACTIVITY_DATE,
       CALL_COMMENTS,
       SAMPLE_CARD,
       ACCOUNT_SOURCE_ID,
       CALL_STATUS_TYPE,
       ACCOUNT_PLAN,
       NEXT_CALL_NOTES,
       PRE_CALL_NOTES,
       MOBILE_ID,
       (CASE WHEN UPPER(SIGNIFICANT_EVENT) = 'TRUE' THEN 1 WHEN UPPER(SIGNIFICANT_EVENT) IS NULL THEN 0 WHEN UPPER(SIGNIFICANT_EVENT) = ' ' THEN 0 ELSE 0 END) AS SIGNIFICANT_EVENT,
       LOCATION,
       CALL_DATE_TIME,
       SIGNATURE_DATE,
       SIGNATURE,
       TERRITORY,
       (CASE WHEN UPPER(SUBMITTED_BY_MOBILE) = 'TRUE' THEN 1 WHEN UPPER(SUBMITTED_BY_MOBILE) IS NULL THEN 0 WHEN UPPER(SUBMITTED_BY_MOBILE) = ' ' THEN 0 ELSE 0 END) AS SUBMITTED_BY_MOBILE,
       CALL_TYPE,
       ATTENDEES,
       ATTENDEE_TYPE,
       CALL_DATE,
       DETAILED_PRODUCTS,
       PARENT_CALL_SOURCE_ID,
       USER_NAME,
       MEDICAL_EVENT,
       MOBILE_LAST_MODIFIED_DATE_TIME,
       IS_PARENT_CALL,
       (CASE WHEN UPPER(CALL_CLM) = 'TRUE' THEN 1 WHEN UPPER(CALL_CLM) IS NULL THEN 0 WHEN UPPER(CALL_CLM) = ' ' THEN 0 ELSE 0 END) AS CALL_CLM,
       (CASE WHEN UPPER(IS_SAMPLED_CALL) = 'TRUE' THEN 1 WHEN UPPER(IS_SAMPLED_CALL) IS NULL THEN 0 WHEN UPPER(IS_SAMPLED_CALL) = ' ' THEN 0 ELSE 0 END) AS IS_SAMPLED_CALL,
       PRESENTATIONS,
       PRODUCT_PRIORITY_1,
       PRODUCT_PRIORITY_2,
       PRODUCT_PRIORITY_3,
       PRODUCT_PRIORITY_4,
       PRODUCT_PRIORITY_5,
       ATTENDEE_LIST,
       MSL_INTERACTION_NOTES,
       SEA_CALL_TYPE,
       CALL_DURATION,
       INTERACTION_MODE,
       (CASE WHEN UPPER(HCP_KOL_INITIATED) = 'TRUE' THEN 1 WHEN UPPER(HCP_KOL_INITIATED) IS NULL THEN 0 WHEN UPPER(HCP_KOL_INITIATED) = ' ' THEN 0 ELSE 0 END) AS HCP_KOL_INITIATED,
       MSL_INTERACTION_TYPE,
       IN_MANAGER_INSIGHTS AS MANAGER_CALL_COMMENT,
       MD_HOURS,
       (CASE WHEN UPPER(MD_IN_OR_OT) = 'TRUE' THEN 1 WHEN UPPER(MD_IN_OR_OT) IS NULL THEN 0 WHEN UPPER(MD_IN_OR_OT) = ' ' THEN 0 ELSE 0 END) AS MD_IN_OR_OT,
       MD_D_CALL_TYPE,
       MD_MINUTES,
       CALL_OBJECTIVE,
       SUBMISSION_DELAY,
       UPPER(COUNTRY) AS COUNTRY_CODE,
       REGION,
       MD_HSP_ADMIN,
       HSP_MINUTES,
       (CASE WHEN UPPER(ORTHO_ON_CALL_CASE) = 'TRUE' THEN 1 WHEN UPPER(ORTHO_ON_CALL_CASE) IS NULL THEN 0 WHEN UPPER(ORTHO_ON_CALL_CASE) = ' ' THEN 0 ELSE 0 END) AS ORTHO_ON_CALL_CASE,
       (CASE WHEN UPPER(ORTHO_VOLUNTEER_CASE) = 'TRUE' THEN 1 WHEN UPPER(ORTHO_VOLUNTEER_CASE) IS NULL THEN 0 WHEN UPPER(ORTHO_VOLUNTEER_CASE) = ' ' THEN 0 ELSE 0 END) AS ORTHO_VOLUNTEER_CASE,
       MD_CALC1,
       MD_CALCULATE_NON_CASE_TIME,
       MD_CALCULATED_HOURS_FIELD,
       MD_CASEDEPLOYMENT,
       MD_CASE_COVERAGE_12_HOURS,
       MD_PRODUCT_DISCUSSION,
       (CASE WHEN UPPER(MD_CONCURRENT_CALL) = 'TRUE' THEN 1 WHEN UPPER(MD_CONCURRENT_CALL) IS NULL THEN 0 WHEN UPPER(MD_CONCURRENT_CALL) = ' ' THEN 0 ELSE 0 END) AS MD_CONCURRENT_CALL,
       COURTESY_CALL,
       MD_IN_SERVICE,
       MD_KOL_COURSE_DISCUSSION,
       KOL_MINUTES,
       OTHER_ACTIVITIES_TIME_12_HOURS,
       OTHER_IN_FIELD_ACTIVITIES,
       MD_OVERSEAS_WORKSHOP_VISIT,
       MD_RA_ACTIVITIES2,
       SALES_ACTIVITY,
       SALES_TIME_12_HOURS,
       TIME_SPENT,
       TIME_SPENT_ON_OTHER_ACTIVITIES_SIMP,
       TIME_SPENT_ON_SALES_ACTIVITY,
       MD_TIME_SPENT_ON_A_CALL,
       MD_CASE_TYPE,
       MD_SETS_ACTIVITIES,
       MD_TIME_SPENT_ON_CASE,
       TIME_SPENT_ON_OTHER_ACTIVITIES,
       TIME_SPENT_PER_CALL,
       MD_CASE_CONDUCTED_IN_HOSPITAL,
       CALCULATED_FIELD_2,
       CALCULATED_HOURS_3,
       (CASE WHEN UPPER(CALL_PLANNED) = 'TRUE' THEN 1 WHEN UPPER(CALL_PLANNED) IS NULL THEN 0 WHEN UPPER(CALL_PLANNED) = ' ' THEN 0 ELSE 0 END) AS CALL_PLANNED,
       CALL_SUBMISSION_DAY,
       CASE_COVERAGE,
       DAY_OF_WEEK,
       (CASE WHEN UPPER(Pre_Engagement_Coaching) = 'TRUE' THEN 1 WHEN UPPER(Pre_Engagement_Coaching) IS NULL THEN 0 WHEN UPPER(Pre_Engagement_Coaching) = ' ' THEN 0 ELSE 0 END) AS Pre_Engagement_Coaching,
       (CASE WHEN UPPER(Joined_by_Manager) = 'TRUE' THEN 1 WHEN UPPER(Joined_by_Manager) IS NULL THEN 0 WHEN UPPER(Joined_by_Manager) = ' ' THEN 0 ELSE 0 END) AS Joined_by_Manager,
       Preparation_Time,
       Travel_Time,
       'N' as LOAD_FLAG,
       number_of_days_to_close_calls_kpi__c as NUMBER_OF_DAYS_TO_CLOSE_CALLS_KPI,
       jj_therapeutic_area__c as jj_therapeutic_area,
       ADDRESS_LINE_1,
       ADDRESS_LINE_2,
       ADDRESS,
       ALLOWED_PRODUCTS,
       CITY,
       DISBURSED_TO,
       DURATION,
       (CASE WHEN UPPER(IS_LOCKED) = 'TRUE' THEN 1 WHEN UPPER(IS_LOCKED) IS NULL THEN 0 WHEN UPPER(IS_LOCKED) = ' ' THEN 0 ELSE 0 END) AS IS_LOCKED,
       ACCOUNT_EXTERNAL_ID,
       ACCOUNT_SPECIALTY,
       CALL_SUBMITTED_DATE_TIME,
       CALL_SUBMITTEDBY,
       SIGNED_BY,
       NUMBER_OF_DETAILING,
       NUMBEROF_KEY_MESSAGE,
       REP_DEPARTMENT,
       REP_DIVISION,
       REP_MANAGER,
       CALL_OBJECTIVES,
       COST_OF_PROCEDURES,
       OTHER_OBJECTIVE,
       HCP_SPECIALITY,
       CALL_DURATION_MINS_IN_NUMBER,
       PRODUCTIVITY_CALL,
       LAST_DEVICE,
       LOCATION_SERVICES_STATUS,
       MOBILE_CREATED_DATE_TIME,
       (CASE WHEN UPPER(NO_DISBURSEMENT) = 'TRUE' THEN 1 WHEN UPPER(NO_DISBURSEMENT) IS NULL THEN 0 WHEN UPPER(NO_DISBURSEMENT) = ' ' THEN 0 ELSE 0 END) AS NO_DISBURSEMENT,
       OWNER_COMPANY_NAME,
       PARENT_ADDRESS,
       SIGNATURE_LOCATION_LATITUDE,
       SIGNATURE_LOCATION_LONGITUDE,
       SIGNATURE_TIMESTAMP,
       STATE,
       SUBJECT,
       SUBMIT_TIMESTAMP,
       TOTAL_EXPENSE_ATTENDEES_COUNT,
       ANY_AEPQC_SS_I_HAVE_REPORTED_WITHIN_24H,
       CHECK_IN_LATITUDE,
       CHECK_IN_LOCATION_SERVICES_STATUS,
       CHECK_IN_LONGITUDE,
       CHECK_IN_STATUS,
       CHECK_IN_TIMESTAMP,
       CHILD_ACCOUNT_ID,
       CHILD_ACCOUNT,
       CALL_CLM_LOCATION_LATITUDE,
       CALL_CLM_LOCATION_LONGITUDE,
       CALL_CLM_LOCATION_SERVICES_STATUS,
       (CASE WHEN UPPER(DISBURSEMENT_CREATED) = 'TRUE' THEN 1 WHEN UPPER(DISBURSEMENT_CREATED) IS NULL THEN 0 WHEN UPPER(DISBURSEMENT_CREATED) = ' ' THEN 0 ELSE 0 END) AS DISBURSEMENT_CREATED,
       EM_EVENT,
       LOCATION_ID,
       LOCATION_NAME,
       LOCATION_TEXT,
       MEDICAL_DISCUSSIONS,
       MEDICAL_INQUIRY,
       PARENT_ADDRESS_ID,
       PARENT_CALL_MOBILE_ID,
       SIGNATURE_ON_SYNC,
       SIGNATURE_PAGE_DISPLAY_NAME,
       SUBMIT_LOCATION_LATITUDE,
       SUBMIT_LOCATION_LONGITUDE,
       SUBMIT_LOCATION_SERVICES_STATUS,
       SUGGESTION,
       VEEVA_REMOTE_MEETING_ID,
       ACCOUNT_CLASSIFICATION,
       End_Datetime,
       SYSDATE() AS INSERTED_DATE,
       NULL AS UPDATED_DATE,
       remote_meeting_source_id,
       Call_Channel,
       FML_SIMP_Case_Product_Discussion,
       FML_SIMP_In_Service,
       FML_SIMP_Overseas_Workshop_Visit,
       (CASE WHEN UPPER(Signature_Captured_Remotely) = 'TRUE' THEN 1 WHEN UPPER(Signature_Captured_Remotely) IS NULL THEN 0 WHEN UPPER(Signature_Captured_Remotely) = ' ' THEN 0 ELSE 0 END) AS Signature_Captured_Remotely,
       Virtual_Channel_Option,
thmd_call_objectives ,
   thmd_case_type ,
   phmd_call_objective ,
   idmd_call_objectives ,
   gsg_case_type ,
   sis_case_type 
FROM sdl_hcp_osea_call
WHERE COUNTRY IS NOT NULL
OR    COUNTRY != ''
OR    COUNTRY != ' '
)
,
final as 
(
	select 
	CALL_KEY::VARCHAR(32)  as CALL_KEY, --not null
	CALL_SOURCE_ID::VARCHAR(18)  as CALL_SOURCE_ID, --NOT NULL
	OWNER_SOURCE_ID::VARCHAR(18) as OWNER_SOURCE_ID,
	IS_DELETED::NUMBER(38,0) as IS_DELETED,
	CALL_NAME::VARCHAR(80) as CALL_NAME,
	RECORD_TYPE_SOURCE_ID::VARCHAR(18) as RECORD_TYPE_SOURCE_ID,
	CREATED_DATE::TIMESTAMP_NTZ(9) as CREATED_DATE,
	CREATED_BY_ID::VARCHAR(18) as CREATED_BY_ID,
	LAST_MODIFIED_DATE::TIMESTAMP_NTZ(9) as LAST_MODIFIED_DATE,
	LAST_MODIFIED_BY_ID::VARCHAR(18) as LAST_MODIFIED_BY_ID,
	LAST_ACTIVITY_DATE::DATE as LAST_ACTIVITY_DATE,
	CALL_COMMENTS::VARCHAR(32000) as CALL_COMMENTS,
	SAMPLE_CARD::VARCHAR(15) as SAMPLE_CARD,
	ACCOUNT_SOURCE_ID::VARCHAR(18) as ACCOUNT_SOURCE_ID,
	CALL_STATUS_TYPE::VARCHAR(255) as CALL_STATUS_TYPE,
	ACCOUNT_PLAN::VARCHAR(18) as ACCOUNT_PLAN,
	NEXT_CALL_NOTES::VARCHAR(32000) as NEXT_CALL_NOTES,
	PRE_CALL_NOTES::VARCHAR(32000) as PRE_CALL_NOTES,
	MOBILE_ID::VARCHAR(100) as MOBILE_ID,
	SIGNIFICANT_EVENT::NUMBER(38,0) as SIGNIFICANT_EVENT,
	LOCATION::VARCHAR(128) as LOCATION,
	CALL_DATE_TIME::TIMESTAMP_NTZ(9) as CALL_DATE_TIME,
	SIGNATURE_DATE::TIMESTAMP_NTZ(9) as SIGNATURE_DATE,
	SIGNATURE::VARCHAR(32000) as SIGNATURE,
	TERRITORY::VARCHAR(100) as TERRITORY,
	SUBMITTED_BY_MOBILE::NUMBER(38,0) as SUBMITTED_BY_MOBILE,
	CALL_TYPE::VARCHAR(255) as CALL_TYPE,
	ATTENDEES::NUMBER(3,0) as ATTENDEES,
	ATTENDEE_TYPE::VARCHAR(255) as ATTENDEE_TYPE,
	CALL_DATE::DATE as CALL_DATE,
	DETAILED_PRODUCTS::VARCHAR(255) as DETAILED_PRODUCTS,
	PARENT_CALL_SOURCE_ID::VARCHAR(18) as PARENT_CALL_SOURCE_ID,
	USER_NAME::VARCHAR(18) as USER_NAME,
	MEDICAL_EVENT::VARCHAR(18) as MEDICAL_EVENT,
	MOBILE_LAST_MODIFIED_DATE_TIME::TIMESTAMP_NTZ(9) as MOBILE_LAST_MODIFIED_DATE_TIME,
	IS_PARENT_CALL::NUMBER(18,0) as IS_PARENT_CALL,
	CALL_CLM::NUMBER(38,0) as CALL_CLM,
	IS_SAMPLED_CALL::NUMBER(38,0) as IS_SAMPLED_CALL,
	PRESENTATIONS::VARCHAR(500) as PRESENTATIONS,
	PRODUCT_PRIORITY_1::VARCHAR(18) as PRODUCT_PRIORITY_1,
	PRODUCT_PRIORITY_2::VARCHAR(18) as PRODUCT_PRIORITY_2,
	PRODUCT_PRIORITY_3::VARCHAR(18) as PRODUCT_PRIORITY_3,
	PRODUCT_PRIORITY_4::VARCHAR(18) as PRODUCT_PRIORITY_4,
	PRODUCT_PRIORITY_5::VARCHAR(18) as PRODUCT_PRIORITY_5,
	ATTENDEE_LIST::VARCHAR(32768) as ATTENDEE_LIST,
	MSL_INTERACTION_NOTES::VARCHAR(32768) as MSL_INTERACTION_NOTES,
	SEA_CALL_TYPE::VARCHAR(1300) as SEA_CALL_TYPE,
	CALL_DURATION::VARCHAR(255) as CALL_DURATION,
	INTERACTION_MODE::VARCHAR(255) as INTERACTION_MODE,
	HCP_KOL_INITIATED::NUMBER(38,0) as HCP_KOL_INITIATED,
	MSL_INTERACTION_TYPE::VARCHAR(255) as MSL_INTERACTION_TYPE,
	MANAGER_CALL_COMMENT::VARCHAR(32768) as MANAGER_CALL_COMMENT,
	MD_HOURS::VARCHAR(255) as MD_HOURS,
	MD_IN_OR_OT::NUMBER(38,0) as MD_IN_OR_OT,
	MD_D_CALL_TYPE::VARCHAR(255) as MD_D_CALL_TYPE,
	MD_MINUTES::VARCHAR(255) as MD_MINUTES,
	CALL_OBJECTIVE::VARCHAR(255) as CALL_OBJECTIVE,
	SUBMISSION_DELAY::NUMBER(18,0) as SUBMISSION_DELAY,
	COUNTRY_CODE::VARCHAR(1300)   as COUNTRY_CODE, --NOT NULL
	REGION::VARCHAR(1300) as REGION,
	MD_HSP_ADMIN::VARCHAR(255) as MD_HSP_ADMIN,
	HSP_MINUTES::VARCHAR(255) as HSP_MINUTES,
	ORTHO_ON_CALL_CASE::NUMBER(38,0) as ORTHO_ON_CALL_CASE,
	ORTHO_VOLUNTEER_CASE::NUMBER(38,0) as ORTHO_VOLUNTEER_CASE,
	MD_CALC1::NUMBER(18,2) as MD_CALC1,
	MD_CALCULATE_NON_CASE_TIME::NUMBER(18,2) as MD_CALCULATE_NON_CASE_TIME,
	MD_CALCULATED_HOURS_FIELD::NUMBER(18,2) as MD_CALCULATED_HOURS_FIELD,
	MD_CASEDEPLOYMENT::VARCHAR(255) as MD_CASEDEPLOYMENT,
	MD_CASE_COVERAGE_12_HOURS::VARCHAR(255) as MD_CASE_COVERAGE_12_HOURS,
	MD_PRODUCT_DISCUSSION::VARCHAR(255) as MD_PRODUCT_DISCUSSION,
	MD_CONCURRENT_CALL::NUMBER(38,0) as MD_CONCURRENT_CALL,
	COURTESY_CALL::VARCHAR(255) as COURTESY_CALL,
	MD_IN_SERVICE::VARCHAR(255) as MD_IN_SERVICE,
	MD_KOL_COURSE_DISCUSSION::VARCHAR(255) as MD_KOL_COURSE_DISCUSSION,
	KOL_MINUTES::VARCHAR(255) as KOL_MINUTES,
	OTHER_ACTIVITIES_TIME_12_HOURS::NUMBER(18,0) as OTHER_ACTIVITIES_TIME_12_HOURS,
	OTHER_IN_FIELD_ACTIVITIES::VARCHAR(4099) as OTHER_IN_FIELD_ACTIVITIES,
	MD_OVERSEAS_WORKSHOP_VISIT::VARCHAR(255) as MD_OVERSEAS_WORKSHOP_VISIT,
	MD_RA_ACTIVITIES2::VARCHAR(255) as MD_RA_ACTIVITIES2,
	SALES_ACTIVITY::VARCHAR(4099) as SALES_ACTIVITY,
	SALES_TIME_12_HOURS::NUMBER(18,0) as SALES_TIME_12_HOURS,
	TIME_SPENT::VARCHAR(255) as TIME_SPENT,
	TIME_SPENT_ON_OTHER_ACTIVITIES_SIMP::VARCHAR(255) as TIME_SPENT_ON_OTHER_ACTIVITIES_SIMP,
	TIME_SPENT_ON_SALES_ACTIVITY::VARCHAR(255) as TIME_SPENT_ON_SALES_ACTIVITY,
	MD_TIME_SPENT_ON_A_CALL::NUMBER(18,2) as MD_TIME_SPENT_ON_A_CALL,
	MD_CASE_TYPE::VARCHAR(255) as MD_CASE_TYPE,
	MD_SETS_ACTIVITIES::VARCHAR(255) as MD_SETS_ACTIVITIES,
	MD_TIME_SPENT_ON_CASE::VARCHAR(255) as MD_TIME_SPENT_ON_CASE,
	TIME_SPENT_ON_OTHER_ACTIVITIES::NUMBER(18,2) as TIME_SPENT_ON_OTHER_ACTIVITIES,
	TIME_SPENT_PER_CALL::NUMBER(18,2) as TIME_SPENT_PER_CALL,
	MD_CASE_CONDUCTED_IN_HOSPITAL::VARCHAR(255) as MD_CASE_CONDUCTED_IN_HOSPITAL,
	CALCULATED_FIELD_2::NUMBER(18,2) as CALCULATED_FIELD_2,
	CALCULATED_HOURS_3::NUMBER(18,2) as CALCULATED_HOURS_3,
	CALL_PLANNED::NUMBER(38,0) as CALL_PLANNED,
	CALL_SUBMISSION_DAY::NUMBER(18,1) as CALL_SUBMISSION_DAY,
	CASE_COVERAGE::NUMBER(18,2) as CASE_COVERAGE,
	DAY_OF_WEEK::VARCHAR(1300) as DAY_OF_WEEK,
	PRE_ENGAGEMENT_COACHING::NUMBER(38,0) as PRE_ENGAGEMENT_COACHING,
	JOINED_BY_MANAGER::NUMBER(38,0) as JOINED_BY_MANAGER,
	PREPARATION_TIME::NUMBER(18,0) as PREPARATION_TIME,
	TRAVEL_TIME::NUMBER(18,0) as TRAVEL_TIME,
	LOAD_FLAG::VARCHAR(2) as LOAD_FLAG,
	NUMBER_OF_DAYS_TO_CLOSE_CALLS_KPI::NUMBER(18,2) as NUMBER_OF_DAYS_TO_CLOSE_CALLS_KPI,
	JJ_THERAPEUTIC_AREA::VARCHAR(255) as JJ_THERAPEUTIC_AREA,
	ADDRESS_LINE_1::VARCHAR(80) as ADDRESS_LINE_1,
	ADDRESS_LINE_2::VARCHAR(100) as ADDRESS_LINE_2,
	ADDRESS::VARCHAR(500) as ADDRESS,
	ALLOWED_PRODUCTS::VARCHAR(1000) as ALLOWED_PRODUCTS,
	CITY::VARCHAR(40) as CITY,
	DISBURSED_TO::VARCHAR(255) as DISBURSED_TO,
	DURATION::NUMBER(18,1) as DURATION,
	IS_LOCKED::NUMBER(38,0) as IS_LOCKED,
	ACCOUNT_EXTERNAL_ID::VARCHAR(1300) as ACCOUNT_EXTERNAL_ID,
	ACCOUNT_SPECIALTY::VARCHAR(1300) as ACCOUNT_SPECIALTY,
	CALL_SUBMITTED_DATE_TIME::TIMESTAMP_NTZ(9) as CALL_SUBMITTED_DATE_TIME,
	CALL_SUBMITTEDBY::VARCHAR(30) as CALL_SUBMITTEDBY,
	SIGNED_BY::VARCHAR(255) as SIGNED_BY,
	NUMBER_OF_DETAILING::NUMBER(18,1) as NUMBER_OF_DETAILING,
	NUMBEROF_KEY_MESSAGE::NUMBER(18,1) as NUMBEROF_KEY_MESSAGE,
	REP_DEPARTMENT::VARCHAR(1300) as REP_DEPARTMENT,
	REP_DIVISION::VARCHAR(1300) as REP_DIVISION,
	REP_MANAGER::VARCHAR(1300) as REP_MANAGER,
	CALL_OBJECTIVES::VARCHAR(4099) as CALL_OBJECTIVES,
	COST_OF_PROCEDURES::NUMBER(18,1) as COST_OF_PROCEDURES,
	OTHER_OBJECTIVE::VARCHAR(255) as OTHER_OBJECTIVE,
	HCP_SPECIALITY::VARCHAR(1300) as HCP_SPECIALITY,
	CALL_DURATION_MINS_IN_NUMBER::NUMBER(18,2) as CALL_DURATION_MINS_IN_NUMBER,
	PRODUCTIVITY_CALL::VARCHAR(255) as PRODUCTIVITY_CALL,
	LAST_DEVICE::VARCHAR(255) as LAST_DEVICE,
	LOCATION_SERVICES_STATUS::VARCHAR(255) as LOCATION_SERVICES_STATUS,
	MOBILE_CREATED_DATE_TIME::TIMESTAMP_NTZ(9) as MOBILE_CREATED_DATE_TIME,
	NO_DISBURSEMENT::NUMBER(38,0) as NO_DISBURSEMENT,
	OWNER_COMPANY_NAME::VARCHAR(1300) as OWNER_COMPANY_NAME,
	PARENT_ADDRESS::VARCHAR(18) as PARENT_ADDRESS,
	SIGNATURE_LOCATION_LATITUDE::NUMBER(15,6) as SIGNATURE_LOCATION_LATITUDE,
	SIGNATURE_LOCATION_LONGITUDE::NUMBER(15,6) as SIGNATURE_LOCATION_LONGITUDE,
	SIGNATURE_TIMESTAMP::NUMBER(15,1) as SIGNATURE_TIMESTAMP,
	STATE::VARCHAR(10) as STATE,
	SUBJECT::VARCHAR(128) as SUBJECT,
	SUBMIT_TIMESTAMP::NUMBER(15,1) as SUBMIT_TIMESTAMP,
	TOTAL_EXPENSE_ATTENDEES_COUNT::NUMBER(15,1) as TOTAL_EXPENSE_ATTENDEES_COUNT,
	ANY_AEPQC_SS_I_HAVE_REPORTED_WITHIN_24H::VARCHAR(255) as ANY_AEPQC_SS_I_HAVE_REPORTED_WITHIN_24H,
	CHECK_IN_LATITUDE::NUMBER(15,6) as CHECK_IN_LATITUDE,
	CHECK_IN_LOCATION_SERVICES_STATUS::VARCHAR(255) as CHECK_IN_LOCATION_SERVICES_STATUS,
	CHECK_IN_LONGITUDE::NUMBER(15,6) as CHECK_IN_LONGITUDE,
	CHECK_IN_STATUS::VARCHAR(255) as CHECK_IN_STATUS,
	CHECK_IN_TIMESTAMP::NUMBER(15,1) as CHECK_IN_TIMESTAMP,
	CHILD_ACCOUNT_ID::VARCHAR(40) as CHILD_ACCOUNT_ID,
	CHILD_ACCOUNT::VARCHAR(18) as CHILD_ACCOUNT,
	CALL_CLM_LOCATION_LATITUDE::NUMBER(15,6) as CALL_CLM_LOCATION_LATITUDE,
	CALL_CLM_LOCATION_LONGITUDE::NUMBER(15,6) as CALL_CLM_LOCATION_LONGITUDE,
	CALL_CLM_LOCATION_SERVICES_STATUS::VARCHAR(255) as CALL_CLM_LOCATION_SERVICES_STATUS,
	DISBURSEMENT_CREATED::NUMBER(38,0) as DISBURSEMENT_CREATED,
	EM_EVENT::VARCHAR(18) as EM_EVENT,
	LOCATION_ID::VARCHAR(40) as LOCATION_ID,
	LOCATION_NAME::VARCHAR(18) as LOCATION_NAME,
	LOCATION_TEXT::VARCHAR(255) as LOCATION_TEXT,
	MEDICAL_DISCUSSIONS::VARCHAR(255) as MEDICAL_DISCUSSIONS,
	MEDICAL_INQUIRY::VARCHAR(18) as MEDICAL_INQUIRY,
	PARENT_ADDRESS_ID::VARCHAR(255) as PARENT_ADDRESS_ID,
	PARENT_CALL_MOBILE_ID::VARCHAR(100) as PARENT_CALL_MOBILE_ID,
	SIGNATURE_ON_SYNC::VARCHAR(1300) as SIGNATURE_ON_SYNC,
	SIGNATURE_PAGE_DISPLAY_NAME::VARCHAR(255) as SIGNATURE_PAGE_DISPLAY_NAME,
	SUBMIT_LOCATION_LATITUDE::NUMBER(15,6) as SUBMIT_LOCATION_LATITUDE,
	SUBMIT_LOCATION_LONGITUDE::NUMBER(15,6) as SUBMIT_LOCATION_LONGITUDE,
	SUBMIT_LOCATION_SERVICES_STATUS::VARCHAR(255) as SUBMIT_LOCATION_SERVICES_STATUS,
	SUGGESTION::VARCHAR(18) as SUGGESTION,
	VEEVA_REMOTE_MEETING_ID::VARCHAR(20) as VEEVA_REMOTE_MEETING_ID,
	ACCOUNT_CLASSIFICATION::VARCHAR(255) as ACCOUNT_CLASSIFICATION,
	END_DATETIME::TIMESTAMP_NTZ(9) as END_DATETIME,
	INSERTED_DATE::TIMESTAMP_NTZ(9) as INSERTED_DATE,
	UPDATED_DATE::TIMESTAMP_NTZ(9) as UPDATED_DATE,
	REMOTE_MEETING_SOURCE_ID::VARCHAR(18) as REMOTE_MEETING_SOURCE_ID,
	CALL_CHANNEL::VARCHAR(255) as CALL_CHANNEL,
	FML_SIMP_CASE_PRODUCT_DISCUSSION::NUMBER(18,2) as FML_SIMP_CASE_PRODUCT_DISCUSSION,
	FML_SIMP_IN_SERVICE::NUMBER(18,2) as FML_SIMP_IN_SERVICE,
	FML_SIMP_OVERSEAS_WORKSHOP_VISIT::NUMBER(18,2) as FML_SIMP_OVERSEAS_WORKSHOP_VISIT,
	SIGNATURE_CAPTURED_REMOTELY::VARCHAR(5) as SIGNATURE_CAPTURED_REMOTELY,
	VIRTUAL_CHANNEL_OPTION::VARCHAR(255) as VIRTUAL_CHANNEL_OPTION,
	THMD_CALL_OBJECTIVES::VARCHAR(4099) as THMD_CALL_OBJECTIVES,
	THMD_CASE_TYPE::VARCHAR(255) as THMD_CASE_TYPE,
	PHMD_CALL_OBJECTIVE::VARCHAR(4099) as PHMD_CALL_OBJECTIVE,
	IDMD_CALL_OBJECTIVES::VARCHAR(4099) as IDMD_CALL_OBJECTIVES,
	GSG_CASE_TYPE::VARCHAR(255) as GSG_CASE_TYPE,
	SIS_CASE_TYPE::VARCHAR(255) as SIS_CASE_TYPE
	--primary key (CALL_KEY, CALL_SOURCE_ID, COUNTRY_CODE)
    from transformed 

)

select * from final 